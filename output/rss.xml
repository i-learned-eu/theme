<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>I Learned</title><link>https://ilearned.eu.org/</link><description></description><lastBuildDate>Sat, 31 Jul 2021 00:00:00 +0200</lastBuildDate><item><title>La puce TPM, quelle est son utilit√© ?</title><link>https://ilearned.eu.org/tpm.html</link><description>&lt;p&gt;Il y a moins d&amp;rsquo;un mois Microsoft annon√ßait officiellement Windows 11. Cette nouvelle version √† fait d√©bat, et pour cause, beaucoup (trop) d&amp;rsquo;appareils sont incompatibles avec cette version de Windows, une des raisons avanc√©es par Microsoft est le support manquant de TPM 2.0. Mais au fond, Qu&amp;rsquo;est ce que TPM et quels sont les changements apport√© par la deuxi√®me version de TPM.&lt;/p&gt;
&lt;p&gt;TPM est l&amp;rsquo;acronyme de &amp;ldquo;Trusted Platform Module&amp;rdquo;, c&amp;rsquo;est une puce qui permet de faire des op√©rations cryptographiques, ou de garder des secrets.&lt;/p&gt;
&lt;p&gt;Cette puce est principalement faite pour g√©n√©rer des cl√©s RSA ‚Äì RSA est un algorithme de cryptographie asym√©trique ‚Äì stocker ces cl√©s et g√©rer l&amp;rsquo;acc√®s √† ces dites cl√©s. Cette puce est aussi utilis√©e pour &lt;a href="https://ilearned.eu.org/secure_boot.html"&gt;Secure Boot&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Une puce TPM poss√®de une cl√© RSA qui permet de l&amp;rsquo;authentifier, cette cl√© ne peut en th√©orie pas sortir de la puce.&lt;/p&gt;
&lt;p&gt;Un des usages principaux de TPM est de stocker diff√©rents secrets, pour par exemple chiffrer un disque avec une technologie comme BitLocker sous Windows, ou Luks sous Linux. La s√©curit√© du stockage de la cl√© pourrait poser question, comment s&amp;rsquo;assurer qu&amp;rsquo;un autre syst√®me ne puisse pas avoir acc√®s a la cl√© de d√©chiffrement ? Afin d&amp;rsquo;am√©liorer la s√©curit√© de cette puce, on peut configurer un PIN √† entrer pour acc√©der √† la cl√© de d√©chiffrement.&lt;/p&gt;
&lt;p&gt;Si la cl√© n&amp;rsquo;est pas prot√©g√©e par un PIN, la puce laissera quand m√™me l&amp;rsquo;acc√®s uniquement au syst√®me qui a cr√©e la cl√©, m√™me si dans certains cas particulier la v√©rification ne se fait pas correctement.&lt;/p&gt;
&lt;p&gt;Comme faille de s√©curit√© dans TPM on peut notamment citer &lt;a href="https://tpm.fail"&gt;TPM-FAIL&lt;/a&gt; qui permet simplement d&amp;rsquo;extraire la cl√© priv√©e. Un autre probl√®me de s√©curit√© que pr√©sente TPM est qu&amp;rsquo;avec un acc√®s physique il est possible d&amp;rsquo;espionner ce que la puce fait et donc d&amp;rsquo;en extraire des donn√©es confidentielles, si vous souhaitez en savoir plus, la page Wikipedia sur TPM cite d&amp;rsquo;autres failles de s√©curit√© : &lt;a href="https://en.wikipedia.org/wiki/Trusted_Platform_Module#Attacks"&gt;https://en.wikipedia.org/wiki/Trusted_Platform_Module#Attacks&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Un autre probl√®me de TPM qui est tr√®s r√©pandu c&amp;rsquo;est le vecteur d&amp;rsquo;attaque physique, en observant directement sur les bus de la puce avec du mat√©riel sp√©cifique il est possible d&amp;rsquo;extraire les cl√©s de la puce, ce type d&amp;rsquo;attaque se nomme &lt;a href="https://en.wikipedia.org/wiki/Cold_boot_attack"&gt;cold boot atttack&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;La puce TPM est divis√©e en plusieurs partie qu&amp;rsquo;on nomme des Platform configuration Registers qui ont plusieurs utilit√©, comme le stockage de cl√©, firmware etc.&lt;/p&gt;
&lt;p&gt;TPM a connu des √©volutions, je vais me concentrer ici seulement sur la version 1.2 et 2 de TPM. Une des avanc√©es majeure est l&amp;rsquo;impl√©mentation des courbes elliptiques sur la version 2, les algorithmes de chiffrement √† courbe elliptique sont des algorithmes de cryptographie asym√©trique, concurrents √† RSA
notamment, qui au lieu d&amp;rsquo;utiliser les nombres premiers utilisent des courbes elliptiques, l&amp;rsquo;avantage compar√© √† RSA c&amp;rsquo;est leur r√©sistance suppos√©e aux ordinateurs quantiques. Une autre avanc√©e est le support de SHA256 qui est bien plus r√©sistant que SHA1 √† diff√©rent type d&amp;rsquo;attaque.&lt;/p&gt;
&lt;p&gt;√Ä mon avis, le fait pour Windows 11 de forcer TPM est relativement inutile, en effet BitLocker n&amp;rsquo;est pas activ√© par d√©faut, et &lt;a href="https://ilearned.eu.org/secure_boot.html"&gt;Secure Boot&lt;/a&gt; ne d√©pends pas forc√©ment de TPM. Le mieux serait de recommander sans pour autant forcer. TPM reste tr√®s int√©ressant pour √©viter de taper un mot de passe au boot, qui en plus de prendre du temps peut √™tre vu par un attaquant, et permettre de v√©rifier l‚Äôint√©grit√© du d√©marrage en s√©parant la gestion des cl√©s du bios (l&amp;rsquo;avantage est que pour changer le jeu de cl√©s publiques il faut effacer la cl√© de d√©chiffrement). Un des soucis les plus important de TPM reste que la plupart des impl√©mentations ne sont pas libres, une backdoor pourrait donc y √™tre ins√©r√© par le constructeur.&lt;/p&gt;
&lt;p&gt;Une alternative √† TPM peut √™tre des puces plus sp√©cifique comme la puce titan de google, ou T2, mais ces deux puces restent malheureusement propri√©taires.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sat, 31 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-31:/tpm.html</guid><category>misc</category></item><item><title>Comment faire une autorit√© de certification (CA) SSH ?</title><link>https://ilearned.eu.org/ca-ssh.html</link><description>&lt;p&gt;SSH est un protocole tr√®s r√©pandu sur internet, il est utilis√© par des millions d&amp;rsquo;entreprises et particuliers chaque jour, mais bien souvent de fa√ßon peu s√©curis√©e. Vous connaissez peut-√™tre les cl√©s SSH qui permettent une meilleure s√©curit√© que les mots de passe, mais ces cl√©s posent un probl√®me, et notamment en entreprise, imaginez une entreprise avec 500 ing√©nieurs, il faudrait, sur chaque serveur SSH, mettre les 500 cl√©s publiques des 500 ing√©nieurs ! Pour rem√©dier √† cela il existe une solution que nous allons √©tudier dans cet article, les autorit√©s de certification SSH.&lt;/p&gt;
&lt;h1 id="la-theorie"&gt;La th√©orie&lt;/h1&gt;
&lt;p&gt;Le syst√®me de certificats de SSH est relativement similaire √† celui de TLS (x509), une premi√®re paire de cl√©s publiques/priv√©es est g√©n√©r√©e, elle servira d&amp;rsquo;&lt;strong&gt;autorit√© de certification&lt;/strong&gt;, le cl√© priv√©e de cette autorit√© de certification doit bien √©videmment rester ultra confidentielle. On va ensuite g√©n√©rer une autre paire de cl√© sur chaque client. On pourra ensuite, avec la cl√© priv√©e de notre autorit√© de certification, signer la publique des clients afin de g√©n√©rer un certificat. Ainsi, n&amp;rsquo;importe quel certificat sign√© par notre autorit√© de certification peut √™tre consid√©r√©e comme &amp;ldquo;de confiance&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Principe d'une autorit√© de certification" src="/static/img/ca-ssh/CA_principe(1).png"&gt;&lt;/p&gt;
&lt;h1 id="signer-les-cles-hote"&gt;Signer les cl√©s h√¥te&lt;/h1&gt;
&lt;p&gt;Lors de la premi√®re connexion √† un serveur SSH, le serveur envoie sa cl√© publique (appel√©e cl√© h√¥te) au client et le client doit approuver, ou non, l&amp;rsquo;authenticit√© de la cl√© envoy√©e par le serveur, c&amp;rsquo;est le fameux message&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;The authenticity of host &lt;span class="s1"&gt;&amp;#39;XXXXX&amp;#39;&lt;/span&gt; can&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;t be established.
ED25519 key fingerprint is SHA256:JxfJl38mBVY2jX0h/LWDuB1OtgYfgLBr3nJw/lw5GFE.
This key is not known by any other names
Are you sure you want to &lt;span class="k"&gt;continue&lt;/span&gt; connecting &lt;span class="o"&gt;(&lt;/span&gt;yes/no/&lt;span class="o"&gt;[&lt;/span&gt;fingerprint&lt;span class="o"&gt;])&lt;/span&gt;? 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Nous avons tous pour (mauvaise) habitude de simplement entrer &lt;code&gt;yes&lt;/code&gt; sans se poser plus de questions, mais cette habitude est tr√®s dangereuse, un attaquant pourrait usurper le serveur SSH auquel nous essayons de nous connecter ! Pour rem√©dier √† cela il existe plusieurs solutions comme &lt;a href="https://fr.wikipedia.org/wiki/Enregistrement_DNS_SSHFP"&gt;SSHFP&lt;/a&gt; (qui est relativement similaire √† &lt;a href="https://ilearned.eu.org/dane.html"&gt;TLSA&lt;/a&gt;, mais avec SSH) ou les autorit√©s de certification (CA) c&amp;rsquo;est ce que nous allons d√©tailler ici.&lt;/p&gt;
&lt;p&gt;La premi√®re √©tape est donc de cr√©er une paire de cl√©s pour notre autorit√© de certification avec la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;keygen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ed25519&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ca&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;id_ed25519&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;contact+ca@eban.bzh&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;L&amp;rsquo;option &lt;code&gt;-a&lt;/code&gt; indique le nombre de tours KDF (fonction de d√©rivation de la cl√©), plus ce nombre est √©lev√©, plus la v√©rification du mot de passe sera lente, mais plus la cl√© sera r√©sistante au bruteforce.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-t&lt;/code&gt; indique l&amp;rsquo;algorithme √† utiliser pour la cl√©, ici c&amp;rsquo;est ed25519, l&amp;rsquo;algorithme de chiffrement &lt;a href="https://nbeguier.medium.com/a-real-world-comparison-of-the-ssh-key-algorithms-b26b0b31bfd9"&gt;le plus s√©curis√© √† ce jour&lt;/a&gt; support√© par SSH.&lt;/p&gt;
&lt;p&gt;Une fois cette premi√®re paire de cl√© cr√©√©e, nous allons pouvoir l&amp;rsquo;utiliser pour signer les cl√©s h√¥tes publiques de nos serveurs SSH, la premi√®re √©tape est donc d&amp;rsquo;aller cherche ces cl√©s h√¥tes, elles sont, sur chaque serveur SSH, dans le r√©pertoire /etc/ssh, ici je ne g√©n√®rerait qu&amp;rsquo;un certificat en &lt;code&gt;ed25519&lt;/code&gt; mais la m√™me d√©marche est possible avec n&amp;rsquo;importe quel algorithme support√© par OpenSSH. La cl√© publique h√¥te est donc disponible sous le chemin &lt;code&gt;/etc/ssh/ssh_host_ed25519_key.pub&lt;/code&gt; copions-l√† dans le r√©pertoire &lt;code&gt;/etc/ssh/ca&lt;/code&gt; de la machine sur laquelle nous avons g√©n√©r√© l&amp;rsquo;autorit√© de certification. On peut ensuite lancer la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh-keygen -h -s /etc/ssh/ca/id_ed25519 -n pi01,pi01.infra.eban.bzh -I pi01 -V +3650d ssh_host_ed25519_key.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;L&amp;rsquo;option &lt;code&gt;-n&lt;/code&gt; correspond aux &lt;code&gt;principals&lt;/code&gt;, dans le cas d&amp;rsquo;une cl√© h√¥te, elle doit correspondre aux diff√©rents noms de domaine auxquelles la cl√© pourrait √™tre associ√©e.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-I&lt;/code&gt; correspond √† l&amp;rsquo;&lt;code&gt;ID&lt;/code&gt;, un identifiant unique attribu√© √† la cl√©, c&amp;rsquo;est simplement son &amp;ldquo;nom&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Une fois la cl√© publique sign√©e, il ne nous reste plus qu&amp;rsquo;√† copier le certificat qui aura √©t√© g√©n√©r√© dans le r√©pertoire &lt;code&gt;/etc/ssh/ca/ssh_host_ed25519_key-cert.pub&lt;/code&gt; sur le serveur SSH (ici nous le mettrons √† l&amp;rsquo;emplacement &lt;code&gt;/etc/ssh/ssh_host_ed25519_key-cert.pub&lt;/code&gt;) et √† ajouter la ligne suivante √† la fin du fichier &lt;code&gt;/etc/sshd_config&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;HostCertificate /etc/ssh/ssh_host_ed25519_key-cert.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On red√©marre ensuite le d√©mon ssh avec la commande &lt;code&gt;systemctl restart sshd&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Derni√®re √©tape, on va indiquer √† tous les clients SSH de faire confiance aux certificats h√¥tes sign√©s par notre autorit√© de certification en utilisant la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;@cert-authority * &lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;cat /etc/ssh/ca/id_ed25519.pub&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/known_hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Et voil√† ! Notre autorit√© de certification est maintenant configur√©e sur le serveur SSH.&lt;/p&gt;
&lt;h1 id="signer-les-cles-clients"&gt;Signer les cl√©s clients&lt;/h1&gt;
&lt;p&gt;La proc√©dure pour signer les cl√©s des clients est relativement similaire, apr√®s avoir g√©n√©r√© une paire de cl√©s pour l&amp;rsquo;autorit√© de certification (on gardera la m√™me que celle g√©n√©r√©e dans la partie pr√©c√©dente), on lance la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;keygen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ca&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;id_ed25519&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;pi&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pc01&lt;/span&gt;&lt;span class="nv"&gt;@eban&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bzh&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;USERNAME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;id_ed25519&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pub&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;N&amp;rsquo;oubliez pas de changer &lt;code&gt;USERNAME&lt;/code&gt; par votre nom d&amp;rsquo;utilisateur.&lt;/p&gt;
&lt;p&gt;Si vous obtenez une erreur, c&amp;rsquo;est probablement que n&amp;rsquo;avez pas d√©j√† une paire de cl√© SSH en &lt;code&gt;ed25519&lt;/code&gt; vous pouvez en g√©n√©rer une avec la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh-keygen -t ed25519
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Une fois la paire de cl√© g√©n√©r√©e, vous pouvez relancer la premi√®re commande.&lt;/p&gt;
&lt;p&gt;Ici l&amp;rsquo;option &lt;code&gt;-n&lt;/code&gt; correspond au‚ãÖx &lt;strong&gt;nom&lt;/strong&gt;‚ãÖs &lt;strong&gt;d&amp;rsquo;utilisateur distant&lt;/strong&gt; (= sur le serveur SSH) pour lesquels vous souhaitez autoriser que cette cl√© soit valide, cette cl√© ne sera donc valide que pour le nom d&amp;rsquo;utilisateur distant  &lt;code&gt;pi&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-z&lt;/code&gt; correspond au &lt;code&gt;serial&lt;/code&gt; de ce certificat, c&amp;rsquo;est un nombre que vous devrez incr√©menter si vous r√©g√©n√©rez la cl√© apr√®s la dur√©e d&amp;rsquo;expiration (ici mise √† 30 jours).&lt;/p&gt;
&lt;p&gt;Une fois cela fait, il ne nous reste plus qu&amp;rsquo;√† copier la cl√© publique de notre autorit√© de certification (contenue dans &lt;code&gt;/etc/ssh/ca/id_ed25519.pub&lt;/code&gt;) sur notre serveur SSH, ici nous la mettrons dans le fichier &lt;code&gt;/etc/ssh/ca.pub&lt;/code&gt; et √† ajouter la ligne &lt;code&gt;TrustedUserCAKeys /etc/ssh/ca.pub&lt;/code&gt; √† la fin du fichier &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;. On termine par red√©marrer le service SSH, &lt;code&gt;sudo systemctl restart sshd&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Nous avons maintenant mit en place notre autorit√© de certification ! On peut simplement la tester en se connectant via SSH au serveur, vous ne devriez pouvoir vous connecter sans mot de passe et n&amp;rsquo;avoir aucune demande de validation de la cl√© publique de la machine h√¥te. J&amp;rsquo;esp√®re que cet article vous aura √©t√© utile, si vous avez des questions n&amp;rsquo;h√©sitez pas √† nous les poser en commentaire ou sur &lt;a href="https://twitter.com/ilearned_eu"&gt;Twitter&lt;/a&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Thu, 22 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-22:/ca-ssh.html</guid><category>misc</category></item><item><title>S√©curiser votre syst√®me d'exploitation gr√¢ce aux MAC</title><link>https://ilearned.eu.org/mac.html</link><description>&lt;p&gt;Un reproche souvent fait √† Linux est sa gestion des droits souvent trop permissive. Il y a bien s√ªr une raison historique, √† la naissance des diff√©rents syst√®mes d&amp;rsquo;exploitation que l&amp;rsquo;on connait aujourd&amp;rsquo;hui la s√©curit√© n&amp;rsquo;√©tait pas la pr√©occupation principale. Le but de base n&amp;rsquo;√©tait pas non plus de compliquer la t√¢che des utilisateurs (la s√©curit√© se fait toujours au prix de complexit√© suppl√©mentaire). Le probl√®me de cette philosophie de d√©part est qu&amp;rsquo;il faut repenser la s√©curit√© avec une base trop ouverte.&lt;/p&gt;
&lt;p&gt;Sous Linux tout est fichier, les p√©riph√©riques physiques ont par exemple, un fichier attribu√© dans &lt;code&gt;/dev&lt;/code&gt;. La s√©curit√© d&amp;rsquo;acc√®s pour les fichiers se base sur les permission de chaque fichier. Ce m√©canisme montre vite des limites. Les autorisations sont tr√®s limit√©es, sous Linux ces autorisations sont divis√©es en 3, ce que l&amp;rsquo;utilisateur propri√©taire peut faire, ce que le groupe propri√©taire peut faire et ce que tout le monde est autoris√© √† faire. Chaque partie peut avoir 3 droits diff√©rents :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;R (read) : Lecture&lt;/li&gt;
&lt;li&gt;W (write) : √âcriture&lt;/li&gt;
&lt;li&gt;X (Execute) : Ex√©cution (dans le cadre d&amp;rsquo;un dossier c&amp;rsquo;est l&amp;rsquo;autorisation pour lister le contenu)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On peut visualiser les permissions via la commande &lt;code&gt;ls -l &amp;lt;dossier&amp;gt;&lt;/code&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;% ls -l&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;total&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rwxr&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;xr&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ramle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ramle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executable&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-------&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root_only&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;ls&lt;/code&gt; divise en 3 parties les permissions, celle de l&amp;rsquo;utilisateur, du groupe et de tout le monde :&lt;/p&gt;
&lt;p&gt;&lt;img alt="D√©tails des droits affich√©s par LS" src="/static/img/mac/ls(2).png"&gt;&lt;/p&gt;
&lt;p&gt;Le soucis de se baser uniquement sur les permissions des fichiers est le manque de contr√¥le, le sch√©ma de s√©curit√© des MAC permet de renforcer le tout en regardant beaucoup plus de facteur. Le concept est de regarder toutes le actions faites sur la machine, et de regarder l&amp;rsquo;action et l&amp;rsquo;autoriser ou non en fonction des r√®gles d&amp;rsquo;acc√®s. L&amp;rsquo;avantage de ce mod√®le par rapport √† la s√©curit√© historique de Linux (et UNIX par la m√™me occasion) est d&amp;rsquo;√™tre bien plus pr√©cis, par exemple autoriser √† une application seulement certains ports et fichiers (fichier qui pourrait selon le syst√®me de fichier lui √™tre autoris√©).&lt;/p&gt;
&lt;p&gt;Sous Linux, il n&amp;rsquo;y a pas de base de framework de MAC, mais des modules dans le noyaux sont pr√©vu pour qu&amp;rsquo;on y greffe un framework il y en a deux importants, Apparmor et SELinux.&lt;/p&gt;
&lt;p&gt;Les deux ont des fonctionnalit√©s similaires, mais se diff√©rencient par un point important, Apparmor se base sur le chemin complet d&amp;rsquo;un fichier, l√† ou SELinux se base seulement sur le nom, cette diff√©rence est assez minime dans la plupart des cas, mais en fonction du framework utilis√©, des m√©thodes de contournement se basant sur ces sp√©cificit√©s, par exemple en utilisant des liens virtuelles (symlink) ou renommant un fichier, une bonne politique d&amp;rsquo;acc√®s √©vite cependant les contournements.&lt;/p&gt;
&lt;p&gt;Bien s√ªr, Linux n&amp;rsquo;est pas le seul syst√®me d&amp;rsquo;exploitation qui utilise des contr√¥les d&amp;rsquo;acc√®s plus pouss√© qu&amp;rsquo;uniquement des permissions basiques, Windows fonctionne sur &lt;a href="https://ilearned.eu.org/secu_windows.html"&gt;ce principe&lt;/a&gt; aussi tout comme MacOS et BSD avec l&amp;rsquo;int√©gration de TrustedBSD.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Tue, 20 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-20:/mac.html</guid><category>misc</category></item><item><title>MQTT, comprendre le standard de la domotique</title><link>https://ilearned.eu.org/mqtt.html</link><description>&lt;p&gt;Si vous vous √™tes d√©j√† int√©ress√©‚ãÖe √† la domotique, vous avez s√ªrement entendu parler du protocole MQTT (Message Queuing Telemetry Transport), MQTT est un protocole tr√®s utilis√© pour faire de l&amp;rsquo;automatisation notamment, nous allons entrer plus en profondeur dans le fonctionnement d&amp;rsquo;MQTT dans cet article √† travers l&amp;rsquo;exemple d&amp;rsquo;une lampe connect√©e.&lt;/p&gt;
&lt;p&gt;MQTT fonctionne sur le principe de &lt;code&gt;Topics&lt;/code&gt; dans lesquels les diff√©rents appareils peuvent publier ou recevoir des messages. La fonctionnement de ce protocole est relativement simple, le client commence par s&amp;rsquo;authentifier aupr√®s du serveur, puis il peut recevoir et/ou envoyer des messages au serveur, appel√© &lt;code&gt;Broker&lt;/code&gt;, voici un exemple de trame r√©seau.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Trame r√©seau MQTT" src="/static/img/mqtt/MQTT_Trame_rseau.png"&gt;&lt;/p&gt;
&lt;p&gt;On peut donc voir que ce protocole est tr√®s simple de fonctionnement, et ce n&amp;rsquo;est pas un hasard qu&amp;rsquo;il soit tr√®s utilis√© en domotique, bien souvent les appareils en domotique sont tout petits et n&amp;rsquo;ont pas la capacit√© d&amp;rsquo;impl√©menter des protocoles tr√®s lourd.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un exemple de communication avec MQTT" src="/static/img/mqtt/Exemple.png"&gt;&lt;/p&gt;
&lt;p&gt;Vous pouvez voir ci-dessus un exemple tr√®s simple d&amp;rsquo;utilisation du protocole MQTT, un t√©l√©phone publie un message au broker MQTT sur le topic &lt;code&gt;stat/phone&lt;/code&gt; quand le r√©veil sonne, une lampe connect√©e est abonn√©e au topic &lt;code&gt;stat/phone&lt;/code&gt;, quand un message indiquant qu&amp;rsquo;une alarme vient de sonner lui parvient, elle s&amp;rsquo;allume et indique par un message sur le topic &lt;code&gt;stat/lampe/POWER&lt;/code&gt; qu&amp;rsquo;elle est allum√©e. Ce sc√©nario est tr√®s simple mais il montre √† quel point MQTT est modulable et peut permettre une automatisation pouss√©e. Si vous √™tes int√©ress√©‚ãÖe par la domotique, sachez qu&amp;rsquo;il existe des petits modules appel√©s modules &lt;a href="https://fr.aliexpress.com/item/33061230430.html"&gt;Sonoff&lt;/a&gt; qui permettent de rendre &amp;ldquo;connect√©&amp;rdquo; n&amp;rsquo;importe quel appareil √©lectrique (une lampe de chevet par exemple) et qui, une fois un firmware (syst√®me d&amp;rsquo;exploitation) sp√©cial appel√© &lt;a href="https://tasmota.github.io/"&gt;Tasmota&lt;/a&gt; flash√© permettent aussi de publier des messages sur un broker MQTT. Si vous n&amp;rsquo;√™tes pas un aficionado de la ligne de commande, il existe des logiciels comme &lt;a href="https://nodered.org/"&gt;Node-RED&lt;/a&gt; ou &lt;a href="https://play.google.com/store/apps/details?id=com.llamalab.automate&amp;amp;hl=fr&amp;amp;gl=US"&gt;Automate&lt;/a&gt; sur Android qui permettent de s&amp;rsquo;essayer √† la domotique et l&amp;rsquo;automatisation facilement.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 09 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-09:/mqtt.html</guid><category>misc</category></item><item><title>V√©rifier l‚Äôint√©grit√© d'un syst√®me d'exploitation gr√¢ce √† Secure Boot.</title><link>https://ilearned.eu.org/secure_boot.html</link><description>&lt;p&gt;La s√©curit√© d&amp;rsquo;un syst√®me d√©pends de beaucoup de facteur, un des facteurs important est de pouvoir v√©rifier l‚Äôint√©grit√© du syst√®me d√©marr√©, en effet sans cette v√©rification un attaquant pourrait sans trop de difficult√©s modifier les fichiers de d√©marrage pour ajouter un malware. Cet article se concentrera sur les machines de bureaux.&lt;/p&gt;
&lt;p&gt;Pour bien comprendre comment peuvent √™tre effectu√©es des attaques pendant le boot il est important de comprendre le fonctionnement du d√©marrage en mode BIOS, et son rempla√ßant l&amp;rsquo;UEFI.&lt;/p&gt;
&lt;h2 id="bios"&gt;BIOS&lt;/h2&gt;
&lt;p&gt;Le d√©marrage en BIOS s&amp;rsquo;appuie sur une table des partitions en MBR (master boot record), pour d√©marrer le bios va ex√©cuter du code contenu dans la table des partitions, ce code s&amp;rsquo;occupe de passer la main au bootloader qui va s&amp;rsquo;occuper de lancer le syst√®me. Un probl√®me assez flagrant apparait d√©j√†, du code peut √™tre directement ins√©r√© dans cette partie, aucune v√©rification n&amp;rsquo;est effectu√©e par le BIOS. Un attaquant pourrait aussi attaquer le bootloader qui ne peut pas √™tre chiffr√©.&lt;/p&gt;
&lt;p&gt;Sous Linux (nous verrons le fonctionnement de Windows un peu plus loin) le bootloader le plus courant est grub, il ins√®re dans le MBR de quoi charger son code complet qui est contenu dans &lt;code&gt;/boot&lt;/code&gt;, la plupart des bootloader sous linux fonctionnent sur le m√™me principe.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un syst√®me non chiffr√©" src="/static/img/secure_boot/Boot_mbr.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour √©viter une modification du syst√®me on pourrait chiffrer le partition root (aussi appel√© Userland) et faire un /boot √† part (le bootloader ne peut pas √™tre chiffr√©), un probl√®me se pose alors, l&amp;rsquo;initramfs et le kernel sont toujours en clair.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un syst√®me chiffr√© avec seulement le userland de chiffr√©" src="/static/img/secure_boot/Boot_mbr(1).png"&gt;&lt;/p&gt;
&lt;p&gt;Grub (et c&amp;rsquo;est √† ma connaissance le seul) permet de d√©chiffrer le partition boot, pour garder l&amp;rsquo;initramfs et le kernel chiffr√©. Mais grub en lui m√™me est toujours modifiable, m√™me chose pour le code ex√©cut√© directement dans le MBR.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un syst√®me chiffr√© avec le userland et le kernel de chiffr√©" src="/static/img/secure_boot/Boot_mbr(2).png"&gt;&lt;/p&gt;
&lt;p&gt;En plus de ne pas √™tre totalement s√©curis√©, avec cette m√©thodes la phrase de passe doit √™tre tap√©e deux fois, une fois pour lire l&amp;rsquo;initramfs et une autre fois pour d√©chiffrer la partition root. (grub ne la retient pas).&lt;/p&gt;
&lt;p&gt;Une solution possible serait de signer les diff√©rents √©l√©ment du boot, le probl√®me est qu&amp;rsquo;en BIOS aucun m√©canisme pour la v√©rification de signature existe.&lt;/p&gt;
&lt;p&gt;Avec un BIOS nous n&amp;rsquo;avons pas de possibilit√© de s√©curiser enti√®rement un syst√®me Linux.&lt;/p&gt;
&lt;p&gt;Pour Windows, le concept est tr√®s proche, le BIOS va ex√©cuter le code dans le MBR, ce code va enclencher le bootloader de Windows qui, depuis Windows Vista, est bootmgr, chiffrer son disque pose le m√™me soucis que sous Linux, le bootloader restera en clair.&lt;/p&gt;
&lt;h2 id="uefi"&gt;UEFI&lt;/h2&gt;
&lt;p&gt;Avec UEFI on se passe de MBR au profit de GPT qui apporte un certain nombre d&amp;rsquo;avantages. Le processus de boot ne se passe plus par un code ex√©cutable dans la partie MBR, ce code est contenu dans une partition en FAT32 (ou FAT16), ce qui permet de ne plus √™tre aussi limit√© en taille, la partie d√©di√© au code de d√©marrage dans MBR n&amp;rsquo;est que de 446 bytes. UEFI apporte aussi une √©volution majeure pour la s√©curit√© : Secure Boot, c&amp;rsquo;est un moyen de v√©rifier l&amp;rsquo;int√©grit√© via une signature du fichier EFI. Un fichier EFI est un ex√©cutable lanc√© par l&amp;rsquo;UEFI, on pourrait le comparer aux ELF de Linux, ou aux exe de Windows.&lt;/p&gt;
&lt;p&gt;Lorsque qu&amp;rsquo;un pc avec Secure Boot d√©marre, il v√©rifie le binaire EFI, pour voir si la signature corresponds √† une cl√© de &amp;ldquo;confiance&amp;rdquo; et si la signature n&amp;rsquo;est pas dans dans la liste des cl√©s √† refuser.&lt;/p&gt;
&lt;p&gt;L&amp;rsquo;UEFI se base sur des variables pour les cl√©s, vous pouvez les voir depuis Linux via l&amp;rsquo;utilitaire &amp;ldquo;efi-readvars&amp;rdquo;, ce qui sur ma machine donne :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Variable PK, length 823
PK: List 0, type X509
    Signature 0, size 795, owner 5b2a4205-8ee1-404d-a357-45629f968019
        Subject:
            CN=Ramle PK
        Issuer:
            CN=Ramle PK
Variable KEK, length 825
KEK: List 0, type X509
    Signature 0, size 797, owner 5b2a4205-8ee1-404d-a357-45629f968019
        Subject:
            CN=Ramle KEK
        Issuer:
            CN=Ramle KEK
Variable db, length 823
db: List 0, type X509
    Signature 0, size 795, owner 5b2a4205-8ee1-404d-a357-45629f968019
        Subject:
            CN=Ramle DB
        Issuer:
            CN=Ramle DB
Variable dbx has no entries
Variable MokList has no entries
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Regardons de plus pr√®s chaque variable :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PK : C&amp;rsquo;est la cl√© la plus haute dans la chaine de confiance, elle est l√† pour signer la cl√© KEK, une seule cl√© est possible dans cette variable. En g√©n√©ral c&amp;rsquo;est le constructeur qui met sa cl√©, si vous voulez contr√¥ler totalement la chaine de confiance il faudra donc la changer.&lt;/li&gt;
&lt;li&gt;KEK : Ces cl√© sont utilis√©es pour signer les cl√©s qui iront dans DB ou DBX, souvent de base il y a 2 KEK, une pour Microsoft et une autre pour le Fabricant.&lt;/li&gt;
&lt;li&gt;DB : Ce sont les cl√©s utilis√©es pour la v√©rifications des binaires EFI, souvent l&amp;rsquo;ordinateur vient avec les cl√©s du constructeur, de Microsoft, Canonical (entreprise qui est derri√®re Ubuntu) et parfois d&amp;rsquo;autres entreprises.&lt;/li&gt;
&lt;li&gt;DBX : C&amp;rsquo;est la liste des cl√©s qui ne sont plus de confiance.&lt;/li&gt;
&lt;li&gt;MOKList : C&amp;rsquo;est utilis√© par un outil du nom de Shim, cet outil est l√† pour charger un autre bootloader qui ne serait pas sign√© avec les cl√©s pr√©sentent dans DB, Shim va v√©rifier le bootloader via les cl√©s dans la MOKList qui est g√©r√© par l&amp;rsquo;utilisateur, et non via l&amp;rsquo;UEFI directement.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="La chaine de confiance de Secure Boot" src="/static/img/secure_boot/Cl_secure_boot(1).png"&gt;&lt;/p&gt;
&lt;p&gt;Ces variables sont bien sur modifiable sur la plupart des pc, ce qui permet de g√©rer sa propre PKI (public key infrastructure).&lt;/p&gt;
&lt;p&gt;Si on veut un r√©el contr√¥le il faut g√©rer soit m√™me ses cl√©s, sous Linux c&amp;rsquo;est possible sans trop de difficult√©s, FreeBSD et OpenBSD semblent supporter aussi (je n&amp;rsquo;ai pas eu l&amp;rsquo;occasion de tester) et sous Windows on peut soit utiliser les cl√©s de Microsoft ou utiliser ses propres cl√©s ce qui semble en th√©orie possible.&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;esp√®re que cette article vous aura plus, je pense prochainement faire un petit guide pour la gestion de Secure Boot sous Linux, je vous laisse donc surveiller les sorties üëÄ. On se retrouve apr√®s demain pour un article sur MQTT&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Wed, 07 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-07:/secure_boot.html</guid><category>misc</category></item><item><title>Les version oubli√©es du protocole IP üîé</title><link>https://ilearned.eu.org/versions-ip.html</link><description>&lt;p&gt;On connait tous IPv4 et &lt;a href="https://blog.eban.bzh/today-i-learned/ipv6.html"&gt;IPv6&lt;/a&gt; qui sont deux protocoles largement r√©pandus (bien qu&amp;rsquo;un des deux ne le soit pas assez ^^), mais on pourrait l√©gitimement se demander s&amp;rsquo;il existe d&amp;rsquo;autres version du Protocole Internet, nous ferrons donc dans cet article un petit tour d&amp;rsquo;horizon des diff√©rentes it√©rations du protocole IP et de leurs sp√©cificit√©s.&lt;/p&gt;
&lt;h1 id="ipv1-2-et-3-la-genese-du-protocole-internet"&gt;IPv1 2 et 3 ‚àí La gen√®se du protocole Internet&lt;/h1&gt;
&lt;p&gt;Le premier document d√©crivant le fonctionnement d&amp;rsquo;IP est la &lt;a href="https://www.rfc-editor.org/rfc/rfc675.html"&gt;RFC 675&lt;/a&gt; publi√©e en 1974 mais pr√©sent√©e d√®s 1973 √† l&amp;rsquo;International Network Working Group. Si vous parcourez cette RFC vous remarquerez qu&amp;rsquo;elle ne fait pas mention du protocole IP, mais de TCP, en effet √† l&amp;rsquo;√©poque, TCP et IP n&amp;rsquo;√©taient pas s√©par√©s et le principe de couches apport√© notamment par le mod√®le TCP/IP, sortit en 1976, n&amp;rsquo;√©tait pas encore d&amp;rsquo;actualit√©. Parler d&amp;rsquo;IPv1 est donc un abus de langage, le terme adapt√© serait plut√¥t TCP version 1.&lt;/p&gt;
&lt;p&gt;Ce protocole avait une particularit√© int√©ressante, il contenait quatre champs adresse dans son header, contre deux pour IPv6. Un pour le r√©seau de destination (et d&amp;rsquo;origine), rappelez vous, nous sommes en 1974 et √† cette √©poque le r√©seau Internet comme nous le connaissons aujourd&amp;rsquo;hui n&amp;rsquo;existe pas, il existe donc diff√©rents r√©seaux concurrent, ce champ dans l&amp;rsquo;en-t√™te a pour but de sp√©cifier sur quel r√©seau le paquet doit transiter. Ainsi, vous pouvez voir ci-dessous les diff√©rentes valeurs possibles pour ce champ et donc les principaux r√©seaux qui cohabitent √† cette √©poque.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;1010&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ARPANET&lt;/span&gt;
&lt;span class="mf"&gt;1011&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UCL&lt;/span&gt;
&lt;span class="mf"&gt;1100&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CYCLADES&lt;/span&gt;
&lt;span class="mf"&gt;1101&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NPL&lt;/span&gt;
&lt;span class="mf"&gt;1110&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CADC&lt;/span&gt;
&lt;span class="mf"&gt;1111&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;EPSS&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Les troisi√®me et quatri√®me champs sont destin√©s √† accueillir les &lt;code&gt;adresses TCP&lt;/code&gt; d&amp;rsquo;origine et de destination, ces adresses ne sont pas tr√®s d√©taill√©es dans la RFC, mais on sait qu&amp;rsquo;elles sont d&amp;rsquo;une longueur de 16 bits (65 536 adresses diff√©rentes), elles correspondent peu ou prou √† ce qu&amp;rsquo;on appelle aujourd&amp;rsquo;hui &amp;ldquo;adresses IP&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Cette premi√®re version de TCP est vraiment exp√©rimentale, elle n&amp;rsquo;a pas √©t√© d√©ploy√©e √† grande √©chelle comme l&amp;rsquo;ont √©t√© IPv4 et IPv6&lt;/p&gt;
&lt;p&gt;Vient ensuite en 1977 la deuxi√®me version de TCP (et donc par extension du protocole internet), cette version, publi√©e dans l&amp;rsquo;&lt;a href="https://www.rfc-editor.org/in-notes/ien/ien5.pdf"&gt;IEN 5&lt;/a&gt;, apporte certaines am√©liorations dont notamment le passage √† un &amp;ldquo;Network Identifier&amp;rdquo;, ce qui √©tait auparavant appel√© r√©seau de destination/origine, cod√© sur 8 bits.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Liste des diff√©rents network" src="/static/img/versions-ip/network_list.png"&gt;&lt;/p&gt;
&lt;p&gt;Autre diff√©rence, les &amp;ldquo;host identifier&amp;rdquo;, anciennement appel√©s &lt;code&gt;adresses TCP&lt;/code&gt;, sont maintenant cod√©s sur 24 bits, soit un total de 16 777 216 adresses. On peut aussi voir le d√©but de la s√©paration entre TCP et IP dans ce sch√©ma d&amp;rsquo;√©poque avec les parties &amp;ldquo;TCP Header&amp;rdquo; et &amp;ldquo;Internet Header&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Header TCP o√π l'on voit deux parties, une appel√©e &amp;quot;TCP Header&amp;quot; et l'autre &amp;quot;IP Header&amp;quot;" src="/static/img/versions-ip/header.png"&gt;&lt;/p&gt;
&lt;p&gt;S√©paration qui sera &lt;a href="https://datatracker.ietf.org/doc/html/rfc760"&gt;act√©e&lt;/a&gt; dans la version 3 de TCP, publi√©e en 1978, ce qui repr√©sente une avanc√©e majeure dans l&amp;rsquo;√©volution du protocole internet.&lt;/p&gt;
&lt;h1 id="ipv5"&gt;IPv5&lt;/h1&gt;
&lt;p&gt;IPv5 n&amp;rsquo;a pas r√©ellement exist√©, il s&amp;rsquo;agit en fait du &lt;a href="https://datatracker.ietf.org/doc/html/rfc1190"&gt;Stream Protocol&lt;/a&gt;, abr√©g√© ST-II, un protocole de couche 3 (comme IP), cr√©√© pour faciliter l&amp;rsquo;envoi de vid√©o et d&amp;rsquo;audio par internet et qui avait dans le champ version la valeur 5. C&amp;rsquo;√©tait donc une version modifi√©e d&amp;rsquo;IPv4 mais qui avait des adresses cod√©es sur 32 bits, comme pour IPv4, qui ne r√©pondait donc pas √† la probl√©matique principale pos√©e par IPv4, le manque d&amp;rsquo;adresses. Ce protocole marque le d√©but de VoIP (Voice over IP) mais il ne sera pas d√©ploy√© √† grande √©chelle, VoIP sera ensuite simplement d√©ploy√© sur IPv4.&lt;/p&gt;
&lt;h1 id="ipv7-8-et-9-le-futur-ou-pas"&gt;IPv7, 8 et 9 ‚àí Le futur ? Ou pas&amp;hellip;&lt;/h1&gt;
&lt;p&gt;IPv7 est un protocole appel√© &lt;code&gt;TP/IX&lt;/code&gt; sortit en 1993, les adresses IP sont cod√©es sur 64 bits (contre 128 avec IPv6), on ne d√©taillera pas plus ce protocole mais si vous souhaitez en savoir plus je vous invite √† lire la &lt;a href="https://datatracker.ietf.org/doc/html/rfc1475"&gt;RFC&lt;/a&gt; d&amp;rsquo;IPv7 qui est tr√®s compr√©hensible.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://datatracker.ietf.org/doc/html/rfc1621"&gt;IPv8&lt;/a&gt; (mon petit pr√©f√©r√© ^^) appel√© &lt;code&gt;PIP&lt;/code&gt; et sortit en 1994 son fonctionnement repose en partie sur le syst√®me de &lt;a href="https://ilearned.eu.org/les-bases-du-dns.html"&gt;DNS&lt;/a&gt;, chaque utilisateur du r√©seau a un &lt;code&gt;PIP ID&lt;/code&gt;, un identifiant unique cod√© sur 64 bits, ainsi, peu importe d&amp;rsquo;o√π il se connecte sur le r√©seau, il est possible de l&amp;rsquo;identifier rien qu&amp;rsquo;avec son ID. &lt;code&gt;PIP&lt;/code&gt; a donc √©t√© avant tout pens√© pour faciliter les √©changes entre appareils changeant d&amp;rsquo;adresse IP. On pourrait par exemple imaginer une connexion SSH utilisant uniquement le &lt;code&gt;PIP ID&lt;/code&gt; pour s&amp;rsquo;authentifier et qui, m√™me si un des deux composants de la connexion (le client ou le serveur) change d&amp;rsquo;adresse IP reste stable. Je parlais plus t√¥t du DNS, en effet, avec &lt;code&gt;PIP&lt;/code&gt; le DNS est modifi√© pour renvoyer √† la fois l(es) adresse(s) IP mais aussi le &lt;code&gt;PIP ID&lt;/code&gt;. Ce syst√®me a n√©anmoins un probl√®me majeur, le &lt;code&gt;PIP ID&lt;/code&gt; permettrait de pister tr√®s facilement les utilisateurs.&lt;/p&gt;
&lt;p&gt;IPv9 enfin est un protocole tr√®s peu d√©taill√©, il avait √©t√© &lt;a href="http://www.china.org.cn/english/scitech/100279.htm"&gt;annonc√©&lt;/a&gt; en grande pompe par le gouvernement chinois, celui-ci se targuant du fait que cette version d&amp;rsquo;IP ait √©t√© adopt√©e dans les secteurs militaires et civils, mais depuis cet effet d&amp;rsquo;annonce aucune sp√©cification technique n&amp;rsquo;a √©t√© publi√©e, seulement des bruits de couloir comme quoi les adresses seraient cod√©es sur 256 bits et compos√©es uniquement de caract√®res num√©riques (et non pas hexad√©cimaux comme c&amp;rsquo;est le cas d&amp;rsquo;IPv6).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Mon, 05 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-05:/versions-ip.html</guid><category>misc</category></item><item><title>Mod√®le de s√©curit√© Windows</title><link>https://ilearned.eu.org/secu_windows.html</link><description>&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&amp;ldquo;Acc√®s refus√©&amp;rdquo;. S‚Äôil y a bien une erreur frustrante, c‚Äôest s√ªrement celle-ci. Sur Windows nous y sommes pourtant souvent confront√©s, surtout dans une perspective attaquante. En revanche, peu de gens comprennent pourquoi cette erreur (ou d‚Äôautres) vient s‚Äôimmiscer dans sa confortable utilisation de son syst√®me d‚Äôexploitation.&lt;/p&gt;
&lt;p&gt;Dans cet article, je t√¢cherais de vous pr√©senter, dans les grandes lignes, le mod√®le de s√©curit√© qu‚Äôutilise Windows, principalement les notions de privil√®ge d‚Äôacc√®s et de contr√¥le d‚Äôacc√®s.&lt;/p&gt;
&lt;p&gt;De mani√®re g√©n√©rale, lorsque je parlerais d‚Äôobjet Windows, je parlerais d‚Äôutilisateurs, de machines, de fichiers, ou encore de processus.&lt;/p&gt;
&lt;h2 id="contexte-de-securite"&gt;Contexte de s√©curit√©&lt;/h2&gt;
&lt;p&gt;Pour bien comprendre la suite, il est n√©cessaire de comprendre ce qu‚Äôest un contexte de s√©curit√© chez notre ami Windows. Ce dernier d√©signe un ensemble d‚Äôattributs ou de r√®gles de s√©curit√© actuellement en vigueur pour reprendre la d√©finition de Microsoft. Un contexte de s√©curit√© se traduira par une structure de donn√©es particuli√®res d√©finis par la &lt;code&gt;SSPI&lt;/code&gt; (&amp;ldquo;Security Support Provider Interface&amp;rdquo;), une &lt;code&gt;API&lt;/code&gt; Windows √©crite dans le but d‚Äôinteragir avec le contexte de s√©curit√©, elle est notamment utilis√©e, par exemple, pour l‚Äôauthentification. Autrement dit, le contexte de s√©curit√© d√©finit les √©l√©ments de bases du syst√®me de s√©curit√© de notre os favori (si c‚Äôest pas le cas faites comme si).&lt;/p&gt;
&lt;h2 id="securableobject"&gt;SecurableObject&lt;/h2&gt;
&lt;p&gt;Un objet est dit &amp;ldquo;s√©curisable&amp;rdquo; s‚Äôil a la capacit√© de poss√©der un descripteur de s√©curit√©. De mani√®res g√©n√©rales, √©norm√©ment d‚Äôobjet dans Windows sont des &lt;code&gt;SecurableObject&lt;/code&gt;. Les processus, les cl√©s de registre, les fichiers/r√©pertoires, les objets ‚ÄòActive Directory‚Äô et bien d‚Äôautres. Ils forment donc le c≈ìur des interactions entre nous et le syst√®me d‚Äôexploitation. J‚Äôai parl√© des descripteurs de s√©curit√©, ces derniers sont simplement des listes de plusieurs caract√©ristiques. Ils contiennent le &lt;code&gt;SID&lt;/code&gt; (&amp;ldquo;Security Identifier&amp;rdquo;, qui est un identifiant unique)  du propri√©taire de l‚Äôobjet, le &lt;code&gt;SID&lt;/code&gt; du groupe propri√©taire, et des &lt;code&gt;ACLs&lt;/code&gt; pour &amp;ldquo;Access Control Lists&amp;rdquo;. Les descripteurs de s√©curit√© sont usuellement au format &lt;code&gt;SDDL&lt;/code&gt; (&amp;ldquo;Security Descriptor Definition Langage&amp;rdquo;) bien que peu reluisant, il est en r√©alit√© tr√®s pratique car simple d‚Äôutilisation (non pas de compr√©hension).&lt;/p&gt;
&lt;h2 id="token-dacces"&gt;Token d‚Äôacc√®s&lt;/h2&gt;
&lt;p&gt;Lorsqu‚Äôun utilisateur Windows se connecte √† son compte local (ou Active Directory) plusieurs informations seront alors stock√©s dans la m√©moire. De mani√®re assez √©vidente, il contiendra le condensat du mot de passe (sauf configurations tr√®s improbable ou un syst√®me relativement vieux et dans ces cas pr√©cis, ce sera le mot de passe en claire), son &lt;code&gt;SID&lt;/code&gt;, le &lt;code&gt;SID&lt;/code&gt; de son groupe, des privil√®ges d‚Äôacc√®s (nous y reviendrons plus tard) et bien d‚Äôautres informations. On regroupe tout cela dans ce que l‚Äôon appelle un &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s. Ce dernier est alors gard√© dans un processus un peu particulier appel√© &lt;code&gt;LSASS.exe&lt;/code&gt; pour &amp;ldquo;Local Security Autority SubSystem Service&amp;rdquo;. Ce dernier est donc vital et tr√®s sensible.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Une fois le mot de passe sp√©cifi√©, un token est cr√©√©" src="/static/img/secu_windows/Auth LSASS.png"&gt;&lt;/p&gt;
&lt;p&gt;Lorsqu&amp;rsquo;on interagit avec le syst√®me d‚Äôune quelconque mani√®re, une copie de notre &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s est alors utilis√©e. Dans le cas d‚Äôun fichier, les informations que le &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s contient vont donc √™tre compar√©es avec les informations contenues dans la &lt;code&gt;DACL&lt;/code&gt; (qui est une liste contenant les acc√®s, plus d‚Äôinformation  sur ce sujet un peu apr√®s) garantissant ou non un acc√®s d‚Äôune certaine valeur. Il peut √™tre destin√© √† de l‚Äô√©criture, de la lecture ou bien m√™me pour de l‚Äôex√©cution.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Certaines informations du token sont compar√©es avec la DACL" src="/static/img/secu_windows/Principe d'acc√®s.png"&gt;&lt;/p&gt;
&lt;p&gt;Un cas plus int√©ressant est celui du d√©marrage d‚Äôun programme. En effet, ce dernier est lanc√© en tant qu‚Äôun utilisateur en particulier, il ne doit donc pas contourner ce fameux syst√®me d‚Äôacc√®s. C‚Äôest pourquoi les processus sont consid√©r√©s comme des &lt;code&gt;SecurableObject&lt;/code&gt;, et dans cette situation, une copie de notre &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s est √©galement donn√© et quand le programme interagira avec le syst√®me, il le fera bien selon les droits et l‚Äôidentit√© de l‚Äôutilisateur connect√©.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Lorsque l'on cr√©er un processus, on lui fournit notre token pour qu'il puisse l'utiliser" src="/static/img/secu_windows/Principe d'acc√®s √† un programme.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;La fonction &lt;a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa"&gt;&lt;code&gt;CreateProcessA()&lt;/code&gt;&lt;/a&gt; est une fonction de l&amp;rsquo;&lt;code&gt;API&lt;/code&gt; Windows &lt;code&gt;kernel32.dll&lt;/code&gt; qui permet de cr√©er un nouveau processus.&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="privileges-dacces"&gt;Privil√®ges d‚Äôacc√®s&lt;/h2&gt;
&lt;p&gt;Comme mentionn√© plus t√¥t, le &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s renferme en son sein un certain nombre de privil√®ges. Ces derniers sont attribu√©s √† chaque connexion, en fonction des r√®gles de s√©curit√©. Plus pr√©cis√©ment, les privil√®ges d‚Äôacc√®s sont donn√©s en fonction du groupe d‚Äôappartenance auquel on attribut des droits par d√©faut gr√¢ce aux &lt;code&gt;GPOs&lt;/code&gt; locales (dans &lt;code&gt;gpedit.msc&lt;/code&gt;, &lt;code&gt;Configuration Ordinateur \ Param√®tres windows\ Param√®tres de s√©curit√©\ Strat√©gies local\ Attribution des droits utilisateur&lt;/code&gt;). La liste de ces privil√®ges n‚Äôest pas pr√©sente sous forme d‚Äô√©num√©ration classique, en revanche voici une impl√©mentation en PowerShell pour bien se rendre compte de l‚Äôensemble de ces privil√®ges (issus de &lt;a href="https://github.com/jaredcatkinson/PSReflect-Functions"&gt;PSReflect-Functions&lt;/a&gt;).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;$SecurityEntity&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psenum&lt;/span&gt; &lt;span class="nv"&gt;$ENUM&lt;/span&gt; &lt;span class="n"&gt;SecurityEntity&lt;/span&gt; &lt;span class="n"&gt;UInt32&lt;/span&gt; &lt;span class="p"&gt;@{&lt;/span&gt;
    &lt;span class="n"&gt;SeCreateTokenPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;SeAssignPrimaryTokenPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;2&lt;/span&gt;
    &lt;span class="n"&gt;SeLockMemoryPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;3&lt;/span&gt;
    &lt;span class="n"&gt;SeIncreaseQuotaPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;4&lt;/span&gt;
    &lt;span class="n"&gt;SeUnsolicitedInputPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;5&lt;/span&gt;
    &lt;span class="n"&gt;SeMachineAccountPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;6&lt;/span&gt;
    &lt;span class="n"&gt;SeTcbPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;7&lt;/span&gt;
    &lt;span class="n"&gt;SeSecurityPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;8&lt;/span&gt;
    &lt;span class="n"&gt;SeTakeOwnershipPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;9&lt;/span&gt;
    &lt;span class="n"&gt;SeLoadDriverPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;10&lt;/span&gt;
    &lt;span class="n"&gt;SeSystemProfilePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;11&lt;/span&gt;
    &lt;span class="n"&gt;SeSystemtimePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;12&lt;/span&gt;
    &lt;span class="n"&gt;SeProfileSingleProcessPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;13&lt;/span&gt;
    &lt;span class="n"&gt;SeIncreaseBasePriorityPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;14&lt;/span&gt;
    &lt;span class="n"&gt;SeCreatePagefilePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;15&lt;/span&gt;
    &lt;span class="n"&gt;SeCreatePermanentPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;16&lt;/span&gt;
    &lt;span class="n"&gt;SeBackupPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;17&lt;/span&gt;
    &lt;span class="n"&gt;SeRestorePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;18&lt;/span&gt;
    &lt;span class="n"&gt;SeShutdownPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;19&lt;/span&gt;
    &lt;span class="n"&gt;SeDebugPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;20&lt;/span&gt;
    &lt;span class="n"&gt;SeAuditPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;21&lt;/span&gt;
    &lt;span class="n"&gt;SeSystemEnvironmentPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;22&lt;/span&gt;
    &lt;span class="n"&gt;SeChangeNotifyPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;23&lt;/span&gt;
    &lt;span class="n"&gt;SeRemoteShutdownPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;24&lt;/span&gt;
    &lt;span class="n"&gt;SeUndockPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;25&lt;/span&gt;
    &lt;span class="n"&gt;SeSyncAgentPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;26&lt;/span&gt;
    &lt;span class="n"&gt;SeEnableDelegationPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;27&lt;/span&gt;
    &lt;span class="n"&gt;SeManageVolumePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;28&lt;/span&gt;
    &lt;span class="n"&gt;SeImpersonatePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;29&lt;/span&gt;
    &lt;span class="n"&gt;SeCreateGlobalPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;30&lt;/span&gt;
    &lt;span class="n"&gt;SeTrustedCredManAccessPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;31&lt;/span&gt;
    &lt;span class="n"&gt;SeRelabelPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;32&lt;/span&gt;
    &lt;span class="n"&gt;SeIncreaseWorkingSetPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;33&lt;/span&gt;
    &lt;span class="n"&gt;SeTimeZonePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;34&lt;/span&gt;
    &lt;span class="n"&gt;SeCreateSymbolicLinkPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;35&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Et oui, 35 privil√®ges  √ßa fait beaucoup. Mais √† quoi servent-ils ? Ils permettent d‚Äôeffectuer certaines t√¢ches syst√®mes. Il ne faut donc pas les confondre avec les &lt;code&gt;ACE&lt;/code&gt; (&amp;ldquo;Access Control Entry&amp;rdquo;, qui repr√©sente un droit attribuer dans une &lt;code&gt;DACL&lt;/code&gt;), car ces derni√®res d√©finissent l‚Äôacc√®s √† un &lt;code&gt;SecurableObject&lt;/code&gt;. Par exemple, le droit &lt;code&gt;SeBackupPrivilege&lt;/code&gt; est donn√© √† tout membre du groupe &lt;code&gt;Backup Operators&lt;/code&gt; et permet de lire le contenu d‚Äôun fichier peu importe ses &lt;code&gt;ACLs&lt;/code&gt; (sauf si une interdiction explicite √† votre encontre est pr√©sente).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Si un privil√®ge est pr√©sent comme SeBackupPrivilege, l'√©tape de comparaison avec la DACL n'est pas effectu√©e" src="/static/img/secu_windows/Principe d'acc√®s √† un programme-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Le droit &lt;code&gt;SeRestorePrivilege&lt;/code&gt; permet identiquement d‚Äô√©crire un fichier. Le droit &lt;code&gt;SeDebugPrivilege&lt;/code&gt; (r√©serv√© aux Administrateurs), permet d‚Äôacc√©der et de manipuler la m√©moire d‚Äôun autre programme, un programme que nous n‚Äôavons pas lanc√©. C‚Äôest typiquement ce droit que demande Mimikatz pour acc√©der aux fameux condensats de mots de passe gard√© par &lt;code&gt;LSASS.exe&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Vous pouvez trouver une liste compl√®te des droits donn√©s par quel privil√®ge dans la &lt;a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/privilege-constants"&gt;documentation officielle de Microsoft&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ces privil√®ges, sont donc naturellement tr√®s puissant et il ne faut surtout pas n√©gliger leur s√©curit√©, qui poss√®de quoi. Bon, mais comment puis-je clairement savoir de quels privil√®ges je dispose ? La commande la plus simple pour cela est &lt;code&gt;whoami /all&lt;/code&gt;. &lt;code&gt;whoami.exe&lt;/code&gt; ouvre le &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s de son propre processus, or comme nous l‚Äôavons dit plus t√¥t, ce dernier contient toutes les informations dont le syst√®me √† besoin pour achever ses t√¢ches, notamment acc√©der aux &lt;code&gt;SecurableObject&lt;/code&gt;. Ainsi, nous pouvons voir nos privil√®ges (&lt;code&gt;whoami /priv&lt;/code&gt;), nos groupes (&lt;code&gt;whoami /groups&lt;/code&gt;), notre &lt;code&gt;SID&lt;/code&gt; (&lt;code&gt;whoami /user&lt;/code&gt;) et bien d‚Äôautres. Un petit exemple, une fois connect√©, je lance une invite de commande PowerShell et tape &lt;code&gt;whoami /priv&lt;/code&gt;. Par malchance, le droit semble alors d√©sactiv√©.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Windows PowerShell
Copyright (C) Microsoft Corporation. Tous droits r√©serv√©s.

Testez le nouveau syst√®me multiplateforme PowerShell https://aka.ms/pscore6

PS D:\&amp;gt; whoami /priv

Informations de privil√®ges
----------------------

Nom de privil√®ge              Description                                  √âtat
============================= ============================================ =========
SeShutdownPrivilege           Arr√™ter le syst√®me                           D√©sactiv√©
SeChangeNotifyPrivilege       Contourner la v√©rification de parcours       Activ√©
SeUndockPrivilege             Retirer l‚Äôordinateur de la station d‚Äôaccueil D√©sactiv√©
SeIncreaseWorkingSetPrivilege Augmenter une plage de travail de processus  D√©sactiv√©
SeTimeZonePrivilege           Changer le fuseau horaire                    D√©sactiv√©
PS D:\&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pour √©teindre mon ordinateur je dois donc activer ce droit. Gr√¢ce √† une magie occulte je peux l‚Äôactiver (en r√©alit√© j‚Äôuse simplement d‚Äôun impl√©mentation de la fonction &lt;code&gt;RtlAdjustPrivilege&lt;/code&gt; de &lt;code&gt;NTDLL.dll&lt;/code&gt;, qui permet d‚Äôajuster les privil√®ges pour notre processus, en PowerShell) et on peut alors voir que maintenant je peux √©teindre mon poste.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt; RtlAdjustPrivilege -Privilege SeShutdownPrivilege -Verbose
COMMENTAIRES : [RtlAdjustPrivilege] Attempting to enable &amp;#39;SeShutdownPrivilege&amp;#39; for the current process
COMMENTAIRES : [RtlAdjustPrivilege] enable for &amp;#39;SeShutdownPrivilege&amp;#39; successful
PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt; whoami /priv

Informations de privil√®ges
----------------------

Nom de privil√®ge              Description                                  √âtat
============================= ============================================ =========
SeShutdownPrivilege           Arr√™ter le syst√®me                           Activ√©
SeChangeNotifyPrivilege       Contourner la v√©rification de parcours       Activ√©
SeUndockPrivilege             Retirer l‚Äôordinateur de la station d‚Äôaccueil D√©sactiv√©
SeIncreaseWorkingSetPrivilege Augmenter une plage de travail de processus  D√©sactiv√©
SeTimeZonePrivilege           Changer le fuseau horaire                    D√©sactiv√©
PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Sauf qu‚Äôapr√®s une partie de &amp;ldquo;CS:GO&amp;rdquo; en compagnie d‚Äôune √©quipe russe le &amp;ldquo;ragequit&amp;rdquo; serait quelque peu ennuyant. C‚Äôest pour cela qu‚Äôil est possible d‚Äôactiver ou de d√©sactiver des privil√®ges. Attention, ces derniers doivent √™tre contenu dans notre &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s initiale, sinon cela serait beaucoup trop facile. Lorsque nous utilisons un programme tel &amp;ldquo;shutdown.exe&amp;rdquo; il va utiliser certaines fonctions de la &lt;code&gt;WinAPI&lt;/code&gt; (&lt;a href="https://docs.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges"&gt;&lt;code&gt;AdjustTokenPrivileges&lt;/code&gt;&lt;/a&gt; de &lt;code&gt;advapi32.dll&lt;/code&gt; pour les curieux) pour changer ses privil√®ges, et de ce fait pouvoir dire adieu √† notre partie gagn√©e d‚Äôavance.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pour activer un privil√®ge tel SeShutdownPrivilege, un programme comme shutdown.exe utilise AdjustTokenPrivileges" src="/static/img/secu_windows/Principe d'acc√®s √† un programme-2.png"&gt;&lt;/p&gt;
&lt;h2 id="les-listes-dacces"&gt;Les listes d‚Äôacc√®s&lt;/h2&gt;
&lt;p&gt;Il en existe deux types. La premi√®re est la &lt;code&gt;SACL&lt;/code&gt; pour &amp;ldquo;System Access Control List&amp;rdquo; qui est vraisemblablement la plus simple. En effet, elle permet d‚Äô√©tablir un certain nombre de r√®gles concernant l‚Äôaudit d‚Äôacc√®s √† l‚Äôobjet portant cette liste. On peut alors d√©finir dans cette derni√®re quel √©v√©nement, pour quel utilisateur, se doit d‚Äô√™tre inscrit dans les journaux d‚Äô√©v√©nements. L‚Äôautre type se nomme &lt;code&gt;DACL&lt;/code&gt; pour &amp;ldquo;Discretionary Access Control List&amp;rdquo;. La &lt;code&gt;DACL&lt;/code&gt; contient un certains nombres d‚Äô&lt;code&gt;ACE&lt;/code&gt; (&amp;ldquo;Access Control Entry&amp;rdquo;) qui pr√©cise le type de droit accord√© √† un objet. Leur structure est assez √©l√©mentaire. En outre, une &lt;code&gt;ACE&lt;/code&gt; contient un header d√©terminant son type c‚Äôest √† dire acc√®s autoris√© ou refus√© et d‚Äôautres informations. Le header, quant √† lui, contient le droit garantit ou non. Ce droit est appel√© masque d‚Äôacc√®s. On √©num√®re ce que l‚Äôon appelle les droits standards qui sont √©l√©mentaires:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DELETE&lt;/code&gt; est le droit de supprimer l‚Äôobjet, je vous l‚Äôaccorde il n‚Äô√©tait pas tr√®s complexe celui-l√†.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;READ_CONTROL&lt;/code&gt; est le droit de lire la &lt;code&gt;SACL/DACL&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WRITE_DAC&lt;/code&gt; est le droit de modifier les entr√©s de la &lt;code&gt;DACL&lt;/code&gt;, c‚Äôest √† dire ajouter des &lt;code&gt;ACEs&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WRITE_OWNER&lt;/code&gt; est le droit de modifier le propri√©taire d‚Äôun objet, l‚Äôint√©r√™t √©tant que ce dernier poss√®de implicitement tous les droits souhait√©s.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ces droits standards permettent alors de construire ce que l‚Äôon appelle les droits g√©n√©riques:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;GENERIC_READ&lt;/code&gt; permet, comme son nom l‚Äôindique, de lire les attributs et propri√©t√©s d‚Äôun objet. Si c‚Äôest un fichier par exemple, ce droit permet la lecture du contenu du fichier. Son √©quivalent sous linux est le flag &amp;ldquo;r&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GENERIC_WRITE&lt;/code&gt; permet la modification des propri√©t√©s et attributs de l‚Äôobjet. Pour continuer dans le pr√©c√©dent exemple, ce droit permet la modification de son contenu. Son √©quivalent sous linux est le flag &amp;ldquo;w&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GENERIC_EXECUTE&lt;/code&gt; permet de lire les permissions d‚Äôun objet. Factuellement si c‚Äôest un programme, il permet de le lancer. Son √©quivalent sous linux serait le flag &amp;ldquo;x&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GENERIC_ALL&lt;/code&gt; est la combinaison de ces droits. Attention cependant, il est sensiblement plus fort, dans de tr√®s rare cas. Il peut s‚Äôav√©rer que la combinaison &lt;code&gt;GENERIC_READ/WRITE/EXECUTE&lt;/code&gt; n‚Äôest pas √©quivalente √† &lt;code&gt;GENERIC_ALL&lt;/code&gt;, il n‚Äôa donc pas d‚Äô√©quivalent dans le syst√®me au pingouin.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Il en existe encore un grand nombre mais l‚Äôobjectif n‚Äôest pas l‚Äôexhaustivit√©. Pour voir ces acc√®s, il faut utiliser l‚Äôonglet s√©curit√© des propri√©t√©s d‚Äôun objet. On peut √©galement utiliser notre shell pr√©f√©rer aka PowerShell (l√† pour le coup, vous n‚Äôavez pas d‚Äôexcuse car PowerShell c‚Äôest g√©nial et opensource). Une commande particuli√®re est destin√©e √† cela: &lt;code&gt;Get-Acl&lt;/code&gt;. Elle prend comme argument le chemin vers notre objet, &lt;code&gt;-Path&lt;/code&gt; et ce sera globalement tout pour une utilisation simple. Le r√©sultat retourn√© est alors une &amp;ldquo;table&amp;rdquo; ce qui est assez inconfortable. Pour s‚Äôaffranchir de se probl√®me d‚Äôaffichage, on utilise un pipe &lt;code&gt;|&lt;/code&gt; vers la commande &lt;code&gt;Format-List&lt;/code&gt; (ou son alias &lt;code&gt;fl&lt;/code&gt;). On peut alors apercevoir entre autre le propri√©taire du fichier dans notre cas, les acc√®s accord√©s ainsi que le descripteur de s√©curit√© au format &lt;code&gt;SDDL&lt;/code&gt;. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt; Get-Acl .\ | fl


Path   : Microsoft.PowerShell.Core\FileSystem::D:\tools\PowerShellScript\PSReflect-Functions
Owner  : DESKTOP-8Q2CUHH\Lancelot
Group  : DESKTOP-8Q2CUHH\Aucun
Access : BUILTIN\Administrateurs Allow  FullControl
         BUILTIN\Administrateurs Allow  268435456
         AUTORITE NT\Syst√®me Allow  FullControl
         AUTORITE NT\Syst√®me Allow  268435456
         AUTORITE NT\Utilisateurs authentifi√©s Allow  Modify, Synchronize
         AUTORITE NT\Utilisateurs authentifi√©s Allow  -536805376
         BUILTIN\Utilisateurs Allow  ReadAndExecute, Synchronize
         BUILTIN\Utilisateurs Allow  -1610612736
Audit  :
Sddl   : O:S-1-5-21-1739485902-3336647338-3362325240-1001G:S-1-5-21-1739485902-3336647338-3362325240-513D:(A;ID;FA;;;BA)(A;OICIIOID;GA;;;BA)(A;ID;FA;;;SY)(A;OICIIOID;GA;;;SY)(A;ID;0x1301bf;;;AU)(A;OICIIOID;SD
         GXGWGR;;;AU)(A;ID;0x1200a9;;;BU)(A;OICIIOID;GXGR;;;BU)



PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Si vous souhaitez plus de pr√©cisions, je vous invite √† lire &lt;a href="http://theredwindows.net/index.php/2021/02/12/exploitation-dacl-en-active-directory/"&gt;mon article sur l‚Äôabus d‚ÄôACL en ActiveDirectory&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="resumons"&gt;R√©sumons&lt;/h1&gt;
&lt;p&gt;Lorsqu‚Äôun utilisateur se connecte √† sa session, des informations seront gard√©es en m√©moire dans un &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s. Lorsqu‚Äôil souhaite d√©marrer un programme, une copie de son &lt;code&gt;token&lt;/code&gt; est donn√©. Si ce dernier interagit avec le syst√®me, il devra utiliser ses privil√®ges pour r√©aliser certaines op√©rations. S‚Äôil n‚Äôest pas tout le temps n√©cessaire de les utiliser, lorsque l‚Äôon souhaite acc√©der √† un objet (fichier, processus ‚Ä¶) notre &lt;code&gt;token&lt;/code&gt; d‚Äôacc√®s sert de carte d‚Äôidentit√© qui sera comparer avec le contenu de la &lt;code&gt;DACL&lt;/code&gt; du descripteur de s√©curit√© de l‚Äôobjet auquel le programme/utilisateur souhaite acc√©der. En fonction des diff√©rentes entr√©s dans la liste d‚Äôacc√®s, il se verra refuser ou autoriser un certain acc√®s.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Description" src="https://ilearned.eu.org/static/img/secu_windows/schemasitemicrosoft.png"&gt;&lt;/p&gt;
&lt;p&gt;J‚Äôesp√®re que vous comprenez mieux √† pr√©sent la mani√®re dont l‚Äôos de Microsoft g√®re les permissions. Si cet article vous a plu, je vous invite √† consulter mes articles sur les privil√®ges d‚Äôacc√®s ainsi que sur l‚Äôabus des &lt;code&gt;ACLs&lt;/code&gt; en Active Directory (et oui m√™me si utile aux d√©fenseurs, ils sont aussi utile aux attaquants).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Lancelot</dc:creator><pubDate>Thu, 01 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-01:/secu_windows.html</guid><category>misc</category></item><item><title>Comment fonctionne le protocole TLS</title><link>https://ilearned.eu.org/tls.html</link><description>&lt;p&gt;TLS est un protocole que nous utilisons quotidiennement, il est notamment utilis√© dans &lt;code&gt;HTTPS&lt;/code&gt; pour s√©curiser la connexion. TLS est le successeur de SSL, nous verrons prochainement pourquoi SSL a √©t√© abandonn√© au profit de TLS. Dans cet article, nous √©tudierons TLS1.3 qui est la derni√®re version du protocole sortie en 2018. TLS se base √† la fois sur le chiffrement asym√©trique et le chiffrement sym√©trique. Un √©change de cl√© (appel√© handshake ou poign√©e de main) a lieu au d√©but de la connexion, une cl√© secr√®te est √©chang√©e de fa√ßon asym√©trique, cette cl√© est ensuite utilis√©e pour chiffrer les donn√©es (du chiffrement sym√©trique donc). Voyons donc plus en d√©tail comment se passe un handshake avec TLS1.3. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©mas d'un handshake TLS1.3" src="/static/img/tls/handshake.png"&gt;&lt;/p&gt;
&lt;p&gt;Le client envoie donc dans un premier temps un &lt;code&gt;**Client Hello**&lt;/code&gt; qui contient entre autre :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Les diff√©rents protocoles cryptographiques (pour le chiffrement asym√©trique et sym√©trique) qu&amp;rsquo;il supporte.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Key Share&lt;/code&gt; qui correspond a la cl√© publique du client, vous vous demanderez surement comment le client peut bien envoyer sa cl√© publique s&amp;rsquo;il ne sait pas les protocoles que le serveur supporte, c&amp;rsquo;est une diff√©rence majeur par rapport √† TLS 1.2, avec TLS 1.3 le client part du principe que le serveur supporte un certain nombre de protocoles et envoie sa cl√© publique pour un de ces protocoles, s&amp;rsquo;il s&amp;rsquo;av√®re que ce n&amp;rsquo;est pas le cas, le serveur va renvoyer un &lt;code&gt;HelloRetryRequest&lt;/code&gt; ainsi que les protocoles qu&amp;rsquo;il supporte.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Le serveur r√©pond ensuite avec un &lt;code&gt;**Server Hello**&lt;/code&gt; qui contient entre autre :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Le Certificat TLS qui permet d&amp;rsquo;assurer l&amp;rsquo;authenticit√© du serveur.&lt;/li&gt;
&lt;li&gt;Le &lt;code&gt;Certificate Verify&lt;/code&gt; qui correspond √† la signature du handshake, il est utilis√© pour s&amp;rsquo;assurer que  le handshake n&amp;rsquo;a pas √©t√© modifi√© en cours de route (dans le cas d&amp;rsquo;un attaque &lt;a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack"&gt;Man In The Middle&lt;/a&gt; par exemple).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Change Cipher Spec&lt;/code&gt; indique √† l&amp;rsquo;autre participant le passage √† un mode de chiffrement sym√©trique.&lt;/li&gt;
&lt;li&gt;Dans &lt;code&gt;Key Share&lt;/code&gt; le serveur indique sa cl√© publique&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Finished&lt;/code&gt; indique enfin la fin du handshake pour le client.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Le client envoie enfin pour terminer un &lt;code&gt;Change Cipher Spec&lt;/code&gt; et &lt;code&gt;Finished&lt;/code&gt;. Vous trouverez &lt;a href="/static/misc/tls/tls_1_3.pcapng"&gt;ici üìé&lt;/a&gt; un pcap d&amp;rsquo;un requ√™te avec TLS 1.3.&lt;/p&gt;
&lt;p&gt;En parcourant vous verrez que la version de TLS affich√©e est TLS 1.2, &lt;em&gt;it&amp;rsquo;s not a bug, it&amp;rsquo;s a feature&lt;/em&gt; c&amp;rsquo;est en fait pour √©viter que certaines middlebox &lt;s&gt;de merde üò°&lt;/s&gt;, utilis√©es notamment en entreprise pour espionner le trafic, bloquent le trafic pour des version de TLS au dessus de TLS 1.2.&lt;/p&gt;
&lt;p&gt;Des paires de cl√©s publique/priv√©e sont d√©riv√©es un cl√© secr√®te afin de chiffrer de fa√ßon sym√©trique les √©changes. Nous d√©taillerons bient√¥t plus en d√©tail ce fonctionnement au travers d&amp;rsquo;ECDH.&lt;/p&gt;
&lt;p&gt;Vous l&amp;rsquo;aurez s√ªrement remarqu√©, le nom de domaine est en clair dans les requ√™tes, √† la base une fonctionnalit√© appel√©e ESNI (Encrypted Server Name Indication) qui permet de chiffrer le nom de domaine dans les requ√™tes aurait d√ª √™tre impl√©ment√©e dans TLS 1.3 mais ce n&amp;rsquo;est pas encore le cas, ESNI n&amp;rsquo;est qu&amp;rsquo;√† l&amp;rsquo;√©tat de &lt;a href="https://www.ietf.org/archive/id/draft-ietf-tls-esni-10.html"&gt;draft&lt;/a&gt;&amp;hellip; üòï&lt;/p&gt;
&lt;p&gt;Une autre fonctionnalit√© importante dans TLS 1.3 est le 0 RTT, c&amp;rsquo;est une fonctionnalit√© tr√®s controvers√©e car elle ne respecte pas le principe de &lt;code&gt;forward-secrecy&lt;/code&gt;, si un attaquant arrive √† trouver la cl√© utilis√©e pour le chiffrement sym√©trique, il pourra d√©chiffrer toutes les prochaines requ√™tes. Elle consiste, pour faire simple, √† garder une m√™me cl√© sym√©trique pour plusieurs √©changes afin de reprendre un √©change sans avoir √† faire de handshake, mais cette fonctionnalit√© est une fausse bonne id√©e&amp;hellip;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sun, 30 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-30:/tls.html</guid><category>misc</category></item><item><title>S√©curiser votre r√©seau local avec 802.1x</title><link>https://ilearned.eu.org/802_1x.html</link><description>&lt;p&gt;En entreprise comme dans un r√©seau domestique, le contr√¥le d&amp;rsquo;acc√®s au LAN (r√©seau local) est primordial pour garantir la s√©curit√© des donn√©es transmises sur ce r√©seau, on conna√Æt tous la classique authentification par mot de passe est la m√©thode d&amp;rsquo;authentification utilis√©e dans la grand majorit√© des points d&amp;rsquo;acc√®s (= AP) grand publique, mais un simple mot de passe ne permet pas, par exemple, de donner des acc√®s diff√©rents au r√©seau en fonction des utilisateurs, pour pallier √† ce probl√®me, le standard 802.1x a √©t√© cr√©√©, il est normalis√© dans la RFC . Ce standard s&amp;rsquo;appuie sur le protocole EAP que nous allons d√©tailler dans cet article.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma simple fonctionnement EAP avec interm√©diaire Authenticator" src="/static/img/802_1x/Frame_50.png"&gt;&lt;/p&gt;
&lt;p&gt;L&amp;rsquo;authenticator (un point d&amp;rsquo;acc√®s wifi dans notre exemple mais la m√™me chose peut √™tre mis en place en Ethernet) est un interm√©diaire entre l&amp;rsquo;utilisateur et l&amp;rsquo;authentication server, la majorit√© du temps un serveur &lt;a href="https://blog.eban.bzh/misc/RADIUS.html"&gt;RADIUS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma d'un requ√™te EAP" src="/static/img/802_1x/Frame_53(1).png"&gt;&lt;/p&gt;
&lt;p&gt;Identity request correspond √† la demande du username au client par l&amp;rsquo;authenticator&lt;/p&gt;
&lt;p&gt;Identity response est ce nom d&amp;rsquo;utilisateur, cette information est demand√©e pour permettre √† l&amp;rsquo;Authentication Server de savoir quelle challenge demander, il existe plusieurs types de challenge en voici quelques-uns&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;MD5&lt;/code&gt; (simple mot de passe hash√© avec MD5, cette m√©thode est controvers√©e car MD5 n&amp;rsquo;est pas consid√©r√© comme s√©curis√©).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SIM&lt;/code&gt; (authentification bas√©e sur la carte SIM).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NFC&lt;/code&gt; (authentification bas√©e sur le protocole NFC, c&amp;rsquo;est par exemple utilis√© sur les badges d&amp;rsquo;entreprise.)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Le ou les challenges sont ensuite envoy√©s tour √† tour dans des paquets &lt;code&gt;Challenge Request&lt;/code&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 21 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-21:/802_1x.html</guid><category>misc</category></item><item><title>Fonctionnement de RADIUS</title><link>https://ilearned.eu.org/RADIUS.html</link><description>&lt;p&gt;Une question se pose parfois, comment g√©rer facilement de l&amp;rsquo;authentification et des autorisations d&amp;rsquo;utilisateur sur un r√©seau avec plusieurs machines sans r√©pliquer la liste d&amp;rsquo;utilisateur avec les propri√©t√©s unique √† chacun sur chaque machine.&lt;/p&gt;
&lt;p&gt;Une solution pour ce genre de cas est RADIUS, c&amp;rsquo;est un protocole qui permet d&amp;rsquo;authentifier et de donner une liste de propri√©t√© pour un utilisateur.&lt;/p&gt;
&lt;p&gt;Un cas d&amp;rsquo;usage est par exemple un stockage r√©seau (aussi appel√© &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt;). Le serveur &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt; va demander l&amp;rsquo;utilisateur et le mot de passe au client, il va ensuite se connecter avec le serveur RADIUS pour valider l&amp;rsquo;authentification.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Demande d'acc√®s depuis le client" src="/static/img/client_nas_radius.png"&gt;&lt;/p&gt;
&lt;p&gt;√Ä chaque requ√™te le &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt; transmet les identifiants que le client lui a envoy√© afin de savoir s&amp;rsquo;il peut acc√©der √† la ressource demand√©e. Le client RADIUS (ici le &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt;) doit s&amp;rsquo;authentifier aupr√®s du serveur RADIUS, pour se faire il utilise un secret qui est partag√© entre le serveur RADIUS et le &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt;. Ce secret permet aussi de chiffrer les identifiants de l&amp;rsquo;utilisateur via un &amp;ldquo;&lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt;&amp;rdquo;, un &lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt; est un moyen de chiffrer sur base d&amp;rsquo;une cl√© unique, on parle donc de chiffrement sym√©trique.&lt;/p&gt;
&lt;p&gt;La communication entre le serveur RADIUS et son client se base sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; (il peut aussi passer par &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, mais nous n&amp;rsquo;en parlerons pas), le client doit donc √™tre capable de g√©rer la retransmission dans le cas ou aucune r√©ponse ne lui est accord√©e.&lt;/p&gt;
&lt;p&gt;La phase d&amp;rsquo;authentification du client se base sur un paquet contenant l&amp;rsquo;utilisateur et le mot de passe. Ce paquet est nomm√© &lt;code&gt;Access Challenge&lt;/code&gt;, il contient par exemple l&amp;rsquo;attribut &lt;code&gt;User-Name = ramle&lt;/code&gt; et &lt;code&gt;User-Passsword = phrase-de-passe&lt;/code&gt;. Le client re√ßoit ensuite une r√©ponse du serveur, si le client RADIUS n&amp;rsquo;est pas connu du serveur il ne recevra pas de r√©ponse. Si le client est connu alors, le serveur peut r√©pondre de 3 mani√®res &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Access-Accept&lt;/code&gt; en cas d&amp;rsquo;identifiant valide&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Access-Reject&lt;/code&gt; en cas d&amp;rsquo;identifiant invalide&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Acces-Challenge&lt;/code&gt; si l&amp;rsquo;authentification requiert plus de param√®tre, par exemple un code PIN ou un carte d&amp;rsquo;acc√®s.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La r√©ponse du serveur inclut aussi des informations suppl√©mentaire appel√© &lt;code&gt;attribut&lt;/code&gt;, ce champs peut contenir des informations sur l&amp;rsquo;adresse IP qui doit √™tre assign√© √† l&amp;rsquo;appareil, √† la VLAN dans le quel il doit se trouver et bien d&amp;rsquo;autre param√®tre.&lt;/p&gt;
&lt;p&gt;Le paquet RADIUS se forme en plusieurs partie :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Code&lt;/strong&gt; : Il d√©finit le type de paquet&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Identifier&lt;/strong&gt; : Il identifie le paquet, ce m√©canisme permet de d√©tecter une duplication, ou de savoir √† quelle demande correspond la r√©ponse car la r√©ponse garde le m√™me identifiant que la demande.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Authenticator :&lt;/strong&gt; Il authentifie la demande du client ou du serveur&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Attributes&lt;/strong&gt; : il permet de donner les attributs sp√©cifiques au client&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Paquet RADIUS" src="/static/img/paquet_radius.png"&gt;&lt;/p&gt;
&lt;p&gt;La partie &lt;code&gt;Authenticator&lt;/code&gt; du paquet dans la requ√™te &lt;code&gt;Access Challenge&lt;/code&gt; est int√©ressante √† √©tudier, cette partie ne contient que 16bits et n√©cessite un haut taux de confidentialit√© car il contient le mot de passe utilisateur. On utilise &lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt; et le secret √©voqu√© plus haut, dans le cas ou le password est trop long, il est alors hash√© en MD5 puis transform√© via un &lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;RADIUS g√®re aussi l&amp;rsquo;itin√©rance, le serveur RADIUS du r√©seau local fera donc un proxy pour renvoyer la requ√™te au serveur qui g√®re l&amp;rsquo;utilisateur. Le canal peut √™tre s√©curis√© de plusieurs mani√®res, soit un tunnel chiffr√© entre les 2, ou bien en s√©curisant le canal avec le protocole TLS.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Riaming Raadius" src="/static/img/roaming_radius.png"&gt;&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;esp√®re que cette article vous aura plus :), on se retrouve demain pour parler de &lt;strong&gt;802.1x&lt;/strong&gt;, un protocole utilisant RADIUS.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Thu, 20 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-20:/RADIUS.html</guid><category>misc</category></item><item><title>Comment fonctionne HTTP/3 ?</title><link>https://ilearned.eu.org/http3.html</link><description>&lt;p&gt;Il n&amp;rsquo;y a pas longtemps nous avions d√©couvert le fonctionnement d&amp;rsquo;&lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt;, et diff√©rentes versions de ce protocoles, mais l&amp;rsquo;une d&amp;rsquo;elle n&amp;rsquo;a pas √©t√© vue : HTTP/3, cette version apporte un changement sur la m√©thode de transport en se basant sur QUIC qui lui m√™me utilise &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; au lieu de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pour commencer, regardons de plus pr√®s QUIC, il existe pour le moment deux versions de ce protocole, une faite par Google qui n&amp;rsquo;a pas √©t√© standardis√©e, et une qui est en cours de r√©daction pour √™tre publi√©e sous forme d&amp;rsquo;une RFC √† l&amp;rsquo;IETF (l&amp;rsquo;organe qui s&amp;rsquo;occupe de la publication des RFC). La version de Google se concentre sur HTTP/3, contrairement √† la version de l&amp;rsquo;IETF qui veut faire de QUIC un protocole de transport servant pour d&amp;rsquo;autres usages que &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt;, pour le &lt;a href="https://blog.eban.bzh/today-i-learned/les-bases-du-dns.html"&gt;DNS&lt;/a&gt; par exemple.&lt;/p&gt;
&lt;p&gt;Pour le moment l&amp;rsquo;IETF (qui se base en partie sur les travaux de Google) est encore au stade de r√©daction de la norme et se concentre sur HTTP/3 comme usage pour la premi√®re version. Cet article se basera sur les travaux de l&amp;rsquo;IETF et non ceux de Google.&lt;/p&gt;
&lt;p&gt;Pour commencer, QUIC se base sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; et veut r√©soudre certains probl√®me de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, avec HTTP/2 par exemple, plusieurs transferts sont effectu√©s sur un seul flux &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, je vous renvoie vers l&amp;rsquo;article sur &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt; qui explique en d√©tail ce concept, avec &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; si dans la liste des paquets en attente un paquet se perd tous les paquets avant celui perdu devront attendre le renvoi. On peut faire un parall√®le avec un embouteillage de voiture, si une voiture bloque la route, celles qui pr√©c√®dent la voiture devront attendre son passage.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Congestion des paquets" src="/static/img/congestion_http.png"&gt;&lt;/p&gt;
&lt;p&gt;TCP rajoute aussi une latence importante due aux diff√©rents handshakes, &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; n&amp;rsquo;utilise pas de s√©quence de handshake. QUIC en rajoute pour assurer un minimum de fiabilit√©. On compte au total 4 aller-retours pour r√©cup√©rer une page (ou un code d&amp;rsquo;erreur) contre 6 dans les versions d&amp;rsquo;HTTP bas√©e sur &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;. Le client commence par l&amp;rsquo;envoi d&amp;rsquo;un &amp;ldquo;hello&amp;rdquo; pour donner diff√©rents param√®tres sur lui, ensuite le serveur r√©pond en envoyant directement le certificat et les informations pour commencer l&amp;rsquo;√©change de donn√©e, le client envoie ensuite sa requ√™te avec la m√©thode. Le client finit par y r√©pondre par le code de retour ou la page demand√©e.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comparaison handshake HTTP vs HTTP/3" src="/static/img/http_handshake_vs.png"&gt;&lt;/p&gt;
&lt;p&gt;QUIC fonctionne sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; comme dit plus haut, il force un certain niveau de s√©curit√© en imposant TLS en version 1.3, pour les communications. Il offre aussi une certaine fiabilit√© qu&amp;rsquo;UDP ne poss√®de pas, rappelez-vous, &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; ne v√©rifie rien. QUIC r√©sout ce probl√®me en ajoutant une couche qui permet de g√©rer une retransmission de paquet au cas o√π celui-ci se perdrait en chemin, il permet aussi un contr√¥le de la congestion, la congestion en r√©seau c&amp;rsquo;est la saturation du r√©seau en lui m√™me, cela cause un ralentissement ou une perte de paquet dans les cas extr√™mes, le protocole est donc pas loin de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; sur la fiabilit√©.&lt;/p&gt;
&lt;p&gt;Sur un seul canal &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt;, QUIC permet de faire placer plusieurs flux en simultan√©.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Canal QUIC" src="/static/img/quic.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour le moment, nous avons vu principalement QUIC, la raison est que HTTP/3 n&amp;rsquo;apporte pas grand chose, c&amp;rsquo;est HTTP/2 adapt√© pour passer au dessus de QUIC, il y a quelques diff√©rences mineures comme la compression des en-t√™tes qui est adapt√© au protocole, mais les modifications sont mineure et viennent surtout adapt√© &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt; pour QUIC. Le rapprochement avec HTTP/2 est plut√¥t logique d&amp;rsquo;ailleurs si on regarde la chronologie le travail sur HTTP/3 √† commenc√© dans la m√™me p√©riode.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Couche HTTP/3" src="/static/img/couche_http3.png"&gt;&lt;/p&gt;
&lt;p&gt;Un point utile √† aborder est de savoir comment le client sait si il doit communiqu√© en HTTP/3 ou non. En effet, les anciennes version d&amp;rsquo;HTTP utilise &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; contrairement √† HTTP/3 qui utilise &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt;. Pour informer le navigateur de la pr√©sence d&amp;rsquo;HTTP/3 l&amp;rsquo;en-t√™te &lt;code&gt;Alt-Svc&lt;/code&gt; √† √©t√© cr√©e, elle indique le port &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; sur le quel le client doit aller voir, on peut aussi via l&amp;rsquo;en-t√™te indiquer un domaine diff√©rent.&lt;/p&gt;
&lt;p&gt;L&amp;rsquo;am√©lioration qu&amp;rsquo;apporte HTTP/3 est relativement mineure mais se r√©v√®le assez utile, sur une connexion stable avec peu de perte de paquet la diff√©rence n&amp;rsquo;est pas forc√©ment visible, mais sur un r√©seau satur√© avec un grand nombre de perte ne pas renvoyer toute la queue √† chaque perte est un gain non n√©gligeable. Une observation faite par certains est que HTTP/3 demande plus de CPU pour le serveur, √ßa peut √™tre un frein pour le d√©ploiement. Il faut aussi gard√© en t√™te que QUIC est assez nouveau, les impl√©mentations ne sont pas encore parfaite, le temps dira si ce protocole vaut le coup ou non.&lt;/p&gt;
&lt;p&gt;Niveau performance, HTTP/3 apporte un gain au niveau de la latence gr√¢ce √† la poign√©e de main r√©duite, pour ce qui est de la vitesse de chargement, la prioritisation des flux, et la possibilit√© d&amp;rsquo;envoyer sur plusieurs flux en simultan√© permet de gagner un peu. Selon &lt;a href="https://blog.cloudflare.com/http-3-vs-http-2/"&gt;Cloudflare&lt;/a&gt; HTTP/3 am√©liore le temps d&amp;rsquo;√©tablissement de la premi√®re connexion de 12,4%, pour ce qui est du chargement d&amp;rsquo;une page, ici leur propre blog, le temps diminue entre 1 et 4%, c&amp;rsquo;est au final assez peu, mais sur une connexions assez lente quelques pour-cent n&amp;rsquo;est pas n√©gligeable.&lt;/p&gt;
&lt;p&gt;Si vous regardez un peu en d√©tail votre navigateur vous remarquerez qu&amp;rsquo;HTTP/3 n&amp;rsquo;est pas encore activ√© par d√©faut, en effet ce protocole bien que prometteur n&amp;rsquo;est pas encore standardis√© et est tr√®s minoritaire. Si par curiosit√© vous voulez tout de m√™me activ√© dans &lt;code&gt;about:config&lt;/code&gt; sur votre firefox vous pouvez changez la configuration &lt;code&gt;network.http.http3.enabled&lt;/code&gt; vers &lt;code&gt;true&lt;/code&gt;. Sachez toutefois que des sites comme celui de Cloudflare o√π de Google int√®grent d√©j√† HTTP/3 ! &lt;/p&gt;
&lt;p&gt;J&amp;rsquo;esp√®re que cet article vous aura plus :), on se retrouve demain pour parler de &lt;strong&gt;radius.&lt;/strong&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Tue, 18 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-18:/http3.html</guid><category>misc</category></item><item><title>S√©curiser NTP, √† quoi bon ?</title><link>https://ilearned.eu.org/securiser_ntp.html</link><description>&lt;p&gt;Nous avons vu jeudi comment fonctionne le protocole NTP mais il reste un dernier point √† aborder, comment assurer l&amp;rsquo;int√©grit√© des donn√©es transmises via NTP ? Vous vous demanderez s√ªrement, √† quoi bon s√©curiser le protocole NTP, alors qu&amp;rsquo;il ne transmet que le temps ü§î. Le temps est une donn√©e tr√®s importante en informatique, plus qu&amp;rsquo;on ne pourrait le penser de prime abord, il est utilis√© dans de nombreux protocoles cryptographiques, comme par exemple dans &lt;code&gt;TLS&lt;/code&gt; ou &lt;a href="https://blog.eban.bzh/today-i-learned/dnssec.html"&gt;&lt;code&gt;DNSSEC&lt;/code&gt;&lt;/a&gt; avec le syst√®me de TTL (time to live). Pour s√©curiser NTP de nombreux protocoles ont √©t√© propos√©s et mis en place, nous en citerons ici trois.&lt;/p&gt;
&lt;h2 id="le-chiffrement-symetrique"&gt;Le chiffrement sym√©trique&lt;/h2&gt;
&lt;p&gt;Dans NTP3 est ajout√© le syst√®me d&amp;rsquo;authentification par cl√©s sym√©triques, un secret partag√© est √©chang√© la premi√®re fois entre le client et le serveur et c&amp;rsquo;est ce secret qui est ensuite utilis√© pour s√©curiser la connexion. Mais cette m√©thode pose un gros probl√®me, il est n√©cessaire d&amp;rsquo;√©changer une cl√© secr√®te la premi√®re fois, elle est donc tr√®s difficilement automatisable et impossible √† d√©ployer √† grand √©chelle.&lt;/p&gt;
&lt;h2 id="autokey"&gt;Autokey&lt;/h2&gt;
&lt;p&gt;Une autre approche a √©t√© &lt;code&gt;autokey&lt;/code&gt;, ce syst√®me utilis√© du &lt;a href="https://fr.wikipedia.org/wiki/Cryptographie_asym%C3%A9trique"&gt;chiffrement asym√©trique&lt;/a&gt; et r√©sous donc les probl√®mes qui se posaient avec le chiffrement sym√©trique, en partie seulement, car le protocole &lt;code&gt;autokey&lt;/code&gt; a de grosses lacunes en terme de s√©curit√©, un comble, effet la taille du cookie utilis√© pour s&amp;rsquo;authentifier avec autokey est de seulement 32 bits, ce qui le rend tr√®s vuln√©rable, mais ce n&amp;rsquo;est pas le seul probl√®me d&amp;rsquo;autokey, le client n&amp;rsquo;est identifi√© que par son IP, un attaquant pourrait donc se faire passer pour le client et d√©rober le cookie.&lt;/p&gt;
&lt;h2 id="network-time-security-nts"&gt;Network Time Security (NTS)&lt;/h2&gt;
&lt;p&gt;Pour pallier aux faiblesses de ces deux protocoles, un nouveau protocole est un cours de cr√©ation, NTS (standardis√© dans la &lt;a href="https://datatracker.ietf.org/doc/rfc8915/"&gt;RFC 8915&lt;/a&gt; il se base sur le principe du chiffrement asym√©trique sans les probl√®mes d&amp;rsquo;autokey. Ce protocole se base en partie sur TLS pour l&amp;rsquo;√©change de cl√©s, il utilise ensuite les parties des headers sp√©cifiques √† NTP pour s√©curiser le reste de la connexion. C&amp;rsquo;est un protocole prometteur mais qui n&amp;rsquo;est malheureusement pas encore assez impl√©ment√©.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 15 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-15:/securiser_ntp.html</guid><category>misc</category></item><item><title>NTP, comment √ßa marche ?</title><link>https://ilearned.eu.org/ntp.html</link><description>&lt;p&gt;Depuis la d√©mocratisation d&amp;rsquo;internet et de l&amp;rsquo;informatique en g√©n√©ral, une question s&amp;rsquo;est pos√©e, comment faire en sorte que les horloges de tous les ordinateurs soient coordonn√©es ? En septembre 1985 une premi√®re version du protocole NTP (Network Time Protocol) est publi√©e dans la &lt;a href="https://datatracker.ietf.org/doc/html/rfc958"&gt;RFC 958&lt;/a&gt;, ce protocole se base sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; pour sa l√©g√®ret√©. NTP fonctionne sur une typologie de r√©seau dite &lt;em&gt;mesh&lt;/em&gt;, elle est d√©coup√©e en strates afin de d√©livrer un temps √©quivalent partout et d&amp;rsquo;assurer une redondance. &lt;/p&gt;
&lt;p&gt;&lt;img alt="L'architecture de NTP" src="/static/img/ntp/schema_archi.png"&gt;&lt;/p&gt;
&lt;p&gt;Les serveurs de strate 1 sont les horloges principales, le temps qu&amp;rsquo;elles donne peut provenir de diff√©rentes sources comme le &lt;a href="https://en.wikipedia.org/wiki/Global_Positioning_System"&gt;GPS&lt;/a&gt; ou une &lt;a href="https://fr.wikipedia.org/wiki/Horloge_atomique"&gt;horloge atomique&lt;/a&gt;. Les serveurs des strates plus basse s&amp;rsquo;√©changent entre eux leur temps afin de v√©rifier qu&amp;rsquo;il correspond bien. Quand nous, utilisateurs, acc√©dons √† un serveur NTP, on acc√®de bien souvent √† un serveur de strate 2 ou 3.&lt;/p&gt;
&lt;p&gt;Voici √† quoi ressemble une requ√™te NTP : &lt;/p&gt;
&lt;p&gt;&lt;img alt="Les headers d'une requ√™te NTP" src="/static/img/ntp/schema_headers.png"&gt;&lt;/p&gt;
&lt;p&gt;√áa fait pas mal de parties üòÑ. Nous ne commenterons ici que les plus importantes.&lt;/p&gt;
&lt;p&gt;LI, Leap Indicator indique une &lt;a href="https://fr.m.wikipedia.org/wiki/Seconde_intercalaire"&gt;seconde intercalaire&lt;/a&gt; imminente. Une seconde intercalaire correspond, pour faire simple, √† une seconde ajout√©e sur toutes les horloges occasionnellement afin de synchroniser le temps universel coordonn√© (UTC) avec le temps solaire. &lt;/p&gt;
&lt;p&gt;VN, Version Number indique simplement la version de NTP utilis√©e.&lt;/p&gt;
&lt;p&gt;Mode, indique le mode dans lequel est l&amp;rsquo;√©metteur, client, serveur etc.&lt;/p&gt;
&lt;p&gt;Poll correspond √† l&amp;rsquo;intervalle √† laquelle le client doit reinterroger le serveur NTP.&lt;/p&gt;
&lt;p&gt;Root delay correspond au temps pour faire un aller-retour vers un serveur de strate 1. Et root dispersion est une estimation de la marge d&amp;rsquo;erreur du serveur de strate 1.&lt;/p&gt;
&lt;p&gt;Reference ID correspond au type d&amp;rsquo;outil utilis√© par le serveur root (strate 1) comme par exemple le GPS ou une horloge atomique.&lt;/p&gt;
&lt;p&gt;Reference Timestamp est le temps de la derni√®re mise √† jour via NTP. &lt;/p&gt;
&lt;p&gt;Les trois autres timestamps sont d√©cris ci-dessous &lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma repr√©sentant les diff√©rents timestamp" src="/static/img/ntp/schema_timestamps.png"&gt;&lt;/p&gt;
&lt;p&gt;Le &lt;code&gt;destination timestamp&lt;/code&gt; n&amp;rsquo;est logiquement pas inclut dans les headers, il est dans ce sch√©ma √† titre informatif.&lt;/p&gt;
&lt;p&gt;√áa fait beaucoup de param√®tres üòÖ Mais gr√¢ce √† toutes ces informations on peut avoir une pr√©cision de l&amp;rsquo;ordre de quelques nanosecondes en soustrayant le temps de transfert !&lt;/p&gt;
&lt;p&gt;Un dernier probl√®me se pose, comment assurer le fait que le serveur NTP ne se fasse pas usurper ? Nous avons d√©j√† √©tudi√© dans d&amp;rsquo;autres articles des moyens de signature cryptographique, NTP impl√©mente aussi une solution de ce type que nous √©tudierons tr√®s prochainement :). &lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, j&amp;rsquo;esp√®re qu&amp;rsquo;il vous a plu üòÑ.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Thu, 13 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-13:/ntp.html</guid><category>misc</category></item><item><title>Comprendre le protocole UDP</title><link>https://ilearned.eu.org/udp.html</link><description>&lt;p&gt;Nous avions r√©cemment vu le fonctionnement de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, ce protocole essaye d&amp;rsquo;avoir la meilleur fiabilit√© possible pour la transmission, mais un certain nombre d&amp;rsquo;√©changes sont requis pour v√©rifier l‚Äôint√©grit√© du flux ce qui rajoute de la latence qui dans certains cas, est probl√©matique. UDP est un protocole qui tente de r√©soudre ce probl√®me.&lt;/p&gt;
&lt;p&gt;UDP est l&amp;rsquo;acronyme de User Datagram Protocol (traduit par protocole de datagramme utilisateur), ce protocole se base sur IP et fait partie de la couche transport du &lt;a href="https://fr.wikipedia.org/wiki/Mod%C3%A8le_OSI"&gt;mod√®le OSI&lt;/a&gt;. Contrairement √† TCP il ne fait pas de &amp;ldquo;poign√©e de main&amp;rdquo; (ou handshake en anglais) et ne n√©cessite pas d&amp;rsquo;accus√© de r√©ception (ACK), cette mani√®re de fonctionner le rend plus tol√©rant √† un r√©seau d√©fectueux et lui permet un latence plus faible. Il n&amp;rsquo;est utile que dans des cas o√π une perte de paquet ne pose pas un soucis important. UDP est utilis√© dans certains protocole tr√®s utilis√© comme NTP, DNS, ou plus g√©n√©ralement les applications qui ont besoins de temps r√©el comme les jeux vid√©o ou certains services de streaming.&lt;/p&gt;
&lt;p&gt;Comme je l&amp;rsquo;ai dis plus haut UDP ne v√©rifie pas la bonne r√©ception d&amp;rsquo;un paquet (contrairement √† TCP avec son syst√®me d&amp;rsquo;ACK), la machine envoie donc le paquet sans forc√©ment attendre un retour. Ce protocole est bien plus simple que TCP dans sa conception. Un paquet UDP se compose tel que d√©crit sur ce sch√©ma :&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma d'une trame UDP" src="/static/img/udp/schema_trame.png"&gt;&lt;/p&gt;
&lt;p&gt;Comme on peut le voir, il y a un minimum d&amp;rsquo;information compar√© √† TCP, le port source qui permet si besoin de r√©pondre, le port de destination, la longueur totale du segment UDP (donn√©es comprises), une somme de contr√¥le (hash) et les donn√©es en elle m√™me, chaque entr√©e de l&amp;rsquo;en-t√™te fait 16 bits ce qui au total fait 64 bits pour la partie header contre 192 avec TCP ! La partie donn√©es a une longueur variable.&lt;/p&gt;
&lt;p&gt;Comme √† notre habitude, regardons une capture r√©seau :
&lt;img alt="Capture d'une requ√™te DNS" src="/static/img/dns_capture.png"&gt;
On remarque directement la simplicit√©, 2 requ√™tes seulement pour un aller retour, chaque paquet est aussi assez l√©ger, moins de 100 octets √† chaque fois, pour ce qui est des nombres &amp;ldquo;0.000000&amp;rdquo; et 0.000093&amp;rdquo; il s&amp;rsquo;agit du temps o√π ont √©t√© captur√©s chaque paquet. Si vous voulez regarder plus en profondeur la capture r√©seau, je vous laisse le fichier disponible &lt;a href="/static/misc/dns.pcap"&gt;ici&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour cet article sur UDP, j&amp;rsquo;esp√®re que vous l&amp;rsquo;aurez appr√©ci√©. On se retrouve demain pour parler de &lt;strong&gt;NTP&lt;/strong&gt; :).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Wed, 12 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-12:/udp.html</guid><category>Today I Learned</category></item><item><title>D√©centraliser, une priorit√©</title><link>https://ilearned.eu.org/decentralisation.html</link><description>&lt;p&gt;Internet est un grand r√©seau de r√©seau tous interconnect√©s de mani√®re diff√©rentes, la conception permet en th√©orie une redondance importante, mais dans les faits ce n&amp;rsquo;est pas forc√©ment le cas. En effet, beaucoup de services sont concentrer sur un nombre retreint d&amp;rsquo;acteur&lt;/p&gt;
&lt;p&gt;La concentration de ressource chez un nombre restreint d&amp;rsquo;acteurs pose un soucis, si un acteur tombe au plus il est utilis√© au plus le nombre de personnes impact√©es sera important, c&amp;rsquo;est ce pour quoi ne pas passer par les g√©ants d&amp;rsquo;un secteur est un choix non n√©gligeable, cela permet une meilleur redondance d&amp;rsquo;internet.&lt;/p&gt;
&lt;p&gt;Une autre probl√©matique d&amp;rsquo;utiliser des gros acteurs est leur possibilit√© √† imposer des conditions pas forc√©ment √©thique, par exemple Cloudflare, qui promet une protection contre les d√©nis de services, mais au vu du coups d&amp;rsquo;une infrastructure contre les attaques par d√©ni de service leur service gratuit n&amp;rsquo;est en r√©alit√© qu&amp;rsquo;un bon coup de pub pour leur offres payantes, qui est devant un grand nombre de sites, dans un premier temps si ils tombent internet le ressent de mani√®re exag√©r√©e, en plus d&amp;rsquo;emp√™cher une navigation agr√©able au utilisateur du r√©seau Tor. Qui je le rappelle, ne sert pas forc√©ment qu&amp;rsquo;aux cybercriminels comme aime le faire croire certains article :), ce r√©seau sert aussi √† contourner des blocage en vigueur dans certains pays, ou √† √©viter l&amp;rsquo;espionnage. Il n&amp;rsquo;y a bien sur pas que Cloudflare qui pose soucis, je les cites parce que je vois une recrudescence de son utilisation, qui, qui plus est n&amp;rsquo;est pas forc√©ment justifi√© ou utile je vous invite √† lire &lt;a href="https://codeberg.org/crimeflare/cloudflare-tor.git"&gt;https://codeberg.org/crimeflare/cloudflare-tor.git&lt;/a&gt;. Bien sur ce ne sont pas les seuls, tous les grands acteurs comme Amazon avec AWS, Google avec GCP ou encore, bien que peu pr√©sent dans nos contr√©es, Alibaba Cloud.&lt;/p&gt;
&lt;p&gt;Il n&amp;rsquo;y a bien sur pas que l&amp;rsquo;h√©bergeur qui est important, mais les diff√©rents services qu&amp;rsquo;en temps qu&amp;rsquo;utilisateurs finaux nous sommes amen√©s √† utiliser. Souvent ces outils sont tr√®s pratiques, mais que faire si celui ci n&amp;rsquo;est pas en ligne, l&amp;rsquo;entreprise disparait ou tout simplement supprime vos donn√©es ? Ce ne sont pas des cas invent√©s, pour ce qui est de l&amp;rsquo;indisponibilit√© on peut simplement observer les g√©ants, Google avait une panne presque total √† cause d&amp;rsquo;un quota (https://status.cloud.google.com/incident/zall/20013) de disque rempli. Pour ce qui est de la disparition de g√©ant on peut regarde Yahoo, qui fut un temps √©tait leader et n&amp;rsquo;est plus qu&amp;rsquo;un souvenir de nos jours. La suppression de contenu est un cas plus &amp;ldquo;compliqu√©&amp;rdquo; √† aborder, souvent les conditions d&amp;rsquo;utilisations que vous acceptez en utilisant un service stipulent un grand nombre de raisons qui permettent sans trop de difficult√©s d‚Äô√©vincer un compte on peut prendre l&amp;rsquo;exemple de YouTube, bien connu pour ce genre de pratique, qui va jusqu&amp;rsquo;√† fermer certaines chaines qui parlent de s√©curit√© informatique, il y a aussi Github qui a supprim√© youtube-dl de sa plateforme sur une demande ill√©gitime, youtube-dl est de nouveau pr√©sent sur Github mais sans une communaut√© solide il est compliqu√© de contrer une telle suppression.&lt;/p&gt;
&lt;p&gt;Tout centraliser au m√™me endroit pose aussi un soucis de vie priv√©e, si par exemple vous avez vos mails, vos fichiers, votre agenda chez un seul acteur celui peut revendre ou utiliser ces donn√©es √† des fin plus ou moins douteuses, et m√™me si l&amp;rsquo;acteur est honn√™te, un pirate qui r√©ussirait √† s&amp;rsquo;introduire dans le syst√®me y trouverait une mine d&amp;rsquo;or pour usurper une identit√©, revendre √† des agences de publicit√©s etc.&lt;/p&gt;
&lt;p&gt;Apr√®s avoir parl√© des probl√©matique, il est int√©ressant de regarder les solutions. Pour ce qui est des r√©seaux sociaux il existe des alternatives comme Mastodon en √©quivalent √† Twitter ou Facebook, pour Instagram je vous conseille Pixelfed et pour Youtube il y a PeerTube, ces solutions peuvent poser un probl√®me, leur manque d&amp;rsquo;utilisateur mais ce n&amp;rsquo;est pas pour autant que aucun contenu de qualit√© y est pr√©sent, bien au contraire il y a beaucoup de contenu tr√®s qualitatif.&lt;/p&gt;
&lt;p&gt;Un soucis de ce genre de solution c&amp;rsquo;est l&amp;rsquo;h√©bergement, tout le monde n&amp;rsquo;a pas forc√©ment l&amp;rsquo;envie de g√©rer soit m√™me une instance, ou bien m√™me la comp√©tence. Pour palier √† √ßa il y a un collectif : &lt;a href="https://chatons.org"&gt;https://chatons.org&lt;/a&gt; qui liste un nombre d&amp;rsquo;association.&lt;/p&gt;
&lt;p&gt;Pour ce qui est du choix d&amp;rsquo;un h√©bergeur autre que les g√©ants on peut regarder dans un premier temps les entreprises plus locales, par exemple ce blog est h√©berg√© chez &lt;a href="https://www.tetaneutral.net/"&gt;https://www.tetaneutral.net/&lt;/a&gt; une petite association fran√ßaise, en h√©bergeurs plus &amp;ldquo;business&amp;rdquo; il y a en France de tr√®s bonnes entreprises, comme Scaleway ou OVH.&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;esp√®re que cette article plus politique est moins technique vous aura plus :).
Nous aimerions remercier toutes les personnes suivant r√©guli√®rement ce blog, les statistiques sont incroyables, au d√©but nous pensions juste avoir quelques visiteurs mais c&amp;rsquo;est tout le contraire qui s&amp;rsquo;est produit, encore hier nous avons plus de 300 personnes qui sont pass√©es sur le blog et certains articles comme celui sur TCP a re√ßu plus de 1300 vues ! Les commentaires que vous laissez pour des corrections, ou des remerciements nous motivent aussi beaucoup, alors un grand merci üòä.&lt;/p&gt;
&lt;p&gt;Nous avons un dernier messages, poster tous les jours deviens de plus en plus compliqu√© surtout avec la reprise des cours en pr√©sentiel et la p√©riode d&amp;rsquo;examens qui approche, c&amp;rsquo;est pour cela que l&amp;rsquo;on passe maintenant √† un post deux jours sur trois, au lieu de chaque jours. Ce qui fait que ce n&amp;rsquo;est pas demain qu&amp;rsquo;on se retrouve, mais mercredi pour parler de &lt;strong&gt;UDP&lt;/strong&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Mon, 10 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-10:/decentralisation.html</guid><category>misc</category></item><item><title>Comment fonctionne le tracking par ETag</title><link>https://ilearned.eu.org/etag.html</link><description>&lt;p&gt;De plus en plus de navigateurs mettent en place des mesures pour bloquer le tracking, Firefox par exemple, &lt;a href="https://blog.mozilla.org/blog/2019/09/03/todays-firefox-blocks-third-party-tracking-cookies-and-cryptomining-by-default/"&gt;bloque&lt;/a&gt; par d√©faut les cookies third party. Pour contourner ces mesures de protection des utilisateurs, les entreprises de tracking sont √† la recherche d&amp;rsquo;autres moyens de pister les utilisateurs, ETag est l&amp;rsquo;un d&amp;rsquo;eux. Nous en avons bri√®vement parl√© dans l&amp;rsquo;article sur &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt;, l&amp;rsquo;en-t√™te ETag est dans le cas du serveur web &lt;a href="https://www.nginx.com/"&gt;Nginx&lt;/a&gt; que nous prendrons comme exemple ici, un condensat de la date de modification et de la longueur (lenght) du fichier demand√©. Ce hash a √©t√© cr√©√© pour permettre au navigateur de savoir s&amp;rsquo;il y a eu des changements sur un fichier et s&amp;rsquo;il doit montrer la version du fichier conserv√©e en cache √† l&amp;rsquo;utilisateur ou t√©l√©charger √† nouveau le fichier depuis le serveur.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma d√©crivant le fonctionnement de base des ETags" src="/static/img/etag/etag_fonctionnement_base.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma d√©crivant le fonctionnement des ETags, lorsque ceux du client et du serveur ne correspondent pas" src="/static/img/etag/etag_not_same.png"&gt;&lt;/p&gt;
&lt;p&gt;Ce syst√®me d&amp;rsquo;ETag peut cependant √™tre d√©tourn√©, afin de v√©rifier si les ETag correspondent, le client envoie l&amp;rsquo;ETag de la version qu&amp;rsquo;il a du fichier au serveur, le serveur peut donc, pour chaque utilisateur, servir un fichier diff√©rent (qui aura donc un ETag diff√©rent) et gr√¢ce √† cet ETag savoir quel utilisateur a consult√© quelle page √† quelle moment. Des entreprises comme &lt;a href="https://www.extremetech.com/internet/91966-aol-spotify-gigaom-etsy-kissmetrics-sued-over-undeletable-tracking-cookies"&gt;Hulu ou Spotify&lt;/a&gt; ont √©t√© √©pingl√©es pour avoir mis en place cette pratique, qui ne respecte √©videmment pas le RGPD. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma d√©crivant le fonctionnement du tracking via ETag" src="/static/img/etag/etag_based_tracking.png"&gt;&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, en esp√©rant qu&amp;rsquo;il a √©t√© clair :) On se retrouve demain pour parler de d√©centralisation !&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sun, 09 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-09:/etag.html</guid><category>misc</category></item><item><title>Le fonctionnement d'HTTP</title><link>https://ilearned.eu.org/http.html</link><description>&lt;p&gt;Le web est l&amp;rsquo;usage le plus connu d&amp;rsquo;internet, un protocole assez vieux (mais pas aussi vieux qu&amp;rsquo;internet) se cache derri√®re ce succ√®s : HTTP.&lt;/p&gt;
&lt;p&gt;HTTP est l&amp;rsquo;acronyme d&amp;rsquo;Hyper Text Transfer Protocol (protocole de transfert hypertexte si l&amp;rsquo;on traduit en fran√ßais), il a √©t√© invent√© pour palier √† certains manques de FTP qui √† l&amp;rsquo;√©poque √©tait majoritaire, un des points principaux est la notion de format de donn√©es, c&amp;rsquo;est √† dire indiquer au client quel est le type de donn√©e, cela permet au client de pouvoir interpr√©ter et afficher sans demander √† l&amp;rsquo;utilisateur ce qu&amp;rsquo;il doit faire de chaque fichier. Cette notion de &amp;ldquo;format de donn√©es&amp;rdquo; s&amp;rsquo;appelle le MIME.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma sur le MIME" src="/static/img/mime.png"&gt;&lt;/p&gt;
&lt;p&gt;HTTP a connu plusieurs versions, l&amp;rsquo;initiale √©tant la 0.9 (not√©e HTTP/0.9) qui n&amp;rsquo;a jamais √©t√© standardis√©e dans une RFC, une RFC (pour request for comment, soit demande de commentaires en fran√ßais) est un document technique identifi√© par un num√©ro d√©finissant des proc√©dures ou protocoles, ces documents sont accessibles sur &lt;a href="https://www.rfc-editor.org/rfc/"&gt;https://www.rfc-editor.org/rfc/&lt;/a&gt; (ou gemini://gemini.bortzmeyer.org/rfc-mirror/rfc-index.gmi via &lt;a href="https://blog.eban.bzh/today-i-learned/gemini.html"&gt;Gemini&lt;/a&gt;), l&amp;rsquo;usage de cette version d&amp;rsquo;HTTP est assez marginal de nos jours. Quelques ann√©es plus tard est sorti au travers d&amp;rsquo;une RFC (la &lt;a href="https://www.rfc-editor.org/rfc/rfc1945.html"&gt;1945&lt;/a&gt;) HTTP/1.0 cette RFC s&amp;rsquo;occupe surtout de pr√©ciser comment HTTP fonctionne, il n&amp;rsquo;apporte pas d&amp;rsquo;√©volution avec la version 0.9. Assez rapidement HTTP/1.1 sort, cette version apporte certaines optimisations, comme l&amp;rsquo;envoi de plusieurs requ√™tes en simultan√©.&lt;/p&gt;
&lt;p&gt;Le fonctionnement d&amp;rsquo;HTTP se base sur le &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;protocole TCP&lt;/a&gt;, par d√©faut le port utilis√© est le 80. Pour demander ou envoyer des contenus on utilise des &amp;ldquo;m√©thodes&amp;rdquo;, une m√©thode est une commande envoy√©e au serveur. On peut en citer plusieurs :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GET : Demande une ressource&lt;/li&gt;
&lt;li&gt;HEAD : Demande uniquement les informations&lt;/li&gt;
&lt;li&gt;POST : Envoie des donn√©es&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La liste n&amp;rsquo;est pas compl√®te, je vous laisse rechercher par vous m√™me pour plus d&amp;rsquo;informations √† ce propos ;).&lt;/p&gt;
&lt;p&gt;On peut regarder plus en profondeur HTTP en regardant les transmissions r√©seaux :
&lt;img alt="Sch√©ma capture r√©seau HTTP" src="/static/img/capture_http.png"&gt;
La partie data, celle qui contient la page en elle m√™me n&amp;rsquo;est pas directement visible ici, je vous laisse regarder le dump r√©seau sur wireshark, il est disponible &lt;a href="/static/misc/http.pcap"&gt;ici&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Un autre aspect int√©ressant d&amp;rsquo;HTTP sont les en-t√™tes (headers) qui donnent des informations au client √† propos du serveur, et inversement. C√¥t√© client par exemple, on a l&amp;rsquo;en-t√™te &amp;ldquo;Host&amp;rdquo; qui donne le nom de domaine demand√© par le client, cela permet de distribuer un contenu diff√©rent en fonction de celui-ci. Le serveur peut lui donner le type de contenu via &amp;ldquo;Content-Type&amp;rdquo;. Il y a beaucoup d&amp;rsquo;autres en-t√™tes possibles, si vous voulez regarder celle d&amp;rsquo;une URL la commande &lt;code&gt;curl&lt;/code&gt; le permet via l&amp;rsquo;option &lt;code&gt;-I&lt;/code&gt;, pour &lt;a href="https://ramle.be"&gt;https://ramle.be&lt;/a&gt; par exemple :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;% curl -I https://ramle.be
HTTP/2 &lt;span class="m"&gt;200&lt;/span&gt; 
server: nginx
date: Sat, &lt;span class="m"&gt;08&lt;/span&gt; May &lt;span class="m"&gt;2021&lt;/span&gt; &lt;span class="m"&gt;14&lt;/span&gt;:40:55 GMT
content-type: text/html&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nv"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;utf-8
content-length: &lt;span class="m"&gt;1992&lt;/span&gt;
last-modified: Fri, &lt;span class="m"&gt;23&lt;/span&gt; Apr &lt;span class="m"&gt;2021&lt;/span&gt; &lt;span class="m"&gt;18&lt;/span&gt;:18:34 GMT
vary: Accept-Encoding
etag: &lt;span class="s2"&gt;&amp;quot;60830f7a-7c8&amp;quot;&lt;/span&gt;
content-security-policy: default-src &lt;span class="s1"&gt;&amp;#39;none&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; style-src cdn.ramle.be&lt;span class="p"&gt;;&lt;/span&gt; img-src cdn.ramle.be
x-frame-options: SAMEORIGIN
x-xss-protection: &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nv"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;block
x-content-type-options: nosniff
referrer-policy: same-origin
x-permitted-cross-domain-policies: master-only
expect-ct: max-age&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;60&lt;/span&gt;, enforce
permissions-policy: &lt;span class="nv"&gt;accelerometer&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;camera&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;geolocation&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;gyroscope&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;magnetometer&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;microphone&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;payment&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;
strict-transport-security: max-age&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;31536000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; includeSubDomains&lt;span class="p"&gt;;&lt;/span&gt; preload
accept-ranges: bytes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On remarque sur la premi√®re ligne la version d&amp;rsquo;HTTP, ici c&amp;rsquo;est la version 2. On voit ensuite la liste des en-t√™tes :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;content-type&lt;/strong&gt; indique le type de contenu (le &lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types"&gt;MIME&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;etag&lt;/strong&gt; indique une suite de caract√®res ASCII, cette cha√Æne change si le contenu distant change, cela permet de mettre en cache les ressources. Il n&amp;rsquo;y a pas de m√©thode d√©finie pour la g√©n√©ration de cette cha√Æne de caract√®res.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Je n&amp;rsquo;ai d√©crit ici que les en-t√™tes qui me semblait importants pour cet article, beaucoup d&amp;rsquo;autres en-t√™tes restent tr√®s utiles mais moins utilis√©s, souvent orient√©s s√©curit√©, certains feront surement l&amp;rsquo;objet d&amp;rsquo;un article prochainement ;). Si vous voulez des informations plus pr√©cises sur celle-ci je vous laisse aller voir la documentation de MDN qui est assez compl√®te.&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;ai cit√© plus haut la version 2 d&amp;rsquo;HTTP (not√©e HTTP/2) sans expliquer les changements apport√©s par cette version, nous allons donc dans ce paragraphe voir les diff√©rences avec HTTP/1.1, pour commencer l&amp;rsquo;impl√©mentation faite par beaucoup de navigateurs impose le chiffrement via HTTPS (on reparlera plus bas d&amp;rsquo;HTTPS), un autre changement est dans le transport lui m√™me, HTTP/1.1 se base sur du texte, l√† ou HTTP/2 utilise du binaire, √ßa le rends plus compact et facile √† parser, mais non lisible par un humain sans outil sp√©cifique. Il y a aussi un changement dans la connexion TCP elle m√™me, au lieu de faire une connexion &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; par ressource, on utilise une seule connexion pour toutes les ressources le gain latence est assez important au vu du nombre d&amp;rsquo;aller-retour &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma HTTP/2 vs HTTP/1.1" src="/static/img/http2.png"&gt;&lt;/p&gt;
&lt;p&gt;Vous avez probablement remarqu√© qu&amp;rsquo;HTTP ne pr√©sente presque aucun m√©canisme de s√©curit√© de base, il n&amp;rsquo;est en effet pas possible de v√©rifier l&amp;rsquo;authenticit√© des ressources ni d&amp;rsquo;emp√™cher un attaquant d&amp;rsquo;espionner la connexion, pour r√©soudre ce probl√®me HTTPS est n√©, il s&amp;rsquo;agit simplement de faire passer HTTP via TLS, pour ce qui est de la v√©rification on se base sur les autorit√©s de certification, contrairement √† d&amp;rsquo;autres protocoles comme &lt;a href="https://blog.eban.bzh/today-i-learned/gemini.html"&gt;Gemini&lt;/a&gt;, je vous invite √† aller voir l&amp;rsquo;article sur &lt;a href="https://blog.eban.bzh/today-i-learned/dane.html"&gt;DANE&lt;/a&gt; pour plus de d√©tails √† propos des autorit√©s de certification. &lt;/p&gt;
&lt;p&gt;HTTP permet de r√©duire la taille des donn√©es envoy√©es en les compressant, les deux algorithmes utilis√©s pour compresser les donn√©es sont gzip et brotli, le client peut dire au serveur lequel de ces algorithmes il supporte via l&amp;rsquo;en-t√™te &amp;ldquo;&lt;strong&gt;Accept-encoding&lt;/strong&gt;&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour l&amp;rsquo;article d&amp;rsquo;aujourd&amp;rsquo;hui, j&amp;rsquo;esp√®re qu&amp;rsquo;il vous aura plus :), On se retrouve demain pour parler de &lt;strong&gt;radvd&lt;/strong&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sat, 08 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-08:/http.html</guid><category>misc</category></item><item><title>IPv6, il est grand temps de migrer</title><link>https://ilearned.eu.org/ipv6.html</link><description>&lt;p&gt;D√©cembre 1998, c‚Äôest la date de parution de la &lt;a href="https://tools.ietf.org/html/rfc2460"&gt;RFC 2460&lt;/a&gt; introduisant IPv6, aujourd‚Äôhui, seulement 26% des sites les plus visit√©s en France sont accessibles en IPv6 &lt;a href="https://www.arcep.fr/cartes-et-donnees/nos-publications-chiffrees/transition-ipv6/barometre-annuel-de-la-transition-vers-ipv6-en-france.html"&gt;d‚Äôapr√®s l‚ÄôArcep&lt;/a&gt;. Faisons donc un petit tour d‚Äôhorizon de l‚Äôadoption d‚ÄôIPv6.&lt;/p&gt;
&lt;p&gt;IPv6 a √©t√© cr√©√© pour r√©pondre √† une probl√©matique simple, le manque croissant d‚ÄôIPv4.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Taux d'adoption de l'IPv6 en France" src="/static/img/adoption_ipv6.png"&gt;&lt;/p&gt;
&lt;p&gt;En effet, avec IPv4 la quantit√© d‚ÄôIPs total est th√©oriquement de &lt;code&gt;4 294 967 296&lt;/code&gt;, th√©oriquement car certains blocs d‚ÄôIPs sont r√©serv√©s √† des usages priv√©s comme par exemple 10.0.0.0/8. Le nombre de 4 milliards d‚ÄôIPs peut sembler √©norme, mais cela ne repr√©sente qu&amp;rsquo;une IP pour deux personnes sur terre, de plus beaucoups d&amp;rsquo;IPs sont allou√©es (plus d&amp;rsquo;informations sur l&amp;rsquo;allocation des IPs &lt;a href="https://blog.eban.bzh/today-i-learned/allocation-ips.html"&gt;ici&lt;/a&gt; üòâ) mais pas utilis√©es, comme par exemple Apple qui monopolise un /8 soit 16 777 216 IPs qui n‚Äôest presque pas utilis√© ! Avec IPv6 le nombre total d‚ÄôIPs th√©oriquement disponible est de &lt;code&gt;340 282 366 920 938 463 463 374 607 431 768 211 456&lt;/code&gt;, IPv6 permet donc largement de pallier √† ce probl√®me de p√©nurie d‚ÄôIPv4. Une adresse IPv6 typique ressemble √† √ßa &lt;code&gt;2a03:7220:8083:3c00::1&lt;/code&gt; elle est cod√©e sur 128 bits. Vous vous demandez s√ªrement ce √† quoi correspondent les &lt;code&gt;::&lt;/code&gt; vers la fin de l‚Äôadresse, ils correspondent simplement √† un remplissage avec des 0 afin d&amp;rsquo;atteindre le nombre de 128 bits. Par exemple : &lt;code&gt;2a03:7220:8083:3c00::1&lt;/code&gt; correspond en r√©alit√© √† &lt;code&gt;2a03:7220:8083:3c00:0000:0000:0000:0001&lt;/code&gt;.  &lt;/p&gt;
&lt;p&gt;Les op√©rateurs ont d√©velopp√© plusieurs techniques pour contrer √† ce manque croissant d&amp;rsquo;IPv4, comme par exemple le CG-NAT, pour ceux qui ne le sauraient pas, le NAT c&amp;rsquo;est basiquement le fait de partager une seule IP publique entre plusieurs appareils (nous aborderons le NAT plus en d√©tail plus tard ;)) le CG-NAT c&amp;rsquo;est donc du NAT mais √† l&amp;rsquo;√©chelle d&amp;rsquo;une rue, d&amp;rsquo;un quartier. Le probl√®me principal du NAT c&amp;rsquo;est qu&amp;rsquo;il emp√™che de nombreuses applications et protocoles de fonctionner, comme par exemple le Torrent ou m√™me Google Maps ! Il emp√™che aussi d&amp;rsquo;h√©berger des services chez soi car seule une plage de ports est allou√©e au client, il faut donc avoir la chance de tomber sur la plage contenant les ports 80 et 443 pour pouvoir auto-h√©berger un site web par exemple.&lt;/p&gt;
&lt;p&gt;La solution √† ces maux est donc IPv6, mais comme nous l&amp;rsquo;avons vu en introduction son d√©ploiement prend du temps, beaucoup de temps, dans son rapport annuel l&amp;rsquo;Arcep pointait du doigt la lenteur du d√©ploiement d&amp;rsquo;IPv6, surtout chez certains op√©rateurs, mais aussi chez de nombreux h√©bergeurs qui ne fournissent pas d&amp;rsquo;IPv6 par d√©faut √† leurs clients !&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/ipv6/Untitled.png" src="/static/img/ipv6/Untitled.png"&gt;&lt;/p&gt;
&lt;p&gt;Un des raisons de la lenteur du d√©ploiement d&amp;rsquo;IPv6 est le fait qu&amp;rsquo;utilisateurs et h√©bergeurs se renvoient syst√©matiquement la balle, les uns se demandant √† quoi bon avoir de l&amp;rsquo;IPv6 si tous les sites qu&amp;rsquo;ils visitent sont disponibles en IPv4, les autres disant qu&amp;rsquo;il est inutile de d√©ployer IPv6 puisque les clients ne sont en majorit√© pas √©quip√©s. Cette attitude dilatoire a pour cons√©quence de ralentir le d√©ploiement d&amp;rsquo;IPv6 au d√©triment des petits h√©bergeurs associatifs qui n&amp;rsquo;ont pas forc√©ment les moyens d&amp;rsquo;acheter des ranges d&amp;rsquo;IPv4 souvent tr√®s couteuses. &lt;/p&gt;
&lt;p&gt;Il existe un autre frein, et pas des moindres, au d√©ploiement et l&amp;rsquo;utilisation massive d&amp;rsquo;IPv6, le r√©seau IPv6 est actuellement divis√© en deux, en effet, Cogent un tr√®s gros fournisseur de &lt;a href="https://en.wikipedia.org/wiki/Internet_transit"&gt;transit&lt;/a&gt; refuse de peer (d&amp;rsquo;√©changer ses routes) avec Hurrican Electric, un autre mastodonte du secteur. Ainsi, depuis le r√©seau IPv6 de Cogent il est impossible d&amp;rsquo;acc√©der √† &lt;a href="http://he.net"&gt;he.net&lt;/a&gt; (le site de Hurrican Electric) en IPv6. Ce bloquage dure depuis 2009, et malgr√© les nombreuses demandes de Hurrican Electric, ces deux entreprises ne parviennent pas √† un accord financier.&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/ipv6/Untitled%201.png" src="/static/img/ipv6/Untitled%201.png"&gt;&lt;/p&gt;
&lt;p&gt;Nous finirons donc cet article sur ce joli g√¢teau, merci beaucoup de l&amp;rsquo;avoir lu, si vous souhaitez savoir si vous avez de l&amp;rsquo;IPv6 je vous invite √† faire le test sur &lt;a href="https://test-ipv6.com/"&gt;test-ipv6.com&lt;/a&gt;. Si vous n&amp;rsquo;en avez pas renseignez-vous, il existe probablement une d√©marche pour obtenir de l&amp;rsquo;IPv6 de la part de votre op√©rateur üòâ, sauf si vous √™tes chez orange, pas du bol :&amp;rsquo;(, il existe cependant des personnes qui offrent des tunnels IPv6 comme &lt;a href="https://enpls.org/"&gt;EnPLS&lt;/a&gt; par exemple.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 07 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-07:/ipv6.html</guid><category>misc</category></item><item><title>Gemini, une alternative viable √† HTTP ?</title><link>https://ilearned.eu.org/gemini.html</link><description>&lt;p&gt;Hey üëã, aujourd&amp;rsquo;hui on parle du protocole Gemini, Gemini est un protocole alternatif √† HTTP ou Gopher pour ne citer qu&amp;rsquo;eux, cr√©√© en Juin 2019 avec pour objectif d&amp;rsquo;√™tre beaucoup plus l√©ger qu&amp;rsquo;HTTP, et de mieux respecter la vie priv√©e des utilisateurs, en effet, avec Gemini, pas de JS, de cookies ou de eTag, le tracking des utilisateurs est quasi impossible. Gemini n&amp;rsquo;a pas √©t√© cr√©√© pour concurrencer HTTP mais bien pour offrir une alternative plus l√©g√®re et s√©curis√©e aux utilisateurs. Ce protocole embarque d&amp;rsquo;office le protocole TLS, il n&amp;rsquo;y a donc contrairement √† HTTP pas la possibilit√© d&amp;rsquo;avoir des communications en clair. Ce protocole est bas√© en partie sur HTTP 0.9 et essentiellement textuel, mais des images peuvent aussi √™tre int√©gr√©. &lt;/p&gt;
&lt;p&gt;Une requ√™te Gemini est tr√®s simple, le client demande un fichier sur le serveur cible, le serveur r√©pond avec un code d&amp;rsquo;erreur (ici, 20 = OK), le type de fichier, le plus souvent &lt;code&gt;text/gemini&lt;/code&gt; et pour finir envoie le fichier. C&amp;rsquo;est plus simple que TCP avant-hier n&amp;rsquo;est-ce pas ? üòÖ Voici donc une requ√™te standard sur Gemini. C repr√©sente le client et S le serveur.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;gemini&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;gemini&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;circumlunar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;space&lt;/span&gt;&lt;span class="sr"&gt;/docs/&lt;/span&gt;&lt;span class="n"&gt;faq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;gmi&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;gemini&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;Hey&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;website&lt;/span&gt; &lt;span class="n"&gt;running&lt;/span&gt; &lt;span class="n"&gt;under&lt;/span&gt; &lt;span class="n"&gt;Gemini&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;J&amp;rsquo;ai volontairement omis toute la partie correspondant √† TLS dans l&amp;rsquo;exemple de requ√™te ci-dessus car TLS fera l&amp;rsquo;objet d&amp;rsquo;un article plus complet dans peu de temps.&lt;/p&gt;
&lt;p&gt;Afin de se rendre ind√©pendant de CA externes qui, &lt;a href="https://blog.eban.bzh/today-i-learned/dane.html"&gt;comme on l&amp;rsquo;a vu&lt;/a&gt; sont un SPOF (single point of failure, point unique de d√©faillance) qui, si il se trouve compromit, pourrait d√©livrer des certificats frauduleux Gemini s&amp;rsquo;appuie sur le principe de TOFU, Trust on first use, c&amp;rsquo;est un m√©chanisme aussi utilis√© par SSH par exemple, pour faire confiance √† un certificat, le logiciel s&amp;rsquo;appuie simplement sur le certificat qu&amp;rsquo;il a crois√© pour la premi√®re fois sur ce site. Cette fa√ßon de fonctionner est d√©cri√©e par certains pr√©f√©rant un fonctionnement avec CA. Cependant, des m√©canismes comme &lt;a href="https://blog.eban.bzh/today-i-learned/dane.html"&gt;DANE&lt;/a&gt; coupl√© √† &lt;a href="https://blog.eban.bzh/today-i-learned/dnssec.html"&gt;DNSSEC&lt;/a&gt; existent et permettent de rendre relativement s√©curis√© Gemini.&lt;/p&gt;
&lt;p&gt;√Ä l&amp;rsquo;occasion de ce post, j&amp;rsquo;ai rendu mon blog accessible sur Gemini, je vous invite √† faire un tour dessus √† l&amp;rsquo;adresse &lt;code&gt;gemini://eban.bzh&lt;/code&gt; vous trouverez &lt;a href="https://gemini.circumlunar.space/clients.html"&gt;ici&lt;/a&gt; une liste de clients Gemini.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Thu, 06 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-06:/gemini.html</guid><category>misc</category></item><item><title>Le protocole IRC</title><link>https://ilearned.eu.org/irc.html</link><description>&lt;p&gt;Hier nous avions vu le protocole TCP, aujourd&amp;rsquo;hui nous allons en reparler en l&amp;rsquo;appliquant concr√®tement. Le protocole que nous allons voir est IRC qui est tr√®s simple dans sa conception, ce qui permet de l&amp;rsquo;utiliser √† la main sans se prendre trop la t√™te.&lt;/p&gt;
&lt;p&gt;IRC est l&amp;rsquo;acronyme d&amp;rsquo;Internet Relay Chat (traduit litt√©ralement par relai de discussion internet), comme son nom l&amp;rsquo;indique, le serveur ne fait que relayer les messages, il ne les stocke pas contrairement √† de nombreux autres protocoles de chat.&lt;/p&gt;
&lt;p&gt;Comme sous entendu juste au dessus, IRC fonctionne dans un mode client serveur, le client est identifi√© par un &amp;ldquo;nick&amp;rdquo; (diminutif de nickname, pseudo), personne n&amp;rsquo;aura donc le m√™me nick sur un serveur IRC. Le nick est le seule moyens d&amp;rsquo;identification d&amp;rsquo;un client, pour √©viter de se le faire voler il faut laisser un client tourner en continu. Ce fonctionnement n&amp;rsquo;est pas forc√©ment pratique et facilite l&amp;rsquo;usurpation, pour palier √† √ßa beaucoup de serveur donnent la possibilit√© de s&amp;rsquo;authentifier √† l&amp;rsquo;aide d&amp;rsquo;un mot de passe soit via un bot √† qui on doit envoyer un message sp√©cifique contenant le secret, soit via un syst√®me appel√© SASL qui permet d&amp;rsquo;envoyer directement le mot de passe durant la phase de connexion au serveur. Pour ce qui est de l&amp;rsquo;usage principal de IRC, c&amp;rsquo;est √† dire les messages, on fonctionne via des canaux, un peu comme discord, identifi√©s par une chaine de texte commen√ßant par &amp;ldquo;#&amp;rdquo;, chaque canal peut poss√©der une description (cela reste facultatif).&lt;/p&gt;
&lt;p&gt;Pour essayer IRC on peut utiliser telnet qui est un outil qui permet d&amp;rsquo;√©tablir des connexions TCP, on peut se connecter via la suite de commande :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;telnet irc.example.org &lt;span class="m"&gt;6667&lt;/span&gt; 
USER utilisateur * * :Une description
NICK utilisateur &lt;span class="c1"&gt;#D√©finit le fameux nick&lt;/span&gt;
JOIN &lt;span class="se"&gt;\#&lt;/span&gt;canal &lt;span class="c1"&gt;#Pour joindre un canal&lt;/span&gt;
PRIVMSG &lt;span class="se"&gt;\#&lt;/span&gt;canal Un message &lt;span class="c1"&gt;#Envoi &amp;quot;Un message&amp;quot; dans #canal&lt;/span&gt;
&lt;span class="c1"&gt;# Le serveur r√©ponds par le &amp;quot;MOTD&amp;quot; (messaye of the day, ou message du jour en fran√ßais)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ce qui donnera la sortie :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;% telnet irc.lab.rameul.eu &lt;span class="m"&gt;6667&lt;/span&gt;
Trying &lt;span class="m"&gt;172&lt;/span&gt;.17.0.2...
Connected to irc.lab.rameul.eu.
Escape character is &lt;span class="s1"&gt;&amp;#39;^]&amp;#39;&lt;/span&gt;.
:irc.lab.rameul.eu NOTICE Auth :*** Looking up your hostname...
:irc.lab.rameul.eu NOTICE Auth :*** Could not resolve your hostname: Domain name not found&lt;span class="p"&gt;;&lt;/span&gt; using your IP address &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;172&lt;/span&gt;.17.0.1&lt;span class="o"&gt;)&lt;/span&gt; instead.
USER ramle * * :
NICK ramle
:irc.lab.rameul.eu NOTICE Auth :Welcome to rml-lab!
:irc.lab.rameul.eu &lt;span class="m"&gt;001&lt;/span&gt; ramle :Welcome to the rml-lab IRC Network ramle!ramle@172.17.0.1
:irc.lab.rameul.eu &lt;span class="m"&gt;002&lt;/span&gt; ramle :Your host is irc.lab.rameul.eu, running version InspIRCd-2.0
:irc.lab.rameul.eu &lt;span class="m"&gt;003&lt;/span&gt; ramle :This server was created on Debian
:irc.lab.rameul.eu &lt;span class="m"&gt;004&lt;/span&gt; ramle irc.lab.rameul.eu InspIRCd-2.0 iosw biklmnopstv bklov
:irc.lab.rameul.eu &lt;span class="m"&gt;005&lt;/span&gt; ramle &lt;span class="nv"&gt;AWAYLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt; &lt;span class="nv"&gt;CASEMAPPING&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;rfc1459 &lt;span class="nv"&gt;CHANMODES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;b,k,l,imnpst &lt;span class="nv"&gt;CHANNELLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="nv"&gt;CHANTYPES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="c1"&gt;# CHARSET=ascii ELIST=MU FNC KICKLEN=255 MAP MAXBANS=60 MAXCHANNELS=20 MAXPARA=32 :are supported by this server&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;005&lt;/span&gt; ramle &lt;span class="nv"&gt;MAXTARGETS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="nv"&gt;MODES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="nv"&gt;NETWORK&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;rml-lab &lt;span class="nv"&gt;NICKLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;32&lt;/span&gt; &lt;span class="nv"&gt;PREFIX&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;ov&lt;span class="o"&gt;)&lt;/span&gt;@+ &lt;span class="nv"&gt;STATUSMSG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;@+ &lt;span class="nv"&gt;TOPICLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;307&lt;/span&gt; VBANLIST WALLCHOPS WALLVOICES :are supported by this server
:irc.lab.rameul.eu &lt;span class="m"&gt;042&lt;/span&gt; ramle 476AAAAAK :your unique ID
:irc.lab.rameul.eu &lt;span class="m"&gt;375&lt;/span&gt; ramle :irc.lab.rameul.eu message of the day
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :-  _ __ _ __ ___ &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;      _ __   ___&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_ 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__| &amp;#39;&lt;/span&gt;_ &lt;span class="sb"&gt;`&lt;/span&gt; _ &lt;span class="se"&gt;\|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_____&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;_ &lt;span class="se"&gt;\ &lt;/span&gt;/ _ &lt;span class="se"&gt;\ &lt;/span&gt;__&lt;span class="p"&gt;|&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_____&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;  __/ &lt;span class="p"&gt;|&lt;/span&gt;_ 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="se"&gt;\_&lt;/span&gt;__&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="se"&gt;\_&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- Description : Lab
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- NetAdmin : ramle
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- 
:irc.lab.rameul.eu &lt;span class="m"&gt;376&lt;/span&gt; ramle :End of message of the day.
:irc.lab.rameul.eu &lt;span class="m"&gt;251&lt;/span&gt; ramle :There are &lt;span class="m"&gt;1&lt;/span&gt; users and &lt;span class="m"&gt;0&lt;/span&gt; invisible on &lt;span class="m"&gt;1&lt;/span&gt; servers
:irc.lab.rameul.eu &lt;span class="m"&gt;254&lt;/span&gt; ramle &lt;span class="m"&gt;0&lt;/span&gt; :channels formed
:irc.lab.rameul.eu &lt;span class="m"&gt;255&lt;/span&gt; ramle :I have &lt;span class="m"&gt;1&lt;/span&gt; clients and &lt;span class="m"&gt;0&lt;/span&gt; servers
:irc.lab.rameul.eu &lt;span class="m"&gt;265&lt;/span&gt; ramle :Current Local Users: &lt;span class="m"&gt;1&lt;/span&gt;  Max: &lt;span class="m"&gt;2&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;266&lt;/span&gt; ramle :Current Global Users: &lt;span class="m"&gt;1&lt;/span&gt;  Max: &lt;span class="m"&gt;2&lt;/span&gt;
JOIN &lt;span class="c1"&gt;#article&lt;/span&gt;
:ramle!ramle@172.17.0.1 JOIN :#article
:irc.lab.rameul.eu &lt;span class="m"&gt;353&lt;/span&gt; &lt;span class="nv"&gt;ramle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="c1"&gt;#article :ramle @ramle2 &lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;366&lt;/span&gt; ramle &lt;span class="c1"&gt;#article :End of /NAMES list.&lt;/span&gt;
PRIVMSG &lt;span class="c1"&gt;#article o/&lt;/span&gt;
:ramle2!ramle2@172.17.0.1 PRIVMSG &lt;span class="c1"&gt;#article :o/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;~~Pour ceux qui souhaiteraient tester par eux m√™me avec telnet, le serveur IRC ne sera up qu&amp;rsquo;√† partir de 21h30 ;).~~ Il est en ligne.&lt;/p&gt;
&lt;p&gt;On peut voir dans ce court exemple plusieurs choses, d√©j√† la simplicit√© du protocole, en seulement 3 commande on rejoint un canal. Un autre fait qui peut √™tre not√©, c&amp;rsquo;est la commande envoy√©e pour d√©finir le nom d&amp;rsquo;utilisateur :  &lt;code&gt;USER ramle * * :&lt;/code&gt;, il n&amp;rsquo;y a en effet pas de description, c&amp;rsquo;est une option facultative. Un autre point important est le symbole &amp;ldquo;@&amp;rdquo; devant l&amp;rsquo;utilisateur &amp;ldquo;ramle2&amp;rdquo;, ce caract√®re signifie qu&amp;rsquo;il est &amp;ldquo;op&amp;rdquo; c&amp;rsquo;est √† dire avec les permissions compl√®te sur le canal, il peut donc expulser un membre, le bannir ou modifier des param√®tres sur le canal, il ne peut par contre pas supprimer de messages vu que le serveur ne stocke rien, il ne sert que de relai entre les utilisateurs.&lt;/p&gt;
&lt;p&gt;&lt;img alt="IRC%2021507d67dcf84cbba48c88b9daad068c/Frame_30.png" src="/static/img/irc/Frame_30.png"&gt;&lt;/p&gt;
&lt;p&gt;Sur la capture r√©seau, on peut observer le peu de requ√™te pour chaque √©tape, l&amp;rsquo;envoi du contenu en lui m√™me et l&amp;rsquo;accus√©. Si vous voulez observer par vous m√™me, le fichier est ici &lt;/p&gt;
&lt;p&gt;&lt;a href="/static/misc/irc/irc.pcap"&gt;irc.pcap&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour IRC, j&amp;rsquo;esp√®re que √ßa vous aura plus. N&amp;rsquo;h√©sitez pas √† poster en commentaire si vous avec des remarques, des questions, on se retrouve demain pour Gemini :)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Wed, 05 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-05:/irc.html</guid><category>misc</category></item><item><title>Comprendre le protocole TCP</title><link>https://ilearned.eu.org/tcp.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui on s&amp;rsquo;attaque √† un gros morceau, le protocole &lt;code&gt;TCP&lt;/code&gt;, vous √™tes pr√™t¬∑e¬∑s ? C&amp;rsquo;est partit ! ;) TCP (= Transmission Control Protocol) est le protocole de &lt;a href="https://fr.wikipedia.org/wiki/Couche_transport"&gt;couche 4&lt;/a&gt; le plus utilis√© et il fait partie int√©grante de nos vies sans que nous ne nous en rendions compte. TCP a √©t√© cr√©√© afin de r√©pondre √† une probl√©matique simple, permettre la communication de fa√ßon fiable entre deux machines. TCP est bas√©, comme de nombreux protocoles, sur une architecture &lt;code&gt;client-serveur&lt;/code&gt;. Les donn√©es sont d√©coup√©es en blocs appel√©s segments.&lt;/p&gt;
&lt;p&gt;La communication s&amp;rsquo;effectue en trois parties : l&amp;rsquo;√©tablissement de la connexion, le transfert des donn√©es, la fin de la connexion. Commen√ßons donc par l&amp;rsquo;√©tablissement de la connexion, il est fait gr√¢ce √† un &lt;a href="https://fr.wikipedia.org/wiki/Three-way_handshake"&gt;handshake en trois √©tapes&lt;/a&gt; (Three-way handshake), la premi√®re √©tape est nomm√©e &lt;code&gt;SYN&lt;/code&gt; (synchronized), le client va donc envoyer un paquet &lt;code&gt;SYN&lt;/code&gt; au serveur avec lequel il souhaite entamer la communication, il g√©n√®re aussi al√©atoirement un num√©ro de s√©quence qui est transmit dans ce paquet. Le serveur r√©pond ensuite avec un paquet &lt;code&gt;SYN-ACK&lt;/code&gt; (synchronize, acknowledge), litt√©ralement &lt;em&gt;accus√© de r√©ception de la demande de synchronisation&lt;/em&gt;, le num√©ro de s√©quence du serveur est g√©n√©r√© al√©atoirement, le num√©ro d&amp;rsquo;acquittement correspond au num√©ro de s√©quence du client incr√©ment√© d&amp;rsquo;un. Pour finir, le client envoie un dernier paquet &lt;code&gt;ACK&lt;/code&gt; au serveur pour confirmer qu&amp;rsquo;il a bien re√ßu le paquet &lt;code&gt;SYN-ACK&lt;/code&gt;, le num√©ro de s√©quence de ce paquet est √©gal √† celui g√©n√©r√© par le client plus t√¥t + un, le num√©ro d&amp;rsquo;acquittement quant a lui est √©gal au num√©ro de s√©quence du serveur augment√© de 1.&lt;/p&gt;
&lt;p&gt;Ne vous en faites pas, nous allons voir plus pr√©cis√©ment √† quoi correspondent les num√©ros d&amp;rsquo;acquittement et de s√©quence ;).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_25.png" src="/static/img/tcp/Frame_25.png"&gt;&lt;/p&gt;
&lt;p&gt;Une fois cette initialisation faite, la communication peut commencer, regardons donc de plus pr√®s le contenu d&amp;rsquo;un paquet TCP, accrochez vous il y a pas mal de contenu üòÑ. Cette partie s&amp;rsquo;appuie en grand partie sur &lt;a href="https://fr.wikipedia.org/wiki/Transmission_Control_Protocol#D%C3%A9veloppement_de_TCP"&gt;l&amp;rsquo;article wikipedia de TCP&lt;/a&gt;. Nous ne d√©taillerons pas l&amp;rsquo;utilit√© de chacune de ces informations, seulement des plus importantes √† nos yeux.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_26.png" src="/static/img/tcp/Frame_26.png"&gt;&lt;/p&gt;
&lt;p&gt;Les num√©ros d&amp;rsquo;acquittement et de s√©quence sont deux valeurs al√©atoires que l&amp;rsquo;on incr√©mente avec le nombre de donn√©es re√ßues afin de v√©rifier que tout les paquets sont bien arriv√©es dans l&amp;rsquo;ordre. Les num√©ros d&amp;rsquo;acquittement et de s√©quence initiaux sont g√©n√©r√©s al√©atoirement durant la s√©quence d&amp;rsquo;initialisation de la connexion que nous avons vu plus t√¥t, le three way handshaking.&lt;/p&gt;
&lt;p&gt;Le partie &amp;ldquo;Somme de contr√¥le&amp;rdquo; est en fait un condensat des donn√©es transmises qui est calcul√© par le serveur et v√©rifi√© par le client afin de garantir l&amp;rsquo;int√©grit√© des paquets. Si les hash correspondent on consid√®re alors que le paquet a √©t√© transmit sans erreur. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_27.png" src="/static/img/tcp/Frame_27.png"&gt;&lt;/p&gt;
&lt;p&gt;Le flag &lt;code&gt;PSH&lt;/code&gt; (push) indique l&amp;rsquo;envoie de donn√©es.&lt;/p&gt;
&lt;p&gt;Le flag &lt;code&gt;URG&lt;/code&gt; indique la pr√©sence de donn√©es urgentes.&lt;/p&gt;
&lt;p&gt;Le flag &lt;code&gt;ECN/NS&lt;/code&gt; sert quant √† lui √† signaler la pr√©sence de congestion sur le r√©seau.&lt;/p&gt;
&lt;p&gt;Dans la partie &lt;code&gt;Options&lt;/code&gt; on pourrait par exemple citer la MSS (Maximum Segment Size) qui correspond √† la taille maximale de la partie data. &lt;/p&gt;
&lt;p&gt;Nous avons vu les parties les plus importantes d&amp;rsquo;un trame TCP, √©tudions maintenant comment fermer une session avec le protocole TCP.&lt;/p&gt;
&lt;p&gt;Pour fermer une session TCP, c&amp;rsquo;est relativement simple, le premier appareil envoie un paquet &lt;code&gt;FIN&lt;/code&gt; au second avec son num√©ro de s√©quence, afin de v√©rifier que tous les paquets ont √©t√© re√ßu avant de fermer la communication. Le serveur r√©pond alors avec un &lt;code&gt;ACK&lt;/code&gt; pour confirmer la r√©ception du message. Le m√™me √©change a ensuite lieu dans l&amp;rsquo;autre sens, le serveur envoie un paquet &lt;code&gt;FIN&lt;/code&gt; et le client r√©pond avec un &lt;code&gt;ACK&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_28.png" src="/static/img/tcp/Frame_28.png"&gt;&lt;/p&gt;
&lt;p&gt;Pfiou, √ßa fait beaucoup d&amp;rsquo;un coup üòÖ. Mettons maintenant tout √ßa en pratique, si vous √™tes arriv√© jusqu&amp;rsquo;ici, vous avez fait le plus dur, bravo üéâ.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_29(5).png" src="/static/img/tcp/Frame_29(5).png"&gt;&lt;/p&gt;
&lt;p&gt;Vous remarquerez surement la pr√©sence des mentions de &lt;code&gt;Win&lt;/code&gt;; &lt;code&gt;TSval&lt;/code&gt; et &lt;code&gt;TSecr&lt;/code&gt;, regardons √† quoi elles correspondent&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Win&lt;/code&gt; correspond √† la fen√™tre, pour faire simple, la taille maximale d&amp;rsquo;un paquet.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;TSval&lt;/code&gt; et &lt;code&gt;TSecr&lt;/code&gt; sont simplement des &lt;a href="https://fr.wikipedia.org/wiki/Horodatage"&gt;timestamps&lt;/a&gt;, &lt;code&gt;TSval&lt;/code&gt; correspond au moment de l&amp;rsquo;envoi du paquet et &lt;code&gt;TSecr&lt;/code&gt; au moment de la r√©ception, chacun des deux participants de la conversation peut soustraire ces deux valeurs pour d√©terminer le &lt;code&gt;Round Trip Time (RTT)&lt;/code&gt;, le temps que prend un paquet √† √™tre √©chang√©.&lt;/p&gt;
&lt;p&gt;Si vous souhaitez √† votre tour inspecter ce simple √©change tcp, le fichier est disponible &lt;a href="/static/misc/tcp/record.pcapng"&gt;ici&lt;/a&gt;, je vous recommande l&amp;rsquo;outil &lt;a href="https://www.wireshark.org/"&gt;Wireshark&lt;/a&gt; si vous voulez inspecter des paquets de ce type.&lt;/p&gt;
&lt;p&gt;Vous l&amp;rsquo;aurez surement remarqu√©, le protocole TCP a √©t√© con√ßu dans l&amp;rsquo;optique de minimiser au maximum la perte de donn√©e, gr√¢ce √† des fonctionnalit√© comme les accus√©s de r√©ception (&lt;code&gt;ACK&lt;/code&gt;) ou la somme de contr√¥le. Mais ces fonctionnalit√©s posent un probl√®me, les paquets s&amp;rsquo;en retrouvent alourdis, la partie somme de contr√¥le (checksum) p√®se √† elle seule 16 bits par exemple, autre exemple, pour chaque paquet d&amp;rsquo;envoie de donn√©es (&lt;code&gt;PSH&lt;/code&gt;), un paquet &lt;code&gt;ACK&lt;/code&gt; suppl√©mentaire est n√©cessaire, √† chaque fois ! Cette lourdeur pose notamment probl√®me dans le cadre d&amp;rsquo;applications en temps r√©el, d&amp;rsquo;autres protocoles comme UDP que nous √©tudierons bient√¥t ont √©t√© cr√©√©s pour rem√©dier √† ce probl√®me.&lt;/p&gt;
&lt;p&gt;Merci beaucoup d&amp;rsquo;√™tre arriv√© jusqu&amp;rsquo;ici, cet article √©tait plut√¥t complexe j&amp;rsquo;en suis conscient, si vous avez des question n&amp;rsquo;h√©sitez surtout pas √† les poser, si vous souhaitez commenter n&amp;rsquo;oubliez pas que vous pouvez vous connecter (avec le bouton &lt;em&gt;Log In&lt;/em&gt;) via Github, Twitter et Gitlab.&lt;/p&gt;
&lt;p&gt;√Ä demain üëã&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Tue, 04 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-04:/tcp.html</guid><category>Today I Learned</category></item><item><title>Le soucis du DNS de son op√©rateur</title><link>https://ilearned.eu.org/dns-fai.html</link><description>&lt;h1 id="le-soucis-du-dns-de-son-operateur"&gt;Le soucis du DNS de son op√©rateur&lt;/h1&gt;
&lt;p&gt;Pour le moment, nous avons beaucoup abord√© le DNS, avec diff√©rents moyens de s√©curiser et les risques associ√©s. Aujourd&amp;rsquo;hui, on va voir comment choisir correctement un r√©solveur, enfin pour √™tre pr√©cis comment savoir le quel ne pas prendre.&lt;/p&gt;
&lt;p&gt;Je suppose que vous avez r√©solu le NDD (nom de domaine) &lt;code&gt;blog.eban.bzh&lt;/code&gt; gr√¢ce au DNS distribu√© par votre box, il y a fort √† parier que vous ne l&amp;rsquo;ayez pas chang√© et donc que ce soit votre FAI qui r√©ponde aux requ√™tes, le probl√®me √©tant que la plupart des gros FAI ne valident pas les requ√™tes via DNSSEC. Souvent, ces DNS mentent (envoient une r√©ponse volontairement erron√©e, le plus plus souvent pour bloquer des sites.) sur base de demande faite par l&amp;rsquo;√©tat, les listes sont d&amp;rsquo;ailleurs priv√©es ce qui permettrai sans soucis de bloquer des sites totalement l√©gitimes, c&amp;rsquo;est le cas de sci-hub par exemple, une plateforme qui partage des documents scientifiques.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;dig&lt;/span&gt; &lt;span class="mf"&gt;@109.88.203.3&lt;/span&gt; &lt;span class="n"&gt;sci&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hub&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="n"&gt;DNS&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;VOO&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;un&lt;/span&gt; &lt;span class="n"&gt;op√©rateur&lt;/span&gt; &lt;span class="n"&gt;belge&lt;/span&gt;
&lt;span class="mf"&gt;54.36.19.166&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="n"&gt;IPv4&lt;/span&gt; &lt;span class="n"&gt;redirigeant&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt; &lt;span class="n"&gt;une&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="n"&gt;du&lt;/span&gt; &lt;span class="n"&gt;gouvernement&lt;/span&gt; &lt;span class="n"&gt;belge&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;% dig A sci-hub.se +short #Utilisation d&amp;#39;un DNS propre&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="mf"&gt;186.2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;163.219&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;#&lt;span class="n"&gt;IPv4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;correct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pour&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;le&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Il y a aussi un autre probl√®me, la confidentialit√©. En effet, le serveur distant peut voir toutes les requ√™tes faites par un client, dans le cas d&amp;rsquo;un FAI il peut th√©oriquement savoir pr√©cis√©ment qui vous √™tes. Ils sont (obligation l√©gal) d√©j√† en possession de votre identit√© li√©e √† l&amp;rsquo;adresse IP. Il reste peut probable que les FAI le fassent vraiment, √ßa leur rajouterai un coup cons√©quent pour le stockage de logs, sans oublier les risques de sanction si il n&amp;rsquo;est pas stipul√© dans les CGU (conditions g√©n√©rales d&amp;rsquo;utilisation) ce stockage des requ√™tes.&lt;/p&gt;
&lt;p&gt;Il y aussi le probl√®me de MITM, les DNS des op√©rateurs n&amp;rsquo;utilise pas de protocole comme DoH ou DoT, un pirate pourrait donc intercepter les requ√™tes.&lt;/p&gt;
&lt;p&gt;Dans cet article, on s&amp;rsquo;est concentr√© sur les op√©rateurs, mais ces probl√®mes existent sur beaucoup de r√©solveur publique qui bien souvent, offrent peu de garantie quand √† la confidentialit√©, ou l&amp;rsquo;authenticit√© des r√©ponses.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Mon, 03 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-03:/dns-fai.html</guid><category>misc</category></item><item><title>Usage des VLAN</title><link>https://ilearned.eu.org/vlan.html</link><description>&lt;p&gt;Souvent pour des raisons de s√©curit√© ou par n√©cessit√© de priorisation du flux de certains appareils,  il est n√©cessaire de s√©parer le r√©seau en diff√©rentes parties, pour par exemple, s√©parer un r√©seau d&amp;rsquo;administration de serveurs et du mat√©riel r√©seau avec le r√©seau destin√© aux machines d&amp;rsquo;une entreprise. Dans ce cas deux solutions sont possible, soit utiliser plusieurs interfaces r√©seaux, soit faire des VLANs.&lt;/p&gt;
&lt;p&gt;Les VLANs permettent de g√©rer de mani√®re plus ais√©e de la segmentation de r√©seaux, le principe est de par exemple permettre √† un switch r√©seau en fonction du port sur lequel est branch√© une machine d&amp;rsquo;√™tre sur une VLAN diff√©rente, chaque VLAN poss√®de un ID num√©rique pour l&amp;rsquo;identifier. &lt;/p&gt;
&lt;p&gt;Un autre concept int√©ressant des VLAN, c&amp;rsquo;est le trunk, cela permet de faire passer plusieurs VLAN sur un seul port en tagant les paquets. Ce tag est rajout√© dans l&amp;rsquo;en-t√™te ethernet  il contient l&amp;rsquo;ID de la VLAN dans laquelle le trafic doit aller. On peut aussi avoir des VLANs dites untagged, c&amp;rsquo;est √† dire qui ne demande pas la modification de l&amp;rsquo;en-t√™te ethernet. Une VLAN untagged ne demande pas de configuration sp√©cifique sur le client, c&amp;rsquo;est la VLAN &amp;ldquo;par d√©faut&amp;rdquo;, contrairement √† une VLAN tagged qui demande que le client rajoute l&amp;rsquo;information dans l&amp;rsquo;en-t√™te on ne peut donc avoir qu&amp;rsquo;une seule VLAN untagged.&lt;/p&gt;
&lt;p&gt;On peut prendre un exemple du quotidien, la box de votre FAI, si vous avez une box pour la TV par exemple, il y a de forte chance que ce soit une VLAN s√©par√©e, cela permet de prioriser le trafic de la box TV afin d&amp;rsquo;√©viter des coupures si vous t√©l√©chargez de gros fichiers par exemple. Ici, VLAN 10 est un VLAN taged et VLAN 20 est untagged, tout les appareils passent de base par VLAN 20.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma VLAN" src="/static/img/vlan.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sun, 02 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-02:/vlan.html</guid><category>Today I Learned</category></item><item><title>DANE et TLSA - Emp√™cher les certificats TLS frauduleux</title><link>https://ilearned.eu.org/dane.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui nous allons √©tudier le protocole DANE, ce protocole a √©t√© cr√©√© pour r√©pondre √† une probl√©matique simple, comment garantir l&amp;rsquo;authenticit√© d&amp;rsquo;un certificat TLS si le &lt;a href="https://fr.wikipedia.org/wiki/Autorit%C3%A9_de_certification"&gt;CA&lt;/a&gt; est corrompu et d√©livre un certificat √†, par exemple, un service de renseignement afin qu&amp;rsquo;il puisse intercepter et d√©chiffrer les requ√™tes des utilisateurs ? Cet exemple n&amp;rsquo;est pas pris par hasard, &lt;a href="https://security.googleblog.com/2013/12/further-improving-digital-certificate.html"&gt;un cas similaire&lt;/a&gt; s&amp;rsquo;est produit en 2013 o√π l&amp;rsquo;ANSSI avait d√©livr√© des certificats pour des domaines de Google, probablement √† des fins de renseignement. La &lt;a href="https://tools.ietf.org/html/rfc6698"&gt;&lt;code&gt;RFC 6698&lt;/code&gt;&lt;/a&gt; introduit donc le standard DANE (DNS Authentication of Named Entities) et le record DNS &lt;code&gt;TLSA&lt;/code&gt;. Le principe est simple, ajouter un record dans la zone DNS qui contient un condensat du v√©ritable certificat TLS, cette m√©thode ressemble tr√®s fortement au TLS Pinning, √©voqu√© dans &lt;a href="https://blog.eban.bzh/today-i-learned/dot-doh.html"&gt;l&amp;rsquo;article d&amp;rsquo;hier&lt;/a&gt; mais a pour sp√©cificit√© de placer le condensat au niveau du DNS.&lt;/p&gt;
&lt;p&gt;Voici un exemple de record pour &lt;a href="http://blog.eban.bzh"&gt;blog.eban.bzh&lt;/a&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;_443._tcp.blog.eban.bzh. 10800  IN  TLSA    3 1 1 D7DF5F6E8325454CF25B711D7FCB22CD639C4F26514E5473EC73C59353C16F0D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On voit donc que l&amp;rsquo;on doit sp√©cifier dans le record le port (ici, 443), le protocole utilis√© (ici TCP, en passant, restez √† l&amp;rsquo;affut dans les prochains jours un article √† propos de ce protocole pourrait sortir üëÄ) puis le domaine auquel il s&amp;rsquo;applique, les trois num√©ros suivant &lt;code&gt;3 1 1&lt;/code&gt; correspondent respectivement, √† l&amp;rsquo;utilit√© du cadre d&amp;rsquo;utilisation de ce record, ici &lt;code&gt;DANE-EE: Domain Issued Certificate&lt;/code&gt; un certificat donn√© pour un nom de domaine. Le &lt;code&gt;1&lt;/code&gt; suivant indique le type de certificat hash√©, &lt;code&gt;0&lt;/code&gt; correspondant √† un &lt;a href="https://en.wikipedia.org/wiki/Chain_of_trust"&gt;certificat fullchain&lt;/a&gt; et &lt;code&gt;1&lt;/code&gt; √† la cl√© publique uniquement, le dernier &lt;code&gt;1&lt;/code&gt; correspond enfin √† la fonction de hashage utilis√©e, ici &lt;a href="https://en.wikipedia.org/wiki/SHA-2"&gt;SHA-256&lt;/a&gt;. Une fois ce certificat mis en place le navigateur devrait, en principe, comparer ce hash avec un hash qu&amp;rsquo;il g√©n√®rerait de son c√¥t√©, en principe car DANE n&amp;rsquo;est pr√©sent dans &lt;a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1479423"&gt;aucun navigateur grand publique&lt;/a&gt;. Il existe cependant le module &lt;a href="https://addons.mozilla.org/en-US/firefox/addon/dnssec-dane-validator"&gt;DNSSEC/DANE Validator&lt;/a&gt; pour firefox et &lt;a href="https://chrome.google.com/webstore/detail/tlsa-validator/gmgeefghnadlmkpbjfamblomkoknhjga"&gt;TLSA Validator&lt;/a&gt; pour chromium et d√©riv√©s. Pour r√©sumer le fonctionnement de DANE, voici un petit sch√©ma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/dane/Frame_21.png" src="/static/img/dane/Frame_21.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/dane/Frame_22.png" src="/static/img/dane/Frame_22.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 01 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-01:/dane.html</guid><category>misc</category></item><item><title>Fonctionnement du DNS over TLS et du DNS over HTTPS</title><link>https://ilearned.eu.org/dot-doh.html</link><description>&lt;p&gt;Hier on √©voquait le probl√®me de l‚Äôauthenticit√© des r√©ponses d&amp;rsquo;un serveur DNS. Nous avons vu la solution : DNSSEC mais ce m√©canisme ne fait que signer les requ√™tes pour emp√™cher une modification, il n&amp;rsquo;emp√™che pas un espionnage passif des requ√™tes. Le risque d&amp;rsquo;espionnage demande de s√©curiser le canal, deux solutions ont √©t√© retenues : &lt;code&gt;DoT&lt;/code&gt; et &lt;code&gt;DoH&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;DoT est l&amp;rsquo;acronyme de DNS  over TLS, ce protocole est assez &amp;ldquo;simple&amp;rdquo; si on omet l&amp;rsquo;explication de TLS qui sera vue prochainement, c&amp;rsquo;est du DNS qui passe par un canal chiffr√© via TLS. On utilise TCP sur le port 853.&lt;/p&gt;
&lt;p&gt;Un soucis ce pose, TLS se base souvent, comme dans le monde du web avec HTTPS par exemple, sur des autorit√©s de certification (abr√©g√© CA) qui en th√©orie s&amp;rsquo;assure de d√©livrer des certificat qu&amp;rsquo;ils ont sign√©s pour prouver la l√©gitimit√©, mais en r√©alit√© ce syst√®me est assez peu fiable, il n&amp;rsquo;est en effet pas rare de voir une autorit√© d√©livrer par erreur ou m√™me intentionnellement des certificats v√©rol√©s, qui n&amp;rsquo;aurait pas du sortir, de plus, historiquement un certificat coute assez ch√®re, m√™me si de nos jours certaines organisations comme &lt;a href="https://letsencrypt.org/"&gt;Let&amp;rsquo;s Encrypt&lt;/a&gt; d√©livre gratuitement un certificat TLS.&lt;/p&gt;
&lt;p&gt;Pour se passer de CA plusieurs solutions existent, la plus simple est tout simplement de ne pas v√©rifier le certificat, cela prot√®ge d&amp;rsquo;un attaquant &amp;ldquo;passif&amp;rdquo; mais Il reste relativement ais√© de remplacer le certificat √† la vol√©. Pour emp√™cher ce cas on peut faire de l&amp;rsquo;√©pinglage de cl√©, ce principe se base sur un condensat du certificat qui est ensuite mit en base64, le logiciel peut ensuite comparer le certificat distant avec la cl√© qu&amp;rsquo;il a en local si un pirate effectue une attaque de l&amp;rsquo;homme du milieu (MITM) et remplace le certificat en court de route le client se rendra compte du subterfuge.&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSL pining" src="/static/img/ssl-pining.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSL pining mauvais certificat" src="/static/img/ssl-pining-fail.png"&gt;&lt;/p&gt;
&lt;p&gt;Un dernier probl√®me dans DoT existe, un pare feu peut facilement en emp√™cher le fonctionnement, dans le cadre de portail captif par exemple souvent seul le trafic HTTP est autoris√©. Une solution pour pallier √† ce probl√®me existe : DNS over HTTPS (DoH).&lt;/p&gt;
&lt;p&gt;DoH permet comme DoT de chiffrer le canal de communication, mais en passant par HTTPS l&amp;rsquo;avantage est qu&amp;rsquo;il est difficilement bloquable, en effet bloquer HTTPS bloquerai par la m√™me occasion un grands nombres de sites web. Le fonctionnement reste ax√© sur le principe d&amp;rsquo;HTTP, l&amp;rsquo;avantage d&amp;rsquo;HTTP est le contr√¥le du cache directement sur le client avec l&amp;rsquo;en-t√™te &lt;code&gt;Cache-Control: max-age=X&lt;/code&gt; (ou X est le temps en seconde). Comme pour DoT plusieurs choix existe pour la validit√© du certificat, ce sont les m√™mes choix qui s&amp;rsquo;offrent √† nous. Pour ce qui est des codes de retour du DNS ils sont dans le corps du message, et non sous forme de code HTTP, bien sur les codes classiques HTTP sont toujours appliqu√©s.&lt;/p&gt;
&lt;p&gt;Ces deux m√©thodes peuvent poser soucis dans certains cadre, en effet, il est dans beaucoup de cas requis de passer par un programme qui &amp;ldquo;traduit&amp;rdquo; de DoH ou DoT vers le protocole DNS directement. Un exemple de logiciel est par exemple &lt;code&gt;stubby&lt;/code&gt; sous Linux.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Proxy DoH/DoT" src="/static/img/proxy-dot-doh.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Fri, 30 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-30:/dot-doh.html</guid><category>misc</category></item><item><title>Fonctionnement de DNSSEC</title><link>https://ilearned.eu.org/dnssec.html</link><description>&lt;p&gt;Petit rappel: ce blog a un &lt;a href="https://blog.eban.bzh/rss.xml"&gt;flux RSS&lt;/a&gt;, n&amp;rsquo;h√©sitez pas √† l&amp;rsquo;ajouter √† votre lecteur de flux RSS favori :)&lt;/p&gt;
&lt;p&gt;Hier nous avons vu comment s√©curiser la connexion entre un serveur slave et un serveur master, mais le probl√®me d&amp;rsquo;authenticit√© des r√©ponses se pose encore, pour commencer le trafic entre le serveur autoritaire et r√©solveur n&amp;rsquo;est pas chiffr√©, n&amp;rsquo;importe quel attaquant qui pratique une attaque type &lt;a href="https://fr.wikipedia.org/wiki/Attaque_de_l%27homme_du_milieu"&gt;&lt;code&gt;MITM&lt;/code&gt;&lt;/a&gt; peut donc modifier les r√©ponses. Le canal n&amp;rsquo;est pas le seul probl√®me, surtout qu&amp;rsquo;il est d√©j√† possible de s√©curiser le canal entre r√©solveur et autoritaire, et entre le r√©solveur et le client via &lt;code&gt;DoT&lt;/code&gt; (DNS over TLS) et &lt;code&gt;DoH&lt;/code&gt; (DNS over HTTPS), nous en parlerons plus largement demain ;). S√©curiser le canal si le serveur est corrompu ne sert pas √† grand chose, c&amp;rsquo;est la raison pour laquelle &lt;code&gt;DNSSEC&lt;/code&gt; (&lt;code&gt;RFC 4033&lt;/code&gt;) a √©t√© invent√©.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma sur les risques sans DNSSEC" src="/static/img/schema_risques_dnssec.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;DNSSEC&lt;/code&gt; est une mani√®re de signer de fa√ßon cryptographique une zone DNS sur base d&amp;rsquo;un syst√®me de cl√©s asym√©triques, un syst√®me de cl√©s asym√©triques repose sur 2 cl√©s, une priv√©e qui est gard√©e pr√©cieusement et qui sert √† signer ou d√©chiffrer des donn√©es et une publique qui sert √† v√©rifier ou chiffrer des donn√©es. Dans le cadre du DNSSEC le chiffrement ne sert pas, la cl√© priv√©e sert donc uniquement √† signer. &lt;/p&gt;
&lt;p&gt;Pour proc√©der on utilise en g√©n√©ral deux pairs de cl√©s : la &lt;code&gt;KSK&lt;/code&gt; (key-signing key) et la &lt;code&gt;ZSK&lt;/code&gt; (zone-signing key). La cl√© KSK est seulement l√† pour la signature de la ZSK, on lui donne une dur√©e de vie plus grande que la ZSK et elle peut √™tre stock√©e et g√©n√©r√©e hors ligne pour accroitre la s√©curit√©s de celle ci, l&amp;rsquo;avantage de ce syst√®me est de pouvoir garder plus longtemps la m√™me cl√© sans rajouter trop de risque de fuite vu que stock√©e hors ligne, dans un lieu s√©curis√©. La ZSK quand √† elle est sert √† signer la zone, elle doit donc √™tre pr√©sente sur la machine qui g√©n√®re la zone, on la change plus souvent pour √©viter les risques de fuites. Les serveurs esclaves n&amp;rsquo;ont besoin d&amp;rsquo;aucune des 2 cl√©s, ils re√ßoivent directement la zone sign√©e, la modification de la zone de leur part n&amp;rsquo;est donc plus possible si le r√©solveur v√©rifie avec DNSSEC.&lt;/p&gt;
&lt;p&gt;DNSSEC ne signe pas la zone de mani√®re enti√®re, mais signe chaque enregistrement ind√©pendamment, la signature est contenue dans le record de type &lt;code&gt;RSSIG&lt;/code&gt;. Ce fonctionnement pose un soucis si il permet de signer une entr√©e DNS, comment prouve t&amp;rsquo;on inexistante d&amp;rsquo;un enregistrement ? Pour r√©soudre cette probl√©matique l‚Äôenregistrement de type &lt;code&gt;NSEC&lt;/code&gt; existe.&lt;/p&gt;
&lt;p&gt;NSEC est un moyen de prouver l‚Äôinexistence (symbolis√© par le code de retour &lt;code&gt;NXDOMAIN&lt;/code&gt;) d&amp;rsquo;un record en donnant le prochain (par ordre alphab√©tique) enregistrement de la zone, un probl√®me de confidentialit√© se pose avec cet m√©thode, il est en effet tr√®s simple d&amp;rsquo;√©num√©rer la liste d&amp;rsquo;enregistrement. Pour emp√™cher ce type d&amp;rsquo;attaque NSEC3 est n√©, au lieu de donner le FQDN on ne retourne que le condensat, l&amp;rsquo;√©num√©ration devient donc impossible.&lt;/p&gt;
&lt;p&gt;Une derni√®re probl√©matique, et pas des moindres existe, comment s&amp;rsquo;√©changer de mani√®re fiable les cl√©s √† grande √©chelle ? On ne peut pas se les donner de personne √† personne, c&amp;rsquo;est ing√©rable au vu du nombre de zones pr√©sentes sur internet. Pour r√©soudre cette probl√©matique deux enregistrements existent : DS et DNSKEY.&lt;/p&gt;
&lt;p&gt;Commen√ßons pas DNSKEY, il permet d&amp;rsquo;enregistrer la cl√© publique qui signe la zone, cette enregistrement est stock√© dans la zone elle m√™me.&lt;/p&gt;
&lt;p&gt;Avec uniquement DNSKEY on ne peut pas valider correctement la zone, la fiabilit√© de la chaine n&amp;rsquo;est pas garantie, il slave pourrait modifier ce record pour modifier la zone √† sa guise, pour v√©rifier il existe donc un enregistrement DS qui se situe dans la zone parente et permet de faire une r√©f√©rence √† la cl√© publique utilis√©e pour signer la zone du FQDN, c&amp;rsquo;est le registrar qui s&amp;rsquo;occupe de faire placer cet enregistrement. Pour ce qui est de la zone &lt;code&gt;.&lt;/code&gt; il est impossible de d√©finir un record DS au dessus, car c&amp;rsquo;est la zone la plus basse, l&amp;rsquo;IANA donne donc la cl√© utilis√©e et c&amp;rsquo;est disponible ici : &lt;a href="https://www.iana.org/dnssec/files"&gt;https://www.iana.org/dnssec/files&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma fonctionnement DNSSEC" src="/static/img/schema_dnssec.png"&gt;&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour cet article, j&amp;rsquo;esp√®re que √ßa vous aura plus. Si vous avez des remarques ou questions n&amp;rsquo;h√©sitez pas en commentaire. On se retrouve demain pour parler de &lt;strong&gt;DNS over TLS et DNS over HTTPS&lt;/strong&gt; :)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Thu, 29 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-29:/dnssec.html</guid><category>misc</category></item><item><title>Comment sont allou√©es les adresses IPs</title><link>https://ilearned.eu.org/allocation-ips.html</link><description>&lt;p&gt;Internet est un √©norme &amp;ldquo;r√©seau de r√©seaux&amp;rdquo; et comme toute grande organisation son fonctionnement est relativement complexe, aujourd&amp;rsquo;hui nous allons tenter de d√©crypter le fonctionnement de l&amp;rsquo;allocation d&amp;rsquo;adresse IP sur Internet üôÇ. Vous commencez √† avoir l&amp;rsquo;habitude, commen√ßons par un sch√©ma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma allocation IP" src="/static/img/schema-ip.png"&gt;&lt;/p&gt;
&lt;p&gt;√Ä la t√™te d&amp;rsquo;Internet, il y a une organisation, l&amp;rsquo;ICANN (Internet Corporation for Assigned Names and Numbers soit Soci√©t√© pour l&amp;rsquo;attribution des noms de domaine et des num√©ros sur Internet en fran√ßais) cette entreprise am√©ricaine g√®re les noms de domaine et les adresses IPs via l&amp;rsquo;IANA qui est un d√©partement de cette institution. &lt;/p&gt;
&lt;p&gt;Les IPs sont ensuite redistribu√©es entre cinq organisations appel√©s RIRs,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;L&amp;rsquo;ARIN pour les pays d&amp;rsquo;Am√©rique du nord. √Ä qui l&amp;rsquo;IANA attribue 93 /8&lt;/li&gt;
&lt;li&gt;Le LACNIC pour les pays d&amp;rsquo;Am√©rique du sud. √Ä qui l&amp;rsquo;IANA attribue 10 /8&lt;/li&gt;
&lt;li&gt;L&amp;rsquo;AFRINIC pour les pays d&amp;rsquo;Afrique. √Ä qui l&amp;rsquo;IANA attribue 42 /8&lt;/li&gt;
&lt;li&gt;Le RIPE NCC pour l&amp;rsquo;Europe et le Moyen-Orient? √Ä qui l&amp;rsquo;IANA attribue 6 /8&lt;/li&gt;
&lt;li&gt;L&amp;rsquo;APNIC pour l&amp;rsquo;Asie et le Pacifique. √Ä qui l&amp;rsquo;IANA attribue 51 /8&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Organisation par continent" src="/static/img/organisation-ip-continent.svg"&gt;&lt;/p&gt;
&lt;p&gt;On remarque donc de grandes in√©galit√©s dans l&amp;rsquo;allocation des IPs entre les RIRs. Ces RIRs attribuent ensuite eux m√™me des plages d&amp;rsquo;IPs √† de LIRs (Local Internet Registry ou registre Internet local), nous prendrons ici l&amp;rsquo;exemple de &lt;em&gt;iFog GmbH&lt;/em&gt; qui est un LIR d√©clar√© apr√®s du RIPE NCC. Les LIRs sont des interm√©diaires entre les RIR et les AS. &lt;/p&gt;
&lt;p&gt;Nous en venons donc √† notre dernier point, les AS (Autonomous System) sont des entit√©s identifi√©es par un num√©ro de 32 bits (ou 16 avant 2007 ou dans certains cas aujourd&amp;rsquo;hui), ces num√©ros sont appel√©s ASN (Autonomous System Number), promit c&amp;rsquo;est le dernier acronyme üòõ, ce sont ces AS qui peuvent avoir des ranges d&amp;rsquo;IPs, par exemple l&amp;rsquo;AS213253 a le range &lt;code&gt;2a0c:9a40:81fb::/48&lt;/code&gt; qui lui est attribu√© par l&amp;rsquo;interm√©diare d&amp;rsquo;iFog GmbH, cette AS poss√®de aussi &lt;code&gt;2a0e::fd45::2a00::/40&lt;/code&gt; qui lui est attribu√© par un autre LIR : Bakker IT. &lt;/p&gt;
&lt;p&gt;Il faut savoir qu&amp;rsquo;un AS est couteux, pour vous donner un ordre d&amp;rsquo;id√©e le co√ªt approximatif d&amp;rsquo;un AS √† l&amp;rsquo;ann√©e est d&amp;rsquo;environ 4000‚Ç¨ en prenant en compte le transit, les IPs etc.&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article qui, je l&amp;rsquo;esp√®re vous aura √©clair√© sur le fonctionnement d&amp;rsquo;Internet ;) Si vous avez des questions n&amp;rsquo;h√©sitez pas √† les formuler dans les commentaires, on se retrouve demain pour parler de DNSSEC.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Wed, 28 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-28:/allocation-ips.html</guid><category>misc</category></item><item><title>S√©curiser la connexion entre Master et Slave</title><link>https://ilearned.eu.org/tsig-xot.html</link><description>&lt;p&gt;Comme nous l&amp;rsquo;avons vu &lt;a href="https://google.com/"&gt;hier&lt;/a&gt;, la communication entre &lt;code&gt;master&lt;/code&gt; et &lt;code&gt;slave&lt;/code&gt; est faite en claire ce qui peut repr√©senter une probl√®me de s√©curit√©, plusieurs syst√®mes ont donc √©t√© mit en place afin de s√©curiser ce syst√®me.&lt;/p&gt;
&lt;h1 id="le-filtrage-par-ip"&gt;Le filtrage par IP&lt;/h1&gt;
&lt;p&gt;Le moyen le plus courant pour filtrer les demandes de transfert de zone est le filtrage par IP, mais il pr√©sente deux inconv√©nients principaux, ce filtrage par IP peut poser probl√®me dans le cas o√π le slave aurait un IP dynamique et pose aussi un probl√®me de s√©curit√© d√ª au fait qu&amp;rsquo;une IP puisse √™tre &amp;ldquo;&lt;a href="https://en.wikipedia.org/wiki/IP_address_spoofing"&gt;spoof√©&lt;/a&gt;&amp;rdquo; (= usurp√©e), ce type d&amp;rsquo;attaque fera tr√®s probablement l&amp;rsquo;objet d&amp;rsquo;un article dans un futur proche üòâ.&lt;/p&gt;
&lt;h1 id="le-protocole-tsig"&gt;Le protocole TSIG&lt;/h1&gt;
&lt;p&gt;Le protocole &lt;code&gt;TSIG&lt;/code&gt;, introduit en Mai 2000 par la &lt;a href="https://tools.ietf.org/html/rfc2845"&gt;RFC 2845&lt;/a&gt; (pour info, une RFC, requests for comments, est un documents qui d√©taille le fonctionnement d&amp;rsquo;Internet ou de diff√©rents mat√©riels informatique) permet d&amp;rsquo;authentifier un &lt;code&gt;slave&lt;/code&gt; gr√¢ce √† un secret partag√©, le &lt;code&gt;slave&lt;/code&gt; envoie un premier paquet contenant un &lt;a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function"&gt;condensat&lt;/a&gt; (hash) de la cl√©, le master compare alors ce hash avec celui qu&amp;rsquo;il g√©n√®re aussi de son c√¥t√© √† partir de cette m√™me cl√©, s&amp;rsquo;ils correspondent et que les &lt;code&gt;id&lt;/code&gt; (= nom de la cl√©) sont identiques le slave est authentifi√©, pour r√©sumer cela, voici un sch√©ma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="https://i.postimg.cc/0yhhnRjL/Frame-4.png" src="/static/img/tsig-xot/Frame_4.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Se%CC%81curiser%20la%20connexion%20entre%20Master%20et%20Slave%206ab075baba074e2a967914523258907d/Frame_5.png" src="/static/img/tsig-xot/Frame_5.png"&gt;&lt;/p&gt;
&lt;p&gt;Ce protocole a cependant deux tares, premi√®rement, la cl√© doit √™tre partag√©e pour la premi√®re fois de fa√ßon s√©curis√©e, ce qui n&amp;rsquo;est pas toujours chose facile, deuxi√®me tare, l&amp;rsquo;authentification est bien s√©curis√©e, mais c&amp;rsquo;est moins le cas pour les requ√™tes &lt;a href="https://google.com"&gt;AXFR/IXFR&lt;/a&gt; qui sont seulement sign√©e, ainsi, l&amp;rsquo;int√©grit√© de la r√©ponse peut √™tre assur√©e mais son contenu transite en clair sur internet, il existe cependant un autre projet de protocole qui pourrais permettre de s√©curiser ces √©changes.&lt;/p&gt;
&lt;h1 id="xfr-over-tls"&gt;XFR over TLS&lt;/h1&gt;
&lt;p&gt;Le protocole &lt;a href="https://tools.ietf.org/html/draft-ietf-dprive-xfr-over-tls-11"&gt;XoT&lt;/a&gt; (XFR over TLS) est encore √† l&amp;rsquo;√©tat de &amp;ldquo;draft&amp;rdquo; (brouillon) mais il permettrait de pallier √† ce probl√®me en chiffrant les requ√™tes gr√¢ce au protocole TLS. Il existe malgr√© tout une impl√©mentation exp√©rimentale de XoT dans le logiciel &lt;a href="https://gitlab.isc.org/isc-projects/bind9"&gt;Bind&lt;/a&gt;, XoT est donc un protocole tr√®s prometteur afin de garantir la confidentialit√© des transferts de zone.&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, on se retrouve demain pour parler de l&amp;rsquo;allocation des adresses IP sur
internetüôÇ.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Tue, 27 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-27:/tsig-xot.html</guid><category>Today I Learned</category></item><item><title>Communication entre Master et Slave - Vuln√©rabilit√© transfert de zone</title><link>https://ilearned.eu.org/xfr-zone-transfer.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui, on parle des procotoles AXFR et IXFR ainsi que de la vuln√©rabilit√© que peut repr√©senter un transfert de zone non autoris√© !&lt;/p&gt;
&lt;p&gt;AXFR est un protocole qui sert √† faire des transferts de zone du &lt;code&gt;master&lt;/code&gt; vers le &lt;code&gt;slave&lt;/code&gt;, le &lt;code&gt;slave&lt;/code&gt; v√©rifie p√©riodiquement si le serial (=num√©ro de version, voir &lt;a href="https://blog.eban.bzh/today-i-learned/les-bases-du-dns.html"&gt;ici&lt;/a&gt; si vous ne vous rappelez plus de ce que c&amp;rsquo;est) de son SOA est inf√©rieur √† celui du &lt;code&gt;master&lt;/code&gt;, si c&amp;rsquo;est le cas, il fait une demande de transfert de zone, qui peut √™tre fait gr√¢ce au protocole AXFR. Concr√®tement le &lt;code&gt;master&lt;/code&gt; envoie simplement une copie de sa zone DNS vers le &lt;code&gt;slave&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Il existe aussi un autre protocole pour le m√™me usage appel√© IXFR, avec IXFR, si le &lt;code&gt;slave&lt;/code&gt; remarque que son serial est inf√©rieur √† celui du &lt;code&gt;master&lt;/code&gt;, il envoie le serial de la version de la zone qu&amp;rsquo;il d√©tient au &lt;code&gt;master&lt;/code&gt;, le &lt;code&gt;master&lt;/code&gt; envoie ensuite le nouveau serial et deux listes, une pour les records √† supprimer et une autre pour les records √† ajouter/modifier. IXFR a pour avantage principal de n√©cessiter moins de bande passante qu&amp;rsquo;AXFR.&lt;/p&gt;
&lt;p&gt;Un fois ces petites explications faites, passons √† la partie la plus int√©ressante, l&amp;rsquo;exploitation d&amp;rsquo;un transfert de zone :p. Pour authentifier un slave on effectue souvent un filtrage par IP, n√©anmoins il arrive que ce filtrage ne soit pas mit en place, n&amp;rsquo;importe qui peut alors dumper (= avoir une copie) de la zone tr√®s facilement, voici un exemple que vous pouvez essayer de reproduire chez vous.&lt;/p&gt;
&lt;p&gt;Nous allons dans un premier temps demander √† notre serveur DNS r√©solveur la liste des serveurs DNS autoritaires pour le domaine &lt;code&gt;zonetransfer.me&lt;/code&gt;. L&amp;rsquo;option &lt;code&gt;+short&lt;/code&gt; que j&amp;rsquo;ai ajout√© ici permet simplement d&amp;rsquo;avoir directement le r√©sultat sans d&amp;rsquo;autres informations.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;‚û§ dig zonetransfer.me NS +short
nsztm1.digi.ninja.
nsztm2.digi.ninja.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Nous avons donc ici les deux serveurs DNS autoritaires du nom de domaine &lt;code&gt;zonetransfer.me&lt;/code&gt;. Essayons donc de faire une requ√™te DNS de type AXFR sur un de ces deux serveurs.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;‚û§ dig axfr @nsztm2.digi.ninja zonetransfer.me

&lt;span class="p"&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG &lt;span class="m"&gt;9&lt;/span&gt;.11.28-RedHat-9.11.28-1.fc33 &amp;lt;&amp;lt;&amp;gt;&amp;gt; axfr @nsztm2.digi.ninja zonetransfer.me
&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; server found&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; global options: +cmd
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  SOA nsztm1.digi.ninja. robin.digi.ninja. &lt;span class="m"&gt;2019100801&lt;/span&gt; &lt;span class="m"&gt;172800&lt;/span&gt; &lt;span class="m"&gt;900&lt;/span&gt; &lt;span class="m"&gt;1209600&lt;/span&gt; &lt;span class="m"&gt;3600&lt;/span&gt;
zonetransfer.me.    &lt;span class="m"&gt;300&lt;/span&gt; IN  HINFO   &lt;span class="s2"&gt;&amp;quot;Casio fx-700G&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Windows XP&amp;quot;&lt;/span&gt;
zonetransfer.me.    &lt;span class="m"&gt;301&lt;/span&gt; IN  TXT &lt;span class="s2"&gt;&amp;quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&amp;quot;&lt;/span&gt;
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;0&lt;/span&gt; ASPMX.L.GOOGLE.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;10&lt;/span&gt; ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;10&lt;/span&gt; ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX4.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  A   &lt;span class="m"&gt;5&lt;/span&gt;.196.105.14
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  NS  nsztm1.digi.ninja.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  NS  nsztm2.digi.ninja.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;J&amp;rsquo;ai volontairement coup√© une bonne partie de la r√©ponse car elle serait trop longue sinon. Nous pouvons donc voir que nous arrivons √† avoir une copie de la zone DNS compl√®te, copie que nous ne devrions normalement pas avoir car elle peut comporter des informations sensibles comme par exemple des sous-domaines cens√©s rester en interne ou des record PTR (les enregistrements PTR associent une IP √† un nom de domaine) qui permettraient de trouver des IPs √† analyser.&lt;/p&gt;
&lt;p&gt;Et voil√† concr√®tement ce que donne une requ√™te AXFR sur le r√©seau :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="m"&gt;10&lt;/span&gt;.2.0.2.36871 &amp;gt; &lt;span class="m"&gt;34&lt;/span&gt;.225.33.2.53: Flags &lt;span class="o"&gt;[&lt;/span&gt;P.&lt;span class="o"&gt;]&lt;/span&gt;, cksum 0xa73b &lt;span class="o"&gt;(&lt;/span&gt;correct&lt;span class="o"&gt;)&lt;/span&gt;, seq &lt;span class="m"&gt;1&lt;/span&gt;:59, ack &lt;span class="m"&gt;1&lt;/span&gt;, win &lt;span class="m"&gt;502&lt;/span&gt;, options &lt;span class="o"&gt;[&lt;/span&gt;nop,nop,TS val &lt;span class="m"&gt;3406917213&lt;/span&gt; ecr &lt;span class="m"&gt;943752624&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;, length &lt;span class="m"&gt;58&lt;/span&gt; &lt;span class="m"&gt;38384&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;1au&lt;span class="o"&gt;]&lt;/span&gt; AXFR? zonetransfer.me. &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;

&lt;span class="m"&gt;34&lt;/span&gt;.225.33.2.53 &amp;gt; &lt;span class="m"&gt;10&lt;/span&gt;.2.0.2.36871: Flags &lt;span class="o"&gt;[&lt;/span&gt;.&lt;span class="o"&gt;]&lt;/span&gt;, seq &lt;span class="m"&gt;1&lt;/span&gt;:1441, ack &lt;span class="m"&gt;59&lt;/span&gt;, win &lt;span class="m"&gt;489&lt;/span&gt;, options &lt;span class="o"&gt;[&lt;/span&gt;nop,nop,TS val &lt;span class="m"&gt;943753618&lt;/span&gt; ecr &lt;span class="m"&gt;3406917375&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;, length &lt;span class="m"&gt;1440&lt;/span&gt; &lt;span class="m"&gt;38384&lt;/span&gt;*- &lt;span class="m"&gt;51&lt;/span&gt;/0/1 zonetransfer.me. SOA nsztm1.digi.ninja. robin.digi.ninja. &lt;span class="m"&gt;2019100801&lt;/span&gt; &lt;span class="m"&gt;172800&lt;/span&gt; &lt;span class="m"&gt;900&lt;/span&gt; &lt;span class="m"&gt;1209600&lt;/span&gt; &lt;span class="m"&gt;3600&lt;/span&gt;, zonetransfer.me. HINFO, zonetransfer.me. TXT &lt;span class="s2"&gt;&amp;quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&amp;quot;&lt;/span&gt;, zonetransfer.me. MX ASPMX.L.GOOGLE.COM. &lt;span class="m"&gt;0&lt;/span&gt;, zonetransfer.me. MX ALT1.ASPMX.L.GOOGLE.COM. &lt;span class="m"&gt;10&lt;/span&gt;, zonetransfer.me. MX ALT2.ASPMX.L.GOOGLE.COM. &lt;span class="m"&gt;10&lt;/span&gt;, zonetransfer.me. MX ASPMX2.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;, zonetransfer.me. MX ASPMX3.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;, zonetransfer.me. MX ASPMX4.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;, zonetransfer.me. MX ASPMX5.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On voit donc que les informations transitent &lt;strong&gt;en clair&lt;/strong&gt; (= non chiffr√©es) sur le r√©seau.&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour aujourd&amp;rsquo;hui merci beaucoup d&amp;rsquo;avoir lu cet article, n&amp;rsquo;h√©sitez pas √† laisser un commentaire si vous avez des remarques √† faire dessus, on se retrouve demain pour parler de comment &lt;strong&gt;s√©curiser la communication entre master slave&lt;/strong&gt;. üëã&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Mon, 26 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-26:/xfr-zone-transfer.html</guid><category>Today I Learned</category></item><item><title>Le principe de Master/Slave - Le r√¥le du registrar</title><link>https://ilearned.eu.org/master-slave-registrar.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui, on parle du r√¥le d&amp;rsquo;un Registrar puis dans une seconde partie du principe de Master/Slave dans le cadre de serveur DNS autoritaire.&lt;/p&gt;
&lt;p&gt;Les registrars ou bureaux d&amp;rsquo;enregistrement en fran√ßais sont des organisations qui g√®rent les domaines de premier niveau (TLD). On peut citer par exemple EURid qui g√®re le &lt;code&gt;.eu&lt;/code&gt;, DNS Belgium pour le &lt;code&gt;.be&lt;/code&gt; ou encore l&amp;rsquo;AFNIC pour le &lt;code&gt;.fr&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Ces registrars obtiennent leurs domaines de premier niveau aupr√®s de l&amp;rsquo;IANA. &lt;em&gt;je suppose que vous vous demandez ce qu&amp;rsquo;est l&amp;rsquo;IANA ?&lt;/em&gt; L&amp;rsquo;IANA est une branche de l&amp;rsquo;iCANN, c&amp;rsquo;est la branche qui g√®re l&amp;rsquo;attribution de ressource comme les blocs d&amp;rsquo;IP ou les TLD.&lt;/p&gt;
&lt;p&gt;Pour ce qui est de la revente de domaines, souvent les bureaux d&amp;rsquo;enregistrements passent par des sous-traitants, ces sous-traitants doivent respecter certaines r√®gles comme par exemple un prix fixe revers√© au registrar, ou des restrictions g√©ographiques.&lt;/p&gt;
&lt;h1 id="le-principe-de-masterslave"&gt;Le principe de Master/Slave&lt;/h1&gt;
&lt;p&gt;Le principe de master et de slave est assez important dans le monde du DNS et de l&amp;rsquo;informatique en g√©n√©ral, il permet, dans le cadre du DNS, de redonder facilement une zone sur plusieurs serveurs autoritaires.&lt;/p&gt;
&lt;p&gt;Le serveur dit &lt;code&gt;master&lt;/code&gt; (ma√Ætre) est celui qui contr√¥le la zone, il poss√®de le fichier &amp;ldquo;original&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Dans certains contextes, comme pour √©viter la corruption de tous les serveurs en cas d&amp;rsquo;erreur sur le ma√Ætre, on utilise plusieurs serveurs masters, il n&amp;rsquo;y a plus une seule zone &amp;ldquo;original &amp;rdquo; mais plusieurs, le d√©savantage d&amp;rsquo;un tel syst√®me c&amp;rsquo;est qu&amp;rsquo;on est oblig√© de mettre √† jour chaque serveurs master &lt;em&gt;manuellement&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Le serveur dit &lt;code&gt;slave&lt;/code&gt; (esclave) est celui qui re√ßoit la zone depuis un serveur master, ce transfert de zone DNS &lt;em&gt;&lt;em&gt;utilise des protocoles comme AXFR ou IXFR &lt;/em&gt;mais √ßa c&amp;rsquo;est pour demain üòâ.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ce concept de master/slave permet de redonder une zone bien plus facilement que si on le faisait manuellement.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sch√©ma sur le fonctionnement master/slave" src="/static/img/master-slave-registrar/schema-master-slave.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sun, 25 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-25:/master-slave-registrar.html</guid><category>misc</category></item><item><title>Les bases du DNS</title><link>https://ilearned.eu.org/les-bases-du-dns.html</link><description>&lt;p&gt;Pour ce premier post dans la cat√©gorie &lt;em&gt;Today I Learned&lt;/em&gt;, on repart des bases, aujourd&amp;rsquo;hui on parle de DNS üòÑ. Pour les lecteurs les plus exp√©riment√©s connaissant d√©j√† bien les bases du syst√®me de DNS, rendez-vous demain üòâ. Les pr√©requis pour aborder cet article sont : des &lt;strong&gt;petites bases de r√©seau&lt;/strong&gt;, la notion d&amp;rsquo;IP, de nom de domaine, et √ßa devrait suffire :) Vous trouverez √† chaque fois en d√©but d&amp;rsquo;article une petite &amp;ldquo;carte mentale&amp;rdquo; repr√©sentant les sujets que nous aurons d√©j√† abord√© en lien avec cet article, afin que vous puissiez avoir un acc√®s plus facile aux pr√©-requis il suffit de cliquer sur le nom de l&amp;rsquo;article ou de la notion dans le sch√©ma pour avoir le lien.&lt;/p&gt;
&lt;p&gt;Le DNS (Domain Name System) est un protocole permettant de &amp;ldquo;traduire&amp;rdquo; un &lt;a href="https://www.wikipedia.com/wiki/Domain_name"&gt;nom de domaine&lt;/a&gt; en une &lt;a href="https://www.wikipedia.com/wiki/IP_address"&gt;adresse IP&lt;/a&gt;. Il existe deux types de serveurs DNS, les serveurs DNS r√©solveur, aussi appel√©s r√©curseurs (comme 1.1.1.1 ou 80.67.169.40 par exemple) servent √† &amp;ldquo;traduire&amp;rdquo; un nom de domaine en adresse IP, et les serveurs DNS autoritaires, ce type de serveur DNS &amp;ldquo;fait autorit√©&amp;rdquo; sur une zone DNS (une zone DNS c&amp;rsquo;est l&amp;rsquo;ensemble des enregistrement DNS, une sorte de base de donn√©e qui fait la relation entre nom de domaine et IP), c&amp;rsquo;est √† lui que vont se r√©f√©rer les serveurs DNS r√©solveurs pour associer nom de domaine et IP. √áa fait beaucoup de termes d&amp;rsquo;un coup üòÖ pour rendre √ßa plus clair voici un petit sch√©ma et les d√©finitions.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DNS&lt;/p&gt;
&lt;p&gt;Domain Name Syst√®me, protocole servant √† traduire un nom de domaine en une adresse IP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Zone DNS&lt;/p&gt;
&lt;p&gt;Ensemble des enregistrement DNS, sorte de base de donn√©e qui fait la relation etre nom de domaine et IP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Serveur DNS r√©curseur&lt;/p&gt;
&lt;p&gt;Serveur DNS &amp;ldquo;interm√©diaire&amp;rdquo; qui fait office de passerelle etre les serveurs DNS autoritaires et l&amp;rsquo;utilisateur&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Serveur DNS autoritaire&lt;/p&gt;
&lt;p&gt;Contient tout les enregistrement DNS d&amp;rsquo;une zone.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Frame 1" src="/static/img/les-bases-des-dns/schema1.png"&gt;&lt;/p&gt;
&lt;p&gt;Vous l&amp;rsquo;imaginez bien, les informations ne sont pas stock√©es tel-quel sur les serveurs DNS, ils sont stock√© sous forme d&amp;rsquo;enregistrement DNS, en voici un exemple comment√© tout droit tir√© de mon propre serveur DNS autoritaire.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;eban.bzh.   1800 IN A 89.234.156.60
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;eban.bzh.&lt;/code&gt; correspond au domaine que nous avons demand√©, vous vous demanderez s√ªrement, mais pourquoi y a-t-il un . √† la fin ? &lt;em&gt;Comment √ßa vous ne vous √™tes pas pos√© la question ? üòõ&lt;/em&gt; En fait, la r√©solution des DNS fonctionne sous forme de couches, voici un petit sch√©ma qui explique tout √ßa&lt;/p&gt;
&lt;p&gt;&lt;img alt="Frame 2" src="/static/img/les-bases-des-dns/schema2.png"&gt;&lt;/p&gt;
&lt;p&gt;Les serveurs DNS &amp;ldquo;root&amp;rdquo; correspondent √† la premi√®re couche, ils contiennent les records DNS pour tous les &lt;code&gt;TLD&lt;/code&gt; &lt;em&gt;Un TLD ? Qu√®saco ?&lt;/em&gt; Un TLD (Top level domain name) c&amp;rsquo;est en fait tout les &lt;code&gt;.&lt;/code&gt; quelque chose que vous rencontrez au quotidien, &lt;code&gt;bzh&lt;/code&gt; , &lt;code&gt;fr&lt;/code&gt;, &lt;code&gt;com&lt;/code&gt;, &lt;code&gt;be&lt;/code&gt; en sont quelques exemples. Les serveurs DNS root contiennent donc les record correspondants aux TLD. &lt;/p&gt;
&lt;p&gt;Les TLD, &lt;code&gt;bzh.&lt;/code&gt; dans notre exemple, contient quant √† lui les informations sur les domaines de sa zone, &lt;code&gt;*.bzh.&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;&lt;code&gt;eban.bzh.&lt;/code&gt; pour finir contient tout les records pour &lt;code&gt;eban.bzh.&lt;/code&gt; et tout ses sous-domaines (&lt;code&gt;git.eban.bzh.&lt;/code&gt;, &lt;code&gt;blog.eban.bzh.&lt;/code&gt;&amp;hellip;) cette &amp;ldquo;couche&amp;rdquo; est appel√©e &lt;code&gt;FQDN&lt;/code&gt; (Fully Qualified Domain Name). Pour rendre tout √ßa plus simple voici (√† nouveau :p) un petit sch√©ma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Frame 3" src="/static/img/les-bases-des-dns/schema3.png"&gt;&lt;/p&gt;
&lt;p&gt;Et voil√† le sch√©ma corrig√© d&amp;rsquo;une requ√™te DNS.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Frame 4" src="/static/img/les-bases-des-dns/schema4.png"&gt;&lt;/p&gt;
&lt;p&gt;Ces petites explications faites, continuons avec notre record &lt;code&gt;eban.bzh.    1800 IN A 89.234.156.60&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1800&lt;/code&gt; correspond au &lt;a href="https://www.wikiwand.com/fr/Time_to_Live"&gt;TTL&lt;/a&gt; (Time to Live) de ce record, c&amp;rsquo;est le temps en secondes apr√®s lequel le serveur DNS r√©solveur devra r√©interroger le serveur DNS autoritaire afin de mettre √† jour son cache. Le serveur DNS r√©solveur gardera donc ce record en cache pendant &lt;code&gt;1800 secondes&lt;/code&gt; puis r√©interrogera le serveur DNS autoritaire √† la prochaine requ√™te si ce temps est pass√©.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;IN A&lt;/code&gt; correspond au type du record, ici &lt;code&gt;A&lt;/code&gt; qui correspond √† un record qui renvoie une adresse IPv4, il existe de nombreux autres types de records, vous trouverez ci-dessous une liste des plus courants.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;89.234.156.60&lt;/code&gt; enfin correspond √† l&amp;rsquo;adresse IP qui nous est renvoy√©e.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;D√©finition&lt;/th&gt;
&lt;th&gt;Exemple&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;Renvoie une Ipv4&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN A 89.234.156.60&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AAAA&lt;/td&gt;
&lt;td&gt;Renvoie une Ipv6&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN AAAA 2a03:7220:8083:3c00::1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CNAME&lt;/td&gt;
&lt;td&gt;Renvoie vers un autre record&lt;/td&gt;
&lt;td&gt;&lt;code&gt;blog.eban.bzh. 1800 IN CNAME veil.eban.bzh.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NS&lt;/td&gt;
&lt;td&gt;Sp√©cifie les NS d&amp;rsquo;une zone&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN NS ns1.eban.bzh.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MX&lt;/td&gt;
&lt;td&gt;Indique les serveurs &lt;a href="https://www.wikiwand.com/fr/Simple_Mail_Transfer_Protocol"&gt;SMTP&lt;/a&gt; (mail) √† utiliser&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN MX 10 spool.mail.gandi.net.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOA&lt;/td&gt;
&lt;td&gt;Contient les informations suivantes, dans l&amp;rsquo;ordre : &lt;br&gt;  &lt;code&gt;Serveur DNS autoritaire principal&lt;/code&gt; &lt;br&gt; &lt;code&gt;Email de contact&lt;/code&gt;, le @ est remplac√© par un point, l&amp;rsquo;adresse ici est donc ns@eban.bzh &lt;br&gt; &lt;code&gt;Serial&lt;/code&gt; &amp;ldquo;version&amp;rdquo; de la zone &lt;br&gt; &lt;code&gt;Refresh&lt;/code&gt; d√©lai en secondes entre demandes d&amp;rsquo;update des slaves &lt;br&gt; &lt;code&gt;Retry&lt;/code&gt; d√©lai en secondes entre demandes d&amp;rsquo;update lors d&amp;rsquo;un fail &lt;br&gt; &lt;code&gt;Expire&lt;/code&gt; expiration de la zone &lt;br&gt; &lt;code&gt;Minimum TTL&lt;/code&gt; TTL pour les records inexistants&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 86400 IN SOA ns1.eban.bzh. ns.eban.bzh. 1618240745 10800 3600 604800 10800&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Si vous voulez essayer d&amp;rsquo;interroger les serveurs DNS √† la main, &lt;code&gt;dig(1)&lt;/code&gt; est un bon outil, il existe aussi la commande &lt;code&gt;nslookup&lt;/code&gt; pour les &lt;s&gt;h√©r√©tiques&lt;/s&gt; personnes sous Windows.&lt;/p&gt;
&lt;p&gt;Pour les plus curieux, voici un petit bonus :) Nous allons analyser ce qui se passe concr√®tement sur un r√©seau local lors d&amp;rsquo;un requ√™te DNS vers un serveur DNS r√©solveur.
Cette petite analyse est faite sur un syst√®me bas√© sur &lt;code&gt;linux&lt;/code&gt; mais est aussi valable pour Windows. J&amp;rsquo;ai donc captur√© le trafic sortant de ma machine avec un outil nomm√© &lt;code&gt;tcpdump(8)&lt;/code&gt;. Et voici ce que l&amp;rsquo;on obtient&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.272734&lt;/span&gt; &lt;span class="n"&gt;IP&lt;/span&gt; &lt;span class="mf"&gt;10.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;60081&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;proto&lt;/span&gt; &lt;span class="n"&gt;UDP&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;eban&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;bzh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;37&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.309725&lt;/span&gt; &lt;span class="n"&gt;IP&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mf"&gt;10.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;60081&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;proto&lt;/span&gt; &lt;span class="n"&gt;UDP&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="mf"&gt;89.234&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;156.60&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On voit donc que l&amp;rsquo;ordinateur va interroger le serveur DNS (ici sur &lt;code&gt;10.0.0.1&lt;/code&gt;) sur le port 53 qui est le port par d√©faut du protocole DNS pour lui demander un record &lt;code&gt;A&lt;/code&gt; pour la zone &lt;code&gt;eban.bzh.&lt;/code&gt;. On remarque aussi que ce protocole est bas√© sur le protocole &lt;code&gt;UDP&lt;/code&gt; que nous √©tudierons s√ªrement d&amp;rsquo;ici peu longtemps ;). Le serveur DNS r√©pond ensuite √† la demande en renvoyant le type de record (ici &lt;code&gt;A&lt;/code&gt;) et l&amp;rsquo;adresse IP demand√©e.&lt;/p&gt;
&lt;p&gt;Voil√†, c&amp;rsquo;en est finit pour ce premier post de la cat√©gorie Today I Learned, demain nous nous int√©resserons au fonctionnement √† la fonction d&amp;rsquo;un &lt;strong&gt;&lt;code&gt;registrar&lt;/code&gt;&lt;/strong&gt; ainsi qu&amp;rsquo;au fonctionnement des serveurs DNS autoritaires sur le principe de &lt;strong&gt;&lt;code&gt;slave/master&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 24 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-24:/les-bases-du-dns.html</guid><category>misc</category></item><item><title>SolarWinds, l'arbre qui cache la for√™t üëæ</title><link>https://ilearned.eu.org/solarwinds-larbre-qui-cache-la-foret.html</link><description>&lt;h2 id="avant-propos"&gt;Avant propos&lt;/h2&gt;
&lt;p&gt;Cet article a pour but de retracer les √©v√®nements √† propos de la r√©cente attaque dont SolarWinds a √©t√© victime, ces actualit√©s √©tant relativement r√©centes √† l&amp;rsquo;heure o√π j&amp;rsquo;√©cris cet article (07/02/2021) des mises √† jour seront s√ªrement apport√©es √† ce dernier.&lt;/p&gt;
&lt;h2 id="signal-dalarme"&gt;Signal d&amp;rsquo;alarme&lt;/h2&gt;
&lt;p&gt;Le 8 d√©cembre 2020, Kevin Mandia, PDG de la soci√©t√© FireEye poste un communiqu√© nomm√© &lt;a href="https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"&gt;FireEye Shares Details of Recent Cyber Attack, Actions to Protect Community&lt;/a&gt; dans lequel il informe que l&amp;rsquo;entreprise a √©t√© victime d&amp;rsquo;une cyberattaque de la part d&amp;rsquo;un &amp;ldquo;acteur hautement sophistiqu√©&amp;rdquo; et que ce dernier avait acc√©d√© √† leur r√©seau interne et vol√© un grand nombre d&amp;rsquo;outils de Red Team de la soci√©t√©. Ce communiqu√© fait aussi part du fait que &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sa discipline, sa s√©curit√© op√©rationnelle et ses techniques nous conduisent √† penser que [l&amp;rsquo;acteur malveillant derri√®re cette attaque] √©tait soutenu par un √©tat&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Matt Gorham le directeur adjoint de la division cyber du FBI indique dans la foul√©e&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Le FBI enqu√™te sur l&amp;rsquo;incident  et les premi√®res constatations montrent un acteur avec un haut niveau de sophistication conforme √† un √âtat-nation&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ce qui semble donc confirmer les dires de FireEye.&lt;/p&gt;
&lt;p&gt;Le 08 d√©cembre 2020 √† 20h11, dans &lt;a href="https://www.nytimes.com/2020/12/08/technology/fireeye-hacked-russians.html"&gt;un article&lt;/a&gt; le New York Times suppute que &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ce piratage soul√®ve la possibilit√© que les agences de renseignement russes aient vu un avantage √† monter l&amp;rsquo;attaque alors que l&amp;rsquo;attention am√©ricaine - y compris celle de FireEye - √©tait concentr√©e sur la s√©curisation du syst√®me des √©lections pr√©sidentielles.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sans pour autant apporter de preuve tangible.&lt;/p&gt;
&lt;p&gt;Le 13 d√©cembre 2020, coup de tonnerre, FireEye indique dans &lt;a href="https://www.fireeye.com/blog/products-and-services/2020/12/global-intrusion-campaign-leverages-software-supply-chain-compromise.html"&gt;ce communiqu√©&lt;/a&gt; que l&amp;rsquo;attaque qu&amp;rsquo;ils ont subi a √©t√© propag√©e par le syst√®me de mise √† jour d&amp;rsquo;Orion, un logiciel de gestion de r√©seau √©dit√© par SolarWinds, un cheval de Troie nomm√© Sunburst avait √©t√© ins√©r√© dans les version 2019.4 HF 5, 2020.2 et 2020.2 HF 1 d&amp;rsquo;Orion. Microsoft, les d√©partements am√©ricains du Commerce, du Tr√©sor, de l&amp;rsquo;√ânergie et plus encore ont d√©clar√© avoir √©t√© victimes de cette cyberattaque.&lt;/p&gt;
&lt;h2 id="un-peu-de-reverse-engineering"&gt;Un peu de reverse engineering&lt;/h2&gt;
&lt;p&gt;Ce travail d&amp;rsquo;analyse est en grande partie bas√© sur les travaux de &lt;a href="https://www.youtube.com/channel/UCND1KVdVt8A580SjdaS4cZg"&gt;Colin Hardy.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ce malware a √©t√© con√ßu pour √™tre le plus discret possible, lors de la premi√®re ex√©cution, le code malveillant commence par attendre 12 √† 14 jours avant de s&amp;rsquo;ex√©cuter. &lt;img alt="Screenshot de la fonction" src="https://i.postimg.cc/Y2ZNCqJc/Group-1-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Puis, il v√©rifie si le hostname de la machine contient &lt;em&gt;&amp;ldquo;solarwinds&amp;rdquo;&lt;/em&gt; ou &lt;em&gt;&amp;ldquo;test&amp;rdquo;&lt;/em&gt;, ou s&amp;rsquo;il correspond √† une liste de noms d&amp;rsquo;h√¥te qui contient, par exemple, swdev.dmz, swdev.local, on peut donc imaginer que l&amp;rsquo;attaquant a eu acc√®s au r√©seau local de SolarWinds et a pu collecter ces noms d&amp;rsquo;h√¥te&amp;hellip; Tout cela dans le but d&amp;rsquo;√©viter que le malware ne se d√©clenche sur un √©mulateur d&amp;rsquo;un AV et qu&amp;rsquo;il soit d√©tect√©. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Deuxi√®me screenshot" src="https://i.postimg.cc/d0V8cwKf/Group-2-6.png"&gt;&lt;/p&gt;
&lt;p&gt;Le malware va ensuite v√©rifier si, dans la liste des processus actifs sur la machine, un ou plusieurs correspond √† une liste qui contient les noms de processus d&amp;rsquo;antivirus (f-secure gatekeeper, carbonblack), de Command and Control (csagent, csfalconcontainer) - probablement afin de ne pas infecter une machine qui le serait d√©j√† - de logiciels de virtualisation (vboxservice) et m√™me d&amp;rsquo;analyse r√©seau (wireshark, tcpdump). Tout cela dans la but de rester le plus discret possible.&lt;/p&gt;
&lt;p&gt;Puis, un userID est cr√©√©, il est g√©n√©r√© √† partir du hostname de la machine, du MachineGuid et de l&amp;rsquo;adresse MAC&lt;/p&gt;
&lt;p&gt;&lt;a href="https://postimg.cc/SnbF8Dq2"&gt;&lt;img alt="Group-3.png" src="https://i.postimg.cc/htfSk55r/Group-3.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Le code malveillant fait ensuite appel au domaine &lt;em&gt;avsvmcloud.com&lt;/em&gt;, il g√©n√®re une URL avec la fonction suivante&lt;/p&gt;
&lt;p&gt;&lt;img alt="Group-5.png" src="https://i.postimg.cc/NFngF8yT/Group-5.png"&gt;&lt;/p&gt;
&lt;p&gt;Cette URL est compos√©e du domaine &lt;em&gt;eu-west-1.appsync-api.avsvmcloud.com&lt;/em&gt; (la &lt;em&gt;eu-west-1&lt;/em&gt; peut aussi √™tre &lt;em&gt;us-west-2&lt;/em&gt;, &lt;em&gt;us-east-1&lt;/em&gt; ou &lt;em&gt;us-east-2&lt;/em&gt;, le choix est fait al√©atoirement) et d&amp;rsquo;un sous domaine qui est g√©n√©r√© par la fonction DecryptShort √† partir du UserID g√©n√©r√© plus t√¥t et du hostname de la machine. C&amp;rsquo;est √† partir de ce sous-domaine que la machine communique avec le C2.&lt;/p&gt;
&lt;p&gt;Je n&amp;rsquo;irais pas plus loin dans l&amp;rsquo;analyse de ce malware, la partie communication avec le C2 √©tant relativement complexe et peu int√©ressante selon moi.&lt;/p&gt;
&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Le 10 juin 2021, le sp√©cialiste en cybers√©curit√© Kaspersky publie un article dans lequel il indique que la backdoor de Sunburst a beaucoup de similitude avec une autre nomm√©e Kazuar, une backdoor qui a √©t√© attribu√©e √† la Russie. Cette attaque pourrait donc etre appuy√©e par le FSB. Le 29 janvier 2021, Brandon Wales, dirigeant du CISA a r√©v√©l√© dans le &lt;a href="https://www.wsj.com/articles/suspected-russian-hack-extends-far-beyond-solarwinds-software-investigators-say-11611921601"&gt;Wall Street Journal&lt;/a&gt; que 30 % des victimes de l‚Äôattaque ne seraient pas clientes de SolarWinds, cette attaque pourrait donc etre seulement la face visible d&amp;rsquo;une grande op√©ration de cyberespionnage.&lt;/p&gt;
&lt;p&gt;Merci beaucoup d&amp;rsquo;avoir lu cette article, si vous avez des questions / remarques, n&amp;rsquo;h√©sitez pas √† m&amp;rsquo;en faire part &lt;a href="https://twitter.com/eban_non/status/1358429605376458752"&gt;ici&lt;/a&gt; ou par mail √† &lt;a href="mailto:contact+blog@eban.bzh"&gt;contact@eban.bzh&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 06 Feb 2021 00:00:00 +0100</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-02-06:/solarwinds-larbre-qui-cache-la-foret.html</guid><category>misc</category></item><item><title>WannaCry, le virus le plus d√©vastateur jamais cr√©√© üëæ</title><link>https://ilearned.eu.org/wannacry-le-virus-le-plus-devastateur-jamais-cree.html</link><description>&lt;p&gt;En mai 2017, un virus informatique du nom de WannaCry fait son apparition, il a infect√© quelques 300 000 ordinateurs dans plus de 150 pays ! Trois ans plus tard, revenons ensemble sur le ransomware le plus d√©vastateur jamais cr√©√©.&lt;/p&gt;
&lt;h3 id="la-genese-du-projet"&gt;La gen√®se du projet&lt;/h3&gt;
&lt;p&gt;Le 13 ao√ªt 2016, un groupe de hackers d√©nomm√© &lt;strong&gt;The Shadow Brokers&lt;/strong&gt; met en libre t√©l√©chargement sur Tumblr, GitHub et Pastebin de nombreux programmes d&amp;rsquo;espionnage et de piratage informatique de la NSA dont la faille de s√©curit√© EternalBlue, cette derni√®re permettant une RCE (remote code execution) sur un machine distante √† partir d&amp;rsquo;un partage SMBv1 (plus d&amp;rsquo;infos &lt;a href="https://docs.microsoft.com/fr-fr/security-updates/SecurityBulletins/2017/ms17-010"&gt;ici&lt;/a&gt;).
Cette vuln√©rabilit√© a √©t√© utilis√©e par le malware WannaCry afin de se propager.&lt;/p&gt;
&lt;p&gt;Ce virus aujourd&amp;rsquo;hui attribu√© a la Cor√©e du Nord et plus particuli√®rement au groupe Lazarus par de nombreux acteurs tel que le conseiller √† la s√©curit√© int√©rieure des USA &lt;a href="https://www.washingtonpost.com/world/national-security/us-set-to-declare-north-korea-carried-out-massive-wannacry-cyber-attack/2017/12/18/509deb1c-e446-11e7-a65d-1ac0fd7f097e_story.html"&gt;Tom Bossert&lt;/a&gt; ou le chercheur en cybers√©curit√© Matthieu Suiche interrog√© par &lt;a href="https://yewtu.be/watch?v=Mp3TH5PI6rc"&gt;Envoy√© Sp√©cial&lt;/a&gt; aurait donc √©t√© cr√©√© dans un but lucratif.&lt;/p&gt;
&lt;h3 id="fonctionnement-du-ransomware"&gt;Fonctionnement du Ransomware&lt;/h3&gt;
&lt;p&gt;Comme vu plus haut, WannaCry se propage tout seul (c&amp;rsquo;est un virus auto-r√©pliquant ou vers) gr√¢ce √† la faille de s√©curit√© EternalBlue. Une fois execut√© sur la machine, le logiciel se met √† chiffrer tout les fichiers personnels de l&amp;rsquo;ordinateur avec la m√©thode de chiffrement AES-128 (Une paire de cl√©s RSA est g√©n√©r√©e au lancement du programme, la cl√© priv√©e √©tait utilis√©e pour chiffrer les fichiers).
Apr√®s l&amp;rsquo;infection, une somme √©quivalente √† 300‚Ç¨ (voir 600‚Ç¨ en fonction des cas) en Bitcoin est demand√©e pour d√©chiffrer les fichiers. Il n&amp;rsquo;existe aucune preuve du fait que les personnes derri√®re WannaCry sont en capacit√© de d√©chiffrer les fichiers.
En effet, il est impossible pour les pirates de relier une transaction √† un ordinateur sp√©cifique. Une fois lanc√©, le logiciel installe aussi Tor sur la machine et essaie de se connecter aux serveurs C2 (&lt;a href="https://www.wikiwand.com/en/Command_and_control"&gt;Command and Control&lt;/a&gt;) suivants:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gx7ekbenv2riucmf.onion&lt;/li&gt;
&lt;li&gt;57g7spgrzlojinas.onion&lt;/li&gt;
&lt;li&gt;xxlvbrloxvriy2c5.onion&lt;/li&gt;
&lt;li&gt;76jdd2ir2embyv47.onion&lt;/li&gt;
&lt;li&gt;cwwnhwhlz52maqm7.onion&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="un-antidote"&gt;Un Antidote ?&lt;/h3&gt;
&lt;p&gt;Un groupe de trois experts en s√©curit√© informatique fran√ßais ont cr√©√© logiciel nomm√© &lt;a href="https://github.com/gentilkiwi/wanakiwi"&gt;Wanakiwi&lt;/a&gt;.
Cet outil permet de d√©chiffrer les fichiers qui l&amp;rsquo;ont √©t√© par WannaCry.
WannaCry utilise &lt;a href="https://fr.wikipedia.org/wiki/Cryptographic_Application_Programming_Interface"&gt;&lt;strong&gt;CryptoAPI&lt;/strong&gt;&lt;/a&gt; (les fonctions cryptographiques de Windows) pour g√©n√©rer les cl√©s de chiffrement, cependant ces fonctions inscrivent dans la RAM de l&amp;rsquo;ordinateur la cl√© priv√©e en claire, WanaKiwi va donc aller chercher dans la RAM des traces de la cl√© priv√©e utilis√©e pour chiffrer les donn√©es.&lt;/p&gt;
&lt;h3 id="comment-se-premunir-de-ce-type-dattaques-dans-le-futur"&gt;Comment se pr√©munir de ce type d&amp;rsquo;attaques dans le futur ?&lt;/h3&gt;
&lt;p&gt;On ne le dira jamais assez, mais n&amp;rsquo;ouvrez jamais de pi√®ces jointes venant d&amp;rsquo;un destinataire inconnu.
Mettez √† jour r√©guli√®rement votre OS, Microsoft propose une fonction tr√®s int√©ressante dans leur suite de s√©curit√© Windows Defender nomm√©e &lt;strong&gt;Dispositif d&amp;rsquo;acc√®s contr√¥l√© aux dossiers&lt;/strong&gt;.
Cet outil permet de contr√¥ler l&amp;rsquo;acc√®s aux fichiers syst√®mes de Windows et aux donn√©es personnelles des utilisateurs par des programmes, il fonctionne avec un syst√®me de withelist, chaque programme doit donc √™tre autoris√© manuellement pour pouvoir modifier ces fichiers (plus d&amp;rsquo;infos &lt;a href="https://docs.microsoft.com/fr-fr/windows/security/threat-protection/microsoft-defender-atp/evaluate-controlled-folder-access"&gt;ici&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, j&amp;rsquo;esp√®re qu&amp;rsquo;il vous aura plu.
Je suis preneur de vos retours :)&lt;/p&gt;
&lt;h3 id="remerciements"&gt;Remerciements&lt;/h3&gt;
&lt;p&gt;Merci √† xeway, 0xThxmxs, Shcanovishka, Sycorax, look, Ramle et Lancelot de m&amp;rsquo;avoir aid√© pour la relecture.&lt;/p&gt;
&lt;p&gt;Sources :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;https://fr.wikipedia.org/wiki/WannaCry&lt;/li&gt;
&lt;li&gt;https://fr.wikipedia.org/wiki/The_Shadow_Brokers&lt;/li&gt;
&lt;li&gt;https://docs.microsoft.com/fr-fr/security-updates/SecurityBulletins/2017/ms17-010&lt;/li&gt;
&lt;li&gt;https://www.washingtonpost.com/world/national-security/us-set-to-declare-north-korea-carried-out-massive-wannacry-cyber-attack/2017/12/18/509deb1c-e446-11e7-a65d-1ac0fd7f097e_story.html&lt;/li&gt;
&lt;li&gt;https://yewtu.be/watch?v=Mp3TH5PI6rc&lt;/li&gt;
&lt;li&gt;https://www.secureworks.com/research/wcry-ransomware-analysis&lt;/li&gt;
&lt;li&gt;https://fr.wikipedia.org/wiki/Cryptographic_Application_Programming_Interface&lt;/li&gt;
&lt;li&gt;https://docs.microsoft.com/fr-fr/windows/security/threat-protection/microsoft-defender-atp/evaluate-controlled-folder-access&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Wed, 12 Aug 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-08-12:/wannacry-le-virus-le-plus-devastateur-jamais-cree.html</guid><category>Culture Hack</category></item><item><title>Vos mots de passe sont ils vraiment s√©curis√©s üîê</title><link>https://ilearned.eu.org/vos-mots-de-passe-sont-ils-vraiment-securises.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui, nous utilisons des mots de passe partout, pour d√©verrouiller son t√©l√©phone, son ordinateur, son compte en banque et bien d&amp;rsquo;autres. Il parait donc indispensable d&amp;rsquo;avoir des mots de passe &lt;strong&gt;forts&lt;/strong&gt; pour s√©curiser ces comptes. Dans cet article nous allons donc nous pencher sur comment s√©curiser ces pr√©cieux s√©sames.&lt;/p&gt;
&lt;h3 id="1-avoir-des-mots-de-passe-differents"&gt;1) Avoir des mots de passe diff√©rents&lt;/h3&gt;
&lt;p&gt;Il est tr√®s important d&amp;rsquo;avoir des mots de passe diff√©rents sur chaque compte, imaginez un de vos comptes est pirat√© et votre mot de passe est r√©cup√©r√©, il suffirait donc au pirate de r√©utiliser ce m√™me mot de passe sur tous vos comptes pour y avoir acc√®s‚Ä¶ Etant donn√© qu&amp;rsquo;il est impossible de retenir des dizaines de mots de passe diff√©rents, les gestionnaires de mots de passe ont √©t√© invent√©s, ils permettent de n&amp;rsquo;avoir qu&amp;rsquo;√† retenir qu&amp;rsquo;un mot de passe, celui de votre gestionnaire ! Il existe de nombreux services de gestionnaires de mots de passe, je vous conseille :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="Nexcloud Passwords"&gt;https://apps.nextcloud.com/apps/passwords&lt;/a&gt; (Si vous avez un cloud Nextcloud, Nexcloud Passwords est le meilleur gestionnaire de mots de passe)&lt;/li&gt;
&lt;li&gt;&lt;a href="Bitwarden"&gt;https://bitwarden.com/&lt;/a&gt; (Tr√®s bon gestionnaire de mot de passe enti√®rement open source)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Il ne vous reste plus qu&amp;rsquo;√† installer un de ces services sur tout vos appareils.&lt;/p&gt;
&lt;h3 id="2-utiliser-des-mots-de-passe-vraiment-complexes"&gt;2) Utiliser des mots de passe vraiment complexes&lt;/h3&gt;
&lt;p&gt;Le meilleur moyen d&amp;rsquo;avoir des mots de passe s√©curis√©s est d&amp;rsquo;utiliser des caract√®res sp√©ciaux, traditionnellement on recommande d&amp;rsquo;utiliser des caract√®res comme @, $ ou *.
Il existe cependant une fa√ßon plus facile mais m√©connue d&amp;rsquo;avoir un mot de passe complexe facilement, &lt;strong&gt;les emojis&lt;/strong&gt;.
Beaucoup de services acceptent les emojis comme mot de passe ! En voici une liste :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Twitter ‚úÖ&lt;/li&gt;
&lt;li&gt;Github ‚úÖ&lt;/li&gt;
&lt;li&gt;Amazon ‚úÖ&lt;/li&gt;
&lt;li&gt;Discord ‚úÖ&lt;/li&gt;
&lt;li&gt;Protonmail ‚úÖ&lt;/li&gt;
&lt;li&gt;Spotify ‚úÖ&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On peut aussi, pour s√©curiser nos mots de passe, utiliser des caract√®res d&amp;rsquo;autres alphabets que l&amp;rsquo;alphabet latin, du cyrillique, des lettres de l&amp;rsquo;alphabet arabe ou m√™me des caract√®res en Japonais, Cor√©en, en bref tous les charact√®res de la table Unicode.&lt;/p&gt;
&lt;p&gt;Pour simplifier cette d√©marche de cr√©ation de mot de passe, j&amp;rsquo;ai fait un petit script Python sur mon Github disponible &lt;a href="https://github.com/ebanDev/unicode-password-generator"&gt;ici&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Il est enfin, tr√®s important d&amp;rsquo;activer l&amp;rsquo;A2F sur tous vos comptes, je recommande l&amp;rsquo;app Aegis pour mettre en place cette authentification √† deux facteurs.&lt;/p&gt;
&lt;p&gt;Il existe aussi des Cl√©s USB A2F ! Plus s√©curis√©es qu&amp;rsquo;une app sur mobile&amp;hellip; En voici une liste : &lt;a href="https://shutuptrackers.com/hardware/authentification.php"&gt;https://shutuptrackers.com/hardware/authentification.php&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="remerciements"&gt;Remerciements&lt;/h2&gt;
&lt;p&gt;Merci √† Erispar pour la relecture.&lt;/p&gt;
&lt;p&gt;Merci √† 0x66 de m&amp;rsquo;avoir donn√© l&amp;rsquo;id√©e de parler des Cl√©s USB A2F.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Wed, 22 Jul 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-07-22:/vos-mots-de-passe-sont-ils-vraiment-securises.html</guid><category>Tutoriel</category></item><item><title>Debuter dans l'infosec üë®‚Äçüíª</title><link>https://ilearned.eu.org/debuter-dans-linfosec.html</link><description>&lt;p&gt;Dans ce nouvel article, nous allons traiter de la fameuse question&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La s√©curit√© informatique, ca m&amp;rsquo;int√©resse, mais par o√π commencer ?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Par o√π commencer, la question est vaste mais voici un petit r√©sum√© des pr√©requis n√©cessaires pour commencer dans l&amp;rsquo;Infosec :&lt;/p&gt;
&lt;p&gt;Pour commencer dans le monde de la cybersecurit√©, il est recommand√© d&amp;rsquo;apprendre un language de scripting tel que le python ( voici un tr√®s bon cours venant du site de &lt;a href="https://zestedesavoir.com/tutoriels/799/apprendre-a-programmer-avec-python-3/"&gt;zeste de savoir&lt;/a&gt;, les bases des languages web sont aussi quasi-indispensables (&lt;a href="https://apprendre-html.3wa.fr/courses"&gt;ici&lt;/a&gt; ou &lt;a href="https://openclassrooms.com/fr/courses/918836-concevez-votre-site-web-avec-php-et-mysql"&gt;l√†&lt;/a&gt; vous pourrez trouver un cours sur le html, le css, le js ainsi que le php) il est aussi important d&amp;rsquo;apprendre les bases du fonctionnement des protocoles r√©seaux les plus courants (voici &lt;a href="https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip"&gt;un cours&lt;/a&gt; qui peut vous aider √† comprendre ces protocoles), pour finir, je recommanderais de passer sous une distribution Linux comme Ubuntu ou Arch pour les plus t√©m√©raires et de vous familiariser avec cet OS et au terminal linux.&lt;/p&gt;
&lt;p&gt;Une fois tout ces prerequis valid√©s, vous pourrez vous entrainer sur Root-Me&lt;/p&gt;
&lt;h2 id="specialisation"&gt;Sp√©cialisation&lt;/h2&gt;
&lt;p&gt;Apr√®s avoir d√©couvert les bases de ce milieu, vous pourrez vous sp√©cialiser dans certains domaines sp√©cifiques&lt;/p&gt;
&lt;h4 id="le-rereverse-engineering-retro-ingenerie"&gt;Le RE(Reverse Engineering / R√©tro Ing√©nerie)&lt;/h4&gt;
&lt;p&gt;Le Reverse Engineering est le fait d&amp;rsquo;√©tudier le fonctionnement d&amp;rsquo;un programme pour en comprendre le fonctionnement sans avoir le code source de celui-ci.
Pour d√©buter dans ce domaine, il est indispensable de connaitre le &lt;a href="https://zestedesavoir.com/tutoriels/755/le-langage-c-1/"&gt;language C&lt;/a&gt; ainsi que de &lt;a href="https://www.youtube.com/watch?v=yxzUi8MdOAA&amp;amp;list=PLcT0DaY68xGzzmj47WSbb8XaIwWFjVlKz"&gt;l&amp;rsquo;assembleur&lt;/a&gt; (de pr√©f√©rence x86_64).
Vous pourrez alors vous entra√Æner sur des crackme, si vous voulez de l&amp;rsquo;aide ou seulement discuter de ces sujets, je vous invite √† rejoindre l&amp;rsquo;un des serveurs discord list√©s ci-dessous.&lt;/p&gt;
&lt;h4 id="les-ctfs"&gt;Les CTFs&lt;/h4&gt;
&lt;p&gt;Les CTFs consistent en un machine faite pour √™tre &lt;em&gt;pirat√©e&lt;/em&gt;, le but est de devenir administrateur (ou &lt;em&gt;root&lt;/em&gt;) de la machine en utilisant plusieurs failles informatiques. Pour vous entrainer √† cela, je vous invite √† aller sur &lt;a href="https://hackthebox.eu"&gt;HackTheBox&lt;/a&gt; ainsi que sur &lt;a href="https://vulnhub.com"&gt;Vulnhub&lt;/a&gt;.
Comme dans le domaine du reverse engineering, si vous avez besoin d&amp;rsquo;aide pour le CTF n&amp;rsquo;h√©sitez pas √† rejoindre un serveur discord, parfois les plateformes proposent le leur pour les haxors.&lt;/p&gt;
&lt;h2 id="bonus-ressources"&gt;Bonus : Ressources&lt;/h2&gt;
&lt;p&gt;Voici une liste non exhaustive de ressources qui pourraient vous aider :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/wapiflapi/exrs"&gt;https://github.com/wapiflapi/exrs&lt;/a&gt; (Exercices de RE)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://root-me.org/"&gt;https://root-me.org/&lt;/a&gt; (Challenges toutes cat√©gories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.newbiecontest.org/"&gt;https://www.newbiecontest.org/&lt;/a&gt; (Challenges toutes cat√©gories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hackthebox.eu/"&gt;https://www.hackthebox.eu/&lt;/a&gt; (Challenges, plus orient√© test d&amp;rsquo;intrusion)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.vulnhub.com/"&gt;https://www.vulnhub.com/&lt;/a&gt; (VM vuln√©rables)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.dailysecurity.fr/"&gt;https://www.dailysecurity.fr/&lt;/a&gt; (Blog de Geluchat)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://beta.hackndo.com/"&gt;https://beta.hackndo.com/&lt;/a&gt; (Blog de pixis)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hacktion.be/"&gt;https://www.hacktion.be/&lt;/a&gt; (Blog de Que20)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inf0sec.fr/"&gt;https://inf0sec.fr/&lt;/a&gt; (Blog de Unknow101 orient√© test d&amp;rsquo;intrusion windows)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://sideway.re/"&gt;https://sideway.re/&lt;/a&gt; (Blog de @SideWay&amp;rsquo;CSS )&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inshallhack.org/"&gt;https://inshallhack.org/&lt;/a&gt; (Blog de l&amp;rsquo;√©quipe fran√ßaise de CTF [Inshall&amp;rsquo;hack] (https://ctftime.org/team/44256))&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.google.fr/"&gt;https://www.google.fr/&lt;/a&gt; (RTFM, la base avant toute question.)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://exploit.education/"&gt;http://exploit.education/&lt;/a&gt; (Un bon site pour d√©buter en pwn)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/heAw9mZ"&gt;Rainbow&lt;/a&gt; (Serveur discord parlant d&amp;rsquo;infosec mais aussi de programmation.)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/YEy6aZ4"&gt;inf0sec&lt;/a&gt; (Serveur discord de [@inf0sec1] (https://twitter.com/inf0sec1) parlant de cybers√©curit√©)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/gFws9jH"&gt;ret2school&lt;/a&gt; (Serveur discord de &lt;a href="https://twitter.com/nasm_re"&gt;@nasm_re&lt;/a&gt; et de l&amp;rsquo;√©quipe de CTF, &lt;a href="https://twitter.com/ret2school_fr"&gt;ret2school&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id="remerciements"&gt;Remerciements :&lt;/h5&gt;
&lt;p&gt;Merci √† SoEasY de m&amp;rsquo;avoir aid√© pour la d√©finition du RE.&lt;/p&gt;
&lt;p&gt;Merci √† MorpheusH3x pour la liste des ressources.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 10 Jul 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-07-10:/debuter-dans-linfosec.html</guid><category>misc</category></item><item><title>Getting started in infosec</title><link>https://ilearned.eu.org/getting-started-in-infosec.html</link><description>&lt;p&gt;In this new article, we will deal with the famous question&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;I&amp;rsquo;m interested in computer security, but where to start?&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Where to start, the question is vast but here is a small summary of the prerequisites necessary to start in Infosec :&lt;/p&gt;
&lt;p&gt;To start in the world of cybersecurity, it is recommended to learn a scripting language such as Python (here is a very good course coming from the site of &lt;a href="https://zestedesavoir.com/tutoriels/799/apprendre-a-programmer-avec-python-3/"&gt;zeste de savoir (fr)&lt;/a&gt;), the basics of web languages are also almost essential (&lt;a href="https://apprendre-html.3wa.fr/courses"&gt;here (fr)&lt;/a&gt; or &lt;a href="https://openclassrooms.com/fr/courses/918836-concevez-votre-site-web-avec-php-et-mysql"&gt;there (fr)&lt;/a&gt; you can find a course on html, css, js and php ) it is also important to learn the basics of how the most common network protocols work (&lt;a href="https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip"&gt;here (fr)&lt;/a&gt; is a course that can help you understand these protocols). Finally, I would recommend to switch to a Linux distribution like Ubuntu or Arch for the more adventurous and to familiarize yourself with this OS and the Linux terminal.&lt;/p&gt;
&lt;p&gt;Once all these prerequisites are validated, you can train on Root-Me.&lt;/p&gt;
&lt;h2 id="specialization"&gt;Specialization :&lt;/h2&gt;
&lt;p&gt;After having discovered the basics of this field, you will be able to specialize in certain specific areas.&lt;/p&gt;
&lt;h4 id="the-re-reverse-engineering"&gt;The RE (Reverse Engineering) :&lt;/h4&gt;
&lt;p&gt;Reverse Engineering is the fact of studying the functioning of a program to understand its operation without having the source code of it.
To start in this field, it is essential to know the C language &lt;a href="https://zestedesavoir.com/tutoriels/755/le-langage-c-1/"&gt;ressource (fr)&lt;/a&gt; and assembler (preferably x86_64) &lt;a href="https://www.youtube.com/watch?v=yxzUi8MdOAA&amp;amp;list=PLcT0DaY68xGzzmj47WSbb8XaIwWFjVlKz"&gt;ressource (fr)&lt;/a&gt;.
You will then be able to train on crackme, if you want help or just discuss these topics, I invite you to join one of the discord servers listed below.&lt;/p&gt;
&lt;h4 id="ctfs"&gt;CTFs :&lt;/h4&gt;
&lt;p&gt;The CTFs consist in a machine made to be &lt;em&gt;hacked&lt;/em&gt;, the goal is to become administrator (or &lt;em&gt;root&lt;/em&gt;) of the machine by using several computer flaws. To practice this, I invite you to go on &lt;a href="https://hackthebox.eu"&gt;HackTheBox&lt;/a&gt; and on &lt;a href="https://vulnhub.com"&gt;Vulnhub&lt;/a&gt;.
As in the field of reverse engineering, if you need help for CTF do not hesitate to join a discord server, sometimes platforms propose their own for haxors.&lt;/p&gt;
&lt;h2 id="bonus-resources"&gt;Bonus : Resources&lt;/h2&gt;
&lt;p&gt;Here is a non-exhaustive list of resources that might help you:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/wapiflapi/exrs"&gt;https://github.com/wapiflapi/exrs&lt;/a&gt; (RE exercises)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://root-me.org/"&gt;https://root-me.org/&lt;/a&gt; (Challenges: all categories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.newbiecontest.org/"&gt;https://www.newbiecontest.org/&lt;/a&gt; (Challenges: all categories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hackthebox.eu/"&gt;https://www.hackthebox.eu/&lt;/a&gt; (Rooms penetration test oriented)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.vulnhub.com/"&gt;https://www.vulnhub.com/&lt;/a&gt; (Vulnerable VMs, like hackthebox but locally)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.dailysecurity.fr/"&gt;https://www.dailysecurity.fr/&lt;/a&gt; (Geluchat&amp;rsquo;s blog)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://beta.hackndo.com/"&gt;https://beta.hackndo.com/&lt;/a&gt; (pixis&amp;rsquo;s blog)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hacktion.be/"&gt;https://www.hacktion.be/&lt;/a&gt; (Que20&amp;rsquo;s blog)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inf0sec.fr/"&gt;https://inf0sec.fr/&lt;/a&gt; (Unknow101&amp;rsquo;s blog about windows penetration testing)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://sideway.re/"&gt;https://sideway.re/&lt;/a&gt; (Blog of @SideWay&amp;rsquo;CSS )&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inshallhack.org/"&gt;https://inshallhack.org/&lt;/a&gt; (Blog of the french CTF team &lt;a href="https://ctftime.org/team/44256"&gt;Inshall&amp;rsquo;hack&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.google.fr/"&gt;https://www.google.fr/&lt;/a&gt; (RTFM, the base before any question)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://exploit.education/"&gt;http://exploit.education/&lt;/a&gt; (A site that will teach you the basics in pwn)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://cryptopals.com/"&gt;https://cryptopals.com/&lt;/a&gt; (A site that will teach you the basics in crypto)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/heAw9mZ"&gt;Rainbow&lt;/a&gt; (Discord server talking about infosec but also programming)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/YEy6aZ4"&gt;inf0sec&lt;/a&gt; (Discord server from &lt;a href="https://twitter.com/inf0sec1"&gt;@inf0sec1&lt;/a&gt; talking about cybersecurity)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/gFws9jH"&gt;ret2school&lt;/a&gt; (Discord server from &lt;a href="https://twitter.com/nasm_re"&gt;@nasm_re&lt;/a&gt; and the &lt;a href="https://twitter.com/ret2school_fr"&gt;ret2school team&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id="acknowledgements"&gt;Acknowledgements :&lt;/h5&gt;
&lt;p&gt;Thanks to &lt;a href="https://twitter.com/0xSoEasY"&gt;SoEasY&lt;/a&gt; for helping me with the RE definition.&lt;/p&gt;
&lt;p&gt;Thanks to &lt;a href="https://twitter.com/MorpheusH3x"&gt;MorpheusH3x&lt;/a&gt; for the list of resources.&lt;/p&gt;
&lt;p&gt;Translated by &lt;a href="https://twitter.com/MorpheusH3x"&gt;MorpheusH3x&lt;/a&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 10 Jul 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-07-10:/getting-started-in-infosec.html</guid><category>i18n</category></item><item><title>AdGuard Home, La s√©curit√© et la vie priv√©e dans votre maison üõ°Ô∏è</title><link>https://ilearned.eu.org/adguard-home-la-securite-et-la-vie-privee-dans-votre-maison.html</link><description>&lt;p&gt;Dans ce nouvel article, nous allons traiter du logiciel open-source AdGuard Home qui est un bloqueur de publicit√©s et de trackers qui int√®gre des fonctions suppl√©mentaires tel que le DOH qui permet de chiffrer les requ√™tes DNS de votre r√©seau Wi-Fi !&lt;/p&gt;
&lt;h2 id="a-quoi-bon"&gt;A quoi bon ?&lt;/h2&gt;
&lt;p&gt;Il est vrai que l&amp;rsquo;on pourrait se demander √† quoi pourrait servir un tel outil. Laissez moi vous expliquer : quand vous poss√©dez un appareil connect√© √† Internet (t√©l√©phone, tablette, ordinateur, etc.), des trackers enregistrent votre activit√© afin de revendre ces donn√©es √† des annonceurs leur permettant ainsi de faire de la publicit√© cibl√©e. Ces donn√©es peuvent r√©v√©ler beaucoup sur vous, tel que votre localisation, votre situation familiale, votre √©tat de sant√©, etc. C&amp;rsquo;est pourquoi il est tr√®s important de se prot√©ger de ces trackers.&lt;/p&gt;
&lt;h2 id="prerequis"&gt;Pr√©requis&lt;/h2&gt;
&lt;p&gt;Pour ce tutoriel, vous aurez besoin :&lt;/p&gt;
&lt;p&gt;‚Ä¢ D&amp;rsquo;un Raspberry Pi disposant d&amp;rsquo;un module WiFi&lt;br&gt;
‚Ä¢ D&amp;rsquo;un c√¢ble RJ45 (Ethernet)&lt;/p&gt;
&lt;p&gt;Et c&amp;rsquo;est tout !&lt;/p&gt;
&lt;h2 id="tutoriel"&gt;Tutoriel&lt;/h2&gt;
&lt;p&gt;Dans ce tutoriel nous allons donc voir l&amp;rsquo;installation de RaspAP qui permet de faire un point d&amp;rsquo;acc√®s wifi √† partir d&amp;rsquo;un cable Ethernet branch√© au Raspberry Pi puis nous verrons l&amp;rsquo;installation de AdGuard Home ainsi que l&amp;rsquo;activation de la compatibilit√© avec le DOH (DNS over HTTPS qui permet de chiffrer vos requetes DNS).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1) Installation de RaspAP&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pour d√©buter l&amp;rsquo;installation de RaspAP, effectuez la commande suivante sur votre Raspberry Pi&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sudo apt update &amp;amp;&amp;amp; sudo apt upgrade -y &amp;amp;&amp;amp; wget -q https://git.io/voEUQ -O /tmp/raspap &amp;amp;&amp;amp; bash /tmp/raspap&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;L&amp;rsquo;installateur va s&amp;rsquo;ouvrir, il vous demande d&amp;rsquo;abord dans quel r√©pertoire vous souhaitez installer RaspAP √† moins que vous ne souhaitez le changer, laissez le r√©pertoire de base, r√©pondre oui √† tout (y) sauf au moment o√π il vous sera propos√© d&amp;rsquo;installer le bloqueur de publicit√©s, nous n&amp;rsquo;utiliserons pas celui int√©gr√© √† RaspAP car il est moins performant que AdGuard Home.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Premi√®re Image" src="https://i.postimg.cc/gkfgjY3z/raspap-02.png"&gt;&lt;/p&gt;
&lt;p&gt;√Ä la derni√®re √©tape, l&amp;rsquo;installateur vous demandera si vous souhaitez red√©marrer le Raspberry Pi, r√©pondez oui.&lt;br&gt;
Une fois votre Raspberry Pi red√©marr√©, vous pourrez vous rendre sur l&amp;rsquo;interface web de votre Raspberry Pi, √† noter que les identifiants de connexi sont &amp;ldquo;admin&amp;rdquo;/&amp;rdquo;secret&amp;rdquo;. Pour y acc√©der, tapez juste l&amp;rsquo;adresse IP locale de votre Raspberry Pi dans votre navigateur, et depuis cette interface, vous pourrez change le SSID (nom du r√©seau), les informations de connexion, etc. Nous avons donc finit d&amp;rsquo;installer RaspAP, aucune configuration de ce dernier n&amp;rsquo;est n√©cessaire pour l&amp;rsquo;instant.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2) Installation de AdGuard Home&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pour commencer l&amp;rsquo;installation de AdGuard Home, entrez la commande suivante sur votre Raspberry Pi&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;wget &lt;a href="https://static.adguard.com/adguardhome/release/AdGuardHome_linux_arm.tar.gz"&gt;https://static.adguard.com/adguardhome/release/AdGuardHome_linux_arm.tar.gz&lt;/a&gt; &amp;amp;&amp;amp; tar -xf AdGuardHome_linux_arm.tar.gz &amp;amp;&amp;amp; cd AdGuardHome &amp;amp;&amp;amp; sudo ./AdGuardHome -s install&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Rendez-vous ensuite sur l&amp;rsquo;interface d&amp;rsquo;installation qui se situe √† l&amp;rsquo;adresse.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://IPLOCALEDEMONRASPBERRYPI:3000&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Apr√®s avoir cliqu√© sur &amp;ldquo;C&amp;rsquo;est parti&amp;rdquo;, dans la partie &amp;ldquo;Interface web administrateur&amp;rdquo;, laissez &amp;ldquo;Toutes les interfaces&amp;rdquo; et changez le port pour, disons par exemple, 1234. Dans la partie &amp;ldquo;Serveur DNS&amp;rdquo;, choisissez 127.0.0.1 √† la place de &amp;ldquo;Toutes les interfaces&amp;rdquo; et mettez 5300 dans la case port.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Seconde Image" src="https://i.postimg.cc/cCDkJw06/ad-guard.png"&gt;&lt;/p&gt;
&lt;p&gt;Cliquez sur le bouton Suivant puis renseignez vos informations de connexion √† l&amp;rsquo;interface d&amp;rsquo;administration&lt;/p&gt;
&lt;p&gt;&lt;img alt="Troisi√®me Image" src="https://i.postimg.cc/bYDjGw4W/Screenshot-2020-05-09-Setup-Ad-Guard-Home.png"&gt;&lt;/p&gt;
&lt;p&gt;Une fois cela fait, cliquez sur Suivant puis &amp;ldquo;ouvrir le Tableau de bord&amp;rdquo;, entrez vos identifiants de connexions puis allez dans la section Filtres puis Listes de blocage DNS. Cochez toutes les cases et ajoutez la liste :&lt;/p&gt;
&lt;p&gt;&lt;code&gt;"https://raw.githubusercontent.com/hl2guide/Filterlist-for-AdGuard/master/filter_blocklist.txt"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;en cliquant sur la bouton Ajouter liste de blocage.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Quatri√®me Image" src="https://i.postimg.cc/fR6dNyns/Screenshot-2020-05-09-Ad-Guard-Home.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour finaliser l&amp;rsquo;installation, rendez-vous sur l&amp;rsquo;interface d&amp;rsquo;administration de RaspAP, les identifiants de connexion sont par d√©faut &amp;ldquo;admin&amp;rdquo;/&amp;rdquo;secret&amp;rdquo;. Puis dans la section DHCP server, cliquez sur Advanced, puis cochez la case &amp;rdquo; Only ever query DNS servers configured below&amp;rdquo;. Renseignez ensuite &amp;ldquo;127.0.0.1#5300&amp;rdquo; dans la case Add upstream DNS server, puis cliquez sur le bouton +&lt;/p&gt;
&lt;p&gt;&lt;img alt="Cinqui√®me Image" src="https://i.postimg.cc/8Pdk5C6D/Screenshot-2020-05-09-Rasp-AP-Wi-Fi-Configuration-Portal.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour finir, red√©marrez le Point D&amp;rsquo;acc√®s en cliquant sur le bouton Restart hotspot dans la section &amp;ldquo;Hotspot&amp;rdquo;. Et voil√† ! L&amp;rsquo;installation de RaspAP et de AdGuard Home est termin√©e !&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3) Bonus : Mise en place du DOH ainsi que d&amp;rsquo;un VPN&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pour mettre en place le DOH, allez sur l&amp;rsquo;interface d&amp;rsquo;administration de AdGuard Home puis dans param√®tres, param√®tres DNS, renseignez le DOH de votre choix, dans mon cas, j&amp;rsquo;ai choisi&lt;/p&gt;
&lt;p&gt;&lt;code&gt;https://doh.powerdns.org/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sixi√®me Image" src="https://i.postimg.cc/gJ5jvBzW/Screenshot-2020-05-09-Ad-Guard-Home-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Vos requ√™tes DNS sont maintenant chiffr√©es !&lt;/p&gt;
&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Et voil√† ! C&amp;rsquo;est termin√©, vous pouvez maintenant naviguer sur internet sans publicit√©s ni trackeurs ! Veillez √† bien modifier le mot de passe ainsi que le SSID de votre r√©seau wifi ! Vous n&amp;rsquo;avez plus qu&amp;rsquo;√† connecter tout les appareils de votre maison au nouveau r√©seau Wi-Fi et ils seront prot√©g√©s √† leur tour ? Si vous avez des questions, n&amp;rsquo;h√©sitez pas √† me contacter sur twitter @eban_non ou par mail ebandev@protonmail.com.&lt;/p&gt;
&lt;p&gt;Merci √† Azgar de m&amp;rsquo;avoir aid√© pour la relecture&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Mon, 15 Jun 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-06-15:/adguard-home-la-securite-et-la-vie-privee-dans-votre-maison.html</guid><category>misc</category></item></channel></rss>