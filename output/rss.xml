<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0"><channel><title>I Learned</title><link>https://ilearned.eu.org/</link><description></description><lastBuildDate>Sat, 31 Jul 2021 00:00:00 +0200</lastBuildDate><item><title>La puce TPM, quelle est son utilité ?</title><link>https://ilearned.eu.org/tpm.html</link><description>&lt;p&gt;Il y a moins d&amp;rsquo;un mois Microsoft annonçait officiellement Windows 11. Cette nouvelle version à fait débat, et pour cause, beaucoup (trop) d&amp;rsquo;appareils sont incompatibles avec cette version de Windows, une des raisons avancées par Microsoft est le support manquant de TPM 2.0. Mais au fond, Qu&amp;rsquo;est ce que TPM et quels sont les changements apporté par la deuxième version de TPM.&lt;/p&gt;
&lt;p&gt;TPM est l&amp;rsquo;acronyme de &amp;ldquo;Trusted Platform Module&amp;rdquo;, c&amp;rsquo;est une puce qui permet de faire des opérations cryptographiques, ou de garder des secrets.&lt;/p&gt;
&lt;p&gt;Cette puce est principalement faite pour générer des clés RSA – RSA est un algorithme de cryptographie asymétrique – stocker ces clés et gérer l&amp;rsquo;accès à ces dites clés. Cette puce est aussi utilisée pour &lt;a href="https://ilearned.eu.org/secure_boot.html"&gt;Secure Boot&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Une puce TPM possède une clé RSA qui permet de l&amp;rsquo;authentifier, cette clé ne peut en théorie pas sortir de la puce.&lt;/p&gt;
&lt;p&gt;Un des usages principaux de TPM est de stocker différents secrets, pour par exemple chiffrer un disque avec une technologie comme BitLocker sous Windows, ou Luks sous Linux. La sécurité du stockage de la clé pourrait poser question, comment s&amp;rsquo;assurer qu&amp;rsquo;un autre système ne puisse pas avoir accès a la clé de déchiffrement ? Afin d&amp;rsquo;améliorer la sécurité de cette puce, on peut configurer un PIN à entrer pour accéder à la clé de déchiffrement.&lt;/p&gt;
&lt;p&gt;Si la clé n&amp;rsquo;est pas protégée par un PIN, la puce laissera quand même l&amp;rsquo;accès uniquement au système qui a crée la clé, même si dans certains cas particulier la vérification ne se fait pas correctement.&lt;/p&gt;
&lt;p&gt;Comme faille de sécurité dans TPM on peut notamment citer &lt;a href="https://tpm.fail"&gt;TPM-FAIL&lt;/a&gt; qui permet simplement d&amp;rsquo;extraire la clé privée. Un autre problème de sécurité que présente TPM est qu&amp;rsquo;avec un accès physique il est possible d&amp;rsquo;espionner ce que la puce fait et donc d&amp;rsquo;en extraire des données confidentielles, si vous souhaitez en savoir plus, la page Wikipedia sur TPM cite d&amp;rsquo;autres failles de sécurité : &lt;a href="https://en.wikipedia.org/wiki/Trusted_Platform_Module#Attacks"&gt;https://en.wikipedia.org/wiki/Trusted_Platform_Module#Attacks&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Un autre problème de TPM qui est très répandu c&amp;rsquo;est le vecteur d&amp;rsquo;attaque physique, en observant directement sur les bus de la puce avec du matériel spécifique il est possible d&amp;rsquo;extraire les clés de la puce, ce type d&amp;rsquo;attaque se nomme &lt;a href="https://en.wikipedia.org/wiki/Cold_boot_attack"&gt;cold boot atttack&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;La puce TPM est divisée en plusieurs partie qu&amp;rsquo;on nomme des Platform configuration Registers qui ont plusieurs utilité, comme le stockage de clé, firmware etc.&lt;/p&gt;
&lt;p&gt;TPM a connu des évolutions, je vais me concentrer ici seulement sur la version 1.2 et 2 de TPM. Une des avancées majeure est l&amp;rsquo;implémentation des courbes elliptiques sur la version 2, les algorithmes de chiffrement à courbe elliptique sont des algorithmes de cryptographie asymétrique, concurrents à RSA
notamment, qui au lieu d&amp;rsquo;utiliser les nombres premiers utilisent des courbes elliptiques, l&amp;rsquo;avantage comparé à RSA c&amp;rsquo;est leur résistance supposée aux ordinateurs quantiques. Une autre avancée est le support de SHA256 qui est bien plus résistant que SHA1 à différent type d&amp;rsquo;attaque.&lt;/p&gt;
&lt;p&gt;À mon avis, le fait pour Windows 11 de forcer TPM est relativement inutile, en effet BitLocker n&amp;rsquo;est pas activé par défaut, et &lt;a href="https://ilearned.eu.org/secure_boot.html"&gt;Secure Boot&lt;/a&gt; ne dépends pas forcément de TPM. Le mieux serait de recommander sans pour autant forcer. TPM reste très intéressant pour éviter de taper un mot de passe au boot, qui en plus de prendre du temps peut être vu par un attaquant, et permettre de vérifier l’intégrité du démarrage en séparant la gestion des clés du bios (l&amp;rsquo;avantage est que pour changer le jeu de clés publiques il faut effacer la clé de déchiffrement). Un des soucis les plus important de TPM reste que la plupart des implémentations ne sont pas libres, une backdoor pourrait donc y être inséré par le constructeur.&lt;/p&gt;
&lt;p&gt;Une alternative à TPM peut être des puces plus spécifique comme la puce titan de google, ou T2, mais ces deux puces restent malheureusement propriétaires.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sat, 31 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-31:/tpm.html</guid><category>misc</category></item><item><title>Comment faire une autorité de certification (CA) SSH ?</title><link>https://ilearned.eu.org/ca-ssh.html</link><description>&lt;p&gt;SSH est un protocole très répandu sur internet, il est utilisé par des millions d&amp;rsquo;entreprises et particuliers chaque jour, mais bien souvent de façon peu sécurisée. Vous connaissez peut-être les clés SSH qui permettent une meilleure sécurité que les mots de passe, mais ces clés posent un problème, et notamment en entreprise, imaginez une entreprise avec 500 ingénieurs, il faudrait, sur chaque serveur SSH, mettre les 500 clés publiques des 500 ingénieurs ! Pour remédier à cela il existe une solution que nous allons étudier dans cet article, les autorités de certification SSH.&lt;/p&gt;
&lt;h1 id="la-theorie"&gt;La théorie&lt;/h1&gt;
&lt;p&gt;Le système de certificats de SSH est relativement similaire à celui de TLS (x509), une première paire de clés publiques/privées est générée, elle servira d&amp;rsquo;&lt;strong&gt;autorité de certification&lt;/strong&gt;, le clé privée de cette autorité de certification doit bien évidemment rester ultra confidentielle. On va ensuite générer une autre paire de clé sur chaque client. On pourra ensuite, avec la clé privée de notre autorité de certification, signer la publique des clients afin de générer un certificat. Ainsi, n&amp;rsquo;importe quel certificat signé par notre autorité de certification peut être considérée comme &amp;ldquo;de confiance&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Principe d'une autorité de certification" src="/static/img/ca-ssh/CA_principe(1).png"&gt;&lt;/p&gt;
&lt;h1 id="signer-les-cles-hote"&gt;Signer les clés hôte&lt;/h1&gt;
&lt;p&gt;Lors de la première connexion à un serveur SSH, le serveur envoie sa clé publique (appelée clé hôte) au client et le client doit approuver, ou non, l&amp;rsquo;authenticité de la clé envoyée par le serveur, c&amp;rsquo;est le fameux message&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;The authenticity of host &lt;span class="s1"&gt;&amp;#39;XXXXX&amp;#39;&lt;/span&gt; can&lt;span class="err"&gt;&amp;#39;&lt;/span&gt;t be established.
ED25519 key fingerprint is SHA256:JxfJl38mBVY2jX0h/LWDuB1OtgYfgLBr3nJw/lw5GFE.
This key is not known by any other names
Are you sure you want to &lt;span class="k"&gt;continue&lt;/span&gt; connecting &lt;span class="o"&gt;(&lt;/span&gt;yes/no/&lt;span class="o"&gt;[&lt;/span&gt;fingerprint&lt;span class="o"&gt;])&lt;/span&gt;? 
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Nous avons tous pour (mauvaise) habitude de simplement entrer &lt;code&gt;yes&lt;/code&gt; sans se poser plus de questions, mais cette habitude est très dangereuse, un attaquant pourrait usurper le serveur SSH auquel nous essayons de nous connecter ! Pour remédier à cela il existe plusieurs solutions comme &lt;a href="https://fr.wikipedia.org/wiki/Enregistrement_DNS_SSHFP"&gt;SSHFP&lt;/a&gt; (qui est relativement similaire à &lt;a href="https://ilearned.eu.org/dane.html"&gt;TLSA&lt;/a&gt;, mais avec SSH) ou les autorités de certification (CA) c&amp;rsquo;est ce que nous allons détailler ici.&lt;/p&gt;
&lt;p&gt;La première étape est donc de créer une paire de clés pour notre autorité de certification avec la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;keygen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;a&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1000&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;t&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ed25519&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;f&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ca&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;id_ed25519&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="ss"&gt;&amp;quot;contact+ca@eban.bzh&amp;quot;&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;L&amp;rsquo;option &lt;code&gt;-a&lt;/code&gt; indique le nombre de tours KDF (fonction de dérivation de la clé), plus ce nombre est élevé, plus la vérification du mot de passe sera lente, mais plus la clé sera résistante au bruteforce.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-t&lt;/code&gt; indique l&amp;rsquo;algorithme à utiliser pour la clé, ici c&amp;rsquo;est ed25519, l&amp;rsquo;algorithme de chiffrement &lt;a href="https://nbeguier.medium.com/a-real-world-comparison-of-the-ssh-key-algorithms-b26b0b31bfd9"&gt;le plus sécurisé à ce jour&lt;/a&gt; supporté par SSH.&lt;/p&gt;
&lt;p&gt;Une fois cette première paire de clé créée, nous allons pouvoir l&amp;rsquo;utiliser pour signer les clés hôtes publiques de nos serveurs SSH, la première étape est donc d&amp;rsquo;aller cherche ces clés hôtes, elles sont, sur chaque serveur SSH, dans le répertoire /etc/ssh, ici je ne génèrerait qu&amp;rsquo;un certificat en &lt;code&gt;ed25519&lt;/code&gt; mais la même démarche est possible avec n&amp;rsquo;importe quel algorithme supporté par OpenSSH. La clé publique hôte est donc disponible sous le chemin &lt;code&gt;/etc/ssh/ssh_host_ed25519_key.pub&lt;/code&gt; copions-là dans le répertoire &lt;code&gt;/etc/ssh/ca&lt;/code&gt; de la machine sur laquelle nous avons généré l&amp;rsquo;autorité de certification. On peut ensuite lancer la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh-keygen -h -s /etc/ssh/ca/id_ed25519 -n pi01,pi01.infra.eban.bzh -I pi01 -V +3650d ssh_host_ed25519_key.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;L&amp;rsquo;option &lt;code&gt;-n&lt;/code&gt; correspond aux &lt;code&gt;principals&lt;/code&gt;, dans le cas d&amp;rsquo;une clé hôte, elle doit correspondre aux différents noms de domaine auxquelles la clé pourrait être associée.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-I&lt;/code&gt; correspond à l&amp;rsquo;&lt;code&gt;ID&lt;/code&gt;, un identifiant unique attribué à la clé, c&amp;rsquo;est simplement son &amp;ldquo;nom&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Une fois la clé publique signée, il ne nous reste plus qu&amp;rsquo;à copier le certificat qui aura été généré dans le répertoire &lt;code&gt;/etc/ssh/ca/ssh_host_ed25519_key-cert.pub&lt;/code&gt; sur le serveur SSH (ici nous le mettrons à l&amp;rsquo;emplacement &lt;code&gt;/etc/ssh/ssh_host_ed25519_key-cert.pub&lt;/code&gt;) et à ajouter la ligne suivante à la fin du fichier &lt;code&gt;/etc/sshd_config&lt;/code&gt;.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;HostCertificate /etc/ssh/ssh_host_ed25519_key-cert.pub
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On redémarre ensuite le démon ssh avec la commande &lt;code&gt;systemctl restart sshd&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Dernière étape, on va indiquer à tous les clients SSH de faire confiance aux certificats hôtes signés par notre autorité de certification en utilisant la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nb"&gt;echo&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;@cert-authority * &lt;/span&gt;&lt;span class="k"&gt;$(&lt;/span&gt;cat /etc/ssh/ca/id_ed25519.pub&lt;span class="k"&gt;)&lt;/span&gt;&lt;span class="s2"&gt;&amp;quot;&lt;/span&gt; &amp;gt;&amp;gt; ~/.ssh/known_hosts
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Et voilà ! Notre autorité de certification est maintenant configurée sur le serveur SSH.&lt;/p&gt;
&lt;h1 id="signer-les-cles-clients"&gt;Signer les clés clients&lt;/h1&gt;
&lt;p&gt;La procédure pour signer les clés des clients est relativement similaire, après avoir généré une paire de clés pour l&amp;rsquo;autorité de certification (on gardera la même que celle générée dans la partie précédente), on lance la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;keygen&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;s&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;etc&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;ca&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;id_ed25519&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;n&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="nf"&gt;pi&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;I&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pc01&lt;/span&gt;&lt;span class="nv"&gt;@eban&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;bzh&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;V&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="mi"&gt;30&lt;/span&gt;&lt;span class="n"&gt;d&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;z&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;home&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;USERNAME&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ssh&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;id_ed25519&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;pub&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;N&amp;rsquo;oubliez pas de changer &lt;code&gt;USERNAME&lt;/code&gt; par votre nom d&amp;rsquo;utilisateur.&lt;/p&gt;
&lt;p&gt;Si vous obtenez une erreur, c&amp;rsquo;est probablement que n&amp;rsquo;avez pas déjà une paire de clé SSH en &lt;code&gt;ed25519&lt;/code&gt; vous pouvez en générer une avec la commande&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;ssh-keygen -t ed25519
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Une fois la paire de clé générée, vous pouvez relancer la première commande.&lt;/p&gt;
&lt;p&gt;Ici l&amp;rsquo;option &lt;code&gt;-n&lt;/code&gt; correspond au⋅x &lt;strong&gt;nom&lt;/strong&gt;⋅s &lt;strong&gt;d&amp;rsquo;utilisateur distant&lt;/strong&gt; (= sur le serveur SSH) pour lesquels vous souhaitez autoriser que cette clé soit valide, cette clé ne sera donc valide que pour le nom d&amp;rsquo;utilisateur distant  &lt;code&gt;pi&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;-z&lt;/code&gt; correspond au &lt;code&gt;serial&lt;/code&gt; de ce certificat, c&amp;rsquo;est un nombre que vous devrez incrémenter si vous régénérez la clé après la durée d&amp;rsquo;expiration (ici mise à 30 jours).&lt;/p&gt;
&lt;p&gt;Une fois cela fait, il ne nous reste plus qu&amp;rsquo;à copier la clé publique de notre autorité de certification (contenue dans &lt;code&gt;/etc/ssh/ca/id_ed25519.pub&lt;/code&gt;) sur notre serveur SSH, ici nous la mettrons dans le fichier &lt;code&gt;/etc/ssh/ca.pub&lt;/code&gt; et à ajouter la ligne &lt;code&gt;TrustedUserCAKeys /etc/ssh/ca.pub&lt;/code&gt; à la fin du fichier &lt;code&gt;/etc/ssh/sshd_config&lt;/code&gt;. On termine par redémarrer le service SSH, &lt;code&gt;sudo systemctl restart sshd&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Nous avons maintenant mit en place notre autorité de certification ! On peut simplement la tester en se connectant via SSH au serveur, vous ne devriez pouvoir vous connecter sans mot de passe et n&amp;rsquo;avoir aucune demande de validation de la clé publique de la machine hôte. J&amp;rsquo;espère que cet article vous aura été utile, si vous avez des questions n&amp;rsquo;hésitez pas à nous les poser en commentaire ou sur &lt;a href="https://twitter.com/ilearned_eu"&gt;Twitter&lt;/a&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Thu, 22 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-22:/ca-ssh.html</guid><category>misc</category></item><item><title>Sécuriser votre système d'exploitation grâce aux MAC</title><link>https://ilearned.eu.org/mac.html</link><description>&lt;p&gt;Un reproche souvent fait à Linux est sa gestion des droits souvent trop permissive. Il y a bien sûr une raison historique, à la naissance des différents systèmes d&amp;rsquo;exploitation que l&amp;rsquo;on connait aujourd&amp;rsquo;hui la sécurité n&amp;rsquo;était pas la préoccupation principale. Le but de base n&amp;rsquo;était pas non plus de compliquer la tâche des utilisateurs (la sécurité se fait toujours au prix de complexité supplémentaire). Le problème de cette philosophie de départ est qu&amp;rsquo;il faut repenser la sécurité avec une base trop ouverte.&lt;/p&gt;
&lt;p&gt;Sous Linux tout est fichier, les périphériques physiques ont par exemple, un fichier attribué dans &lt;code&gt;/dev&lt;/code&gt;. La sécurité d&amp;rsquo;accès pour les fichiers se base sur les permission de chaque fichier. Ce mécanisme montre vite des limites. Les autorisations sont très limitées, sous Linux ces autorisations sont divisées en 3, ce que l&amp;rsquo;utilisateur propriétaire peut faire, ce que le groupe propriétaire peut faire et ce que tout le monde est autorisé à faire. Chaque partie peut avoir 3 droits différents :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;R (read) : Lecture&lt;/li&gt;
&lt;li&gt;W (write) : Écriture&lt;/li&gt;
&lt;li&gt;X (Execute) : Exécution (dans le cadre d&amp;rsquo;un dossier c&amp;rsquo;est l&amp;rsquo;autorisation pour lister le contenu)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On peut visualiser les permissions via la commande &lt;code&gt;ls -l &amp;lt;dossier&amp;gt;&lt;/code&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;% ls -l&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="n"&gt;total&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="s"&gt;0&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rwxr&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;xr&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;x&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ramle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;ramle&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;executable&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;rw&lt;/span&gt;&lt;span class="o"&gt;-------&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="n"&gt;root&lt;/span&gt;&lt;span class="w"&gt;  &lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;Jul&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;19&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="mi"&gt;17&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;05&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;root_only&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;ls&lt;/code&gt; divise en 3 parties les permissions, celle de l&amp;rsquo;utilisateur, du groupe et de tout le monde :&lt;/p&gt;
&lt;p&gt;&lt;img alt="Détails des droits affichés par LS" src="/static/img/mac/ls(2).png"&gt;&lt;/p&gt;
&lt;p&gt;Le soucis de se baser uniquement sur les permissions des fichiers est le manque de contrôle, le schéma de sécurité des MAC permet de renforcer le tout en regardant beaucoup plus de facteur. Le concept est de regarder toutes le actions faites sur la machine, et de regarder l&amp;rsquo;action et l&amp;rsquo;autoriser ou non en fonction des règles d&amp;rsquo;accès. L&amp;rsquo;avantage de ce modèle par rapport à la sécurité historique de Linux (et UNIX par la même occasion) est d&amp;rsquo;être bien plus précis, par exemple autoriser à une application seulement certains ports et fichiers (fichier qui pourrait selon le système de fichier lui être autorisé).&lt;/p&gt;
&lt;p&gt;Sous Linux, il n&amp;rsquo;y a pas de base de framework de MAC, mais des modules dans le noyaux sont prévu pour qu&amp;rsquo;on y greffe un framework il y en a deux importants, Apparmor et SELinux.&lt;/p&gt;
&lt;p&gt;Les deux ont des fonctionnalités similaires, mais se différencient par un point important, Apparmor se base sur le chemin complet d&amp;rsquo;un fichier, là ou SELinux se base seulement sur le nom, cette différence est assez minime dans la plupart des cas, mais en fonction du framework utilisé, des méthodes de contournement se basant sur ces spécificités, par exemple en utilisant des liens virtuelles (symlink) ou renommant un fichier, une bonne politique d&amp;rsquo;accès évite cependant les contournements.&lt;/p&gt;
&lt;p&gt;Bien sûr, Linux n&amp;rsquo;est pas le seul système d&amp;rsquo;exploitation qui utilise des contrôles d&amp;rsquo;accès plus poussé qu&amp;rsquo;uniquement des permissions basiques, Windows fonctionne sur &lt;a href="https://ilearned.eu.org/secu_windows.html"&gt;ce principe&lt;/a&gt; aussi tout comme MacOS et BSD avec l&amp;rsquo;intégration de TrustedBSD.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Tue, 20 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-20:/mac.html</guid><category>misc</category></item><item><title>MQTT, comprendre le standard de la domotique</title><link>https://ilearned.eu.org/mqtt.html</link><description>&lt;p&gt;Si vous vous êtes déjà intéressé⋅e à la domotique, vous avez sûrement entendu parler du protocole MQTT (Message Queuing Telemetry Transport), MQTT est un protocole très utilisé pour faire de l&amp;rsquo;automatisation notamment, nous allons entrer plus en profondeur dans le fonctionnement d&amp;rsquo;MQTT dans cet article à travers l&amp;rsquo;exemple d&amp;rsquo;une lampe connectée.&lt;/p&gt;
&lt;p&gt;MQTT fonctionne sur le principe de &lt;code&gt;Topics&lt;/code&gt; dans lesquels les différents appareils peuvent publier ou recevoir des messages. La fonctionnement de ce protocole est relativement simple, le client commence par s&amp;rsquo;authentifier auprès du serveur, puis il peut recevoir et/ou envoyer des messages au serveur, appelé &lt;code&gt;Broker&lt;/code&gt;, voici un exemple de trame réseau.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Trame réseau MQTT" src="/static/img/mqtt/MQTT_Trame_rseau.png"&gt;&lt;/p&gt;
&lt;p&gt;On peut donc voir que ce protocole est très simple de fonctionnement, et ce n&amp;rsquo;est pas un hasard qu&amp;rsquo;il soit très utilisé en domotique, bien souvent les appareils en domotique sont tout petits et n&amp;rsquo;ont pas la capacité d&amp;rsquo;implémenter des protocoles très lourd.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un exemple de communication avec MQTT" src="/static/img/mqtt/Exemple.png"&gt;&lt;/p&gt;
&lt;p&gt;Vous pouvez voir ci-dessus un exemple très simple d&amp;rsquo;utilisation du protocole MQTT, un téléphone publie un message au broker MQTT sur le topic &lt;code&gt;stat/phone&lt;/code&gt; quand le réveil sonne, une lampe connectée est abonnée au topic &lt;code&gt;stat/phone&lt;/code&gt;, quand un message indiquant qu&amp;rsquo;une alarme vient de sonner lui parvient, elle s&amp;rsquo;allume et indique par un message sur le topic &lt;code&gt;stat/lampe/POWER&lt;/code&gt; qu&amp;rsquo;elle est allumée. Ce scénario est très simple mais il montre à quel point MQTT est modulable et peut permettre une automatisation poussée. Si vous êtes intéressé⋅e par la domotique, sachez qu&amp;rsquo;il existe des petits modules appelés modules &lt;a href="https://fr.aliexpress.com/item/33061230430.html"&gt;Sonoff&lt;/a&gt; qui permettent de rendre &amp;ldquo;connecté&amp;rdquo; n&amp;rsquo;importe quel appareil électrique (une lampe de chevet par exemple) et qui, une fois un firmware (système d&amp;rsquo;exploitation) spécial appelé &lt;a href="https://tasmota.github.io/"&gt;Tasmota&lt;/a&gt; flashé permettent aussi de publier des messages sur un broker MQTT. Si vous n&amp;rsquo;êtes pas un aficionado de la ligne de commande, il existe des logiciels comme &lt;a href="https://nodered.org/"&gt;Node-RED&lt;/a&gt; ou &lt;a href="https://play.google.com/store/apps/details?id=com.llamalab.automate&amp;amp;hl=fr&amp;amp;gl=US"&gt;Automate&lt;/a&gt; sur Android qui permettent de s&amp;rsquo;essayer à la domotique et l&amp;rsquo;automatisation facilement.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 09 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-09:/mqtt.html</guid><category>misc</category></item><item><title>Vérifier l’intégrité d'un système d'exploitation grâce à Secure Boot.</title><link>https://ilearned.eu.org/secure_boot.html</link><description>&lt;p&gt;La sécurité d&amp;rsquo;un système dépends de beaucoup de facteur, un des facteurs important est de pouvoir vérifier l’intégrité du système démarré, en effet sans cette vérification un attaquant pourrait sans trop de difficultés modifier les fichiers de démarrage pour ajouter un malware. Cet article se concentrera sur les machines de bureaux.&lt;/p&gt;
&lt;p&gt;Pour bien comprendre comment peuvent être effectuées des attaques pendant le boot il est important de comprendre le fonctionnement du démarrage en mode BIOS, et son remplaçant l&amp;rsquo;UEFI.&lt;/p&gt;
&lt;h2 id="bios"&gt;BIOS&lt;/h2&gt;
&lt;p&gt;Le démarrage en BIOS s&amp;rsquo;appuie sur une table des partitions en MBR (master boot record), pour démarrer le bios va exécuter du code contenu dans la table des partitions, ce code s&amp;rsquo;occupe de passer la main au bootloader qui va s&amp;rsquo;occuper de lancer le système. Un problème assez flagrant apparait déjà, du code peut être directement inséré dans cette partie, aucune vérification n&amp;rsquo;est effectuée par le BIOS. Un attaquant pourrait aussi attaquer le bootloader qui ne peut pas être chiffré.&lt;/p&gt;
&lt;p&gt;Sous Linux (nous verrons le fonctionnement de Windows un peu plus loin) le bootloader le plus courant est grub, il insère dans le MBR de quoi charger son code complet qui est contenu dans &lt;code&gt;/boot&lt;/code&gt;, la plupart des bootloader sous linux fonctionnent sur le même principe.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un système non chiffré" src="/static/img/secure_boot/Boot_mbr.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour éviter une modification du système on pourrait chiffrer le partition root (aussi appelé Userland) et faire un /boot à part (le bootloader ne peut pas être chiffré), un problème se pose alors, l&amp;rsquo;initramfs et le kernel sont toujours en clair.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un système chiffré avec seulement le userland de chiffré" src="/static/img/secure_boot/Boot_mbr(1).png"&gt;&lt;/p&gt;
&lt;p&gt;Grub (et c&amp;rsquo;est à ma connaissance le seul) permet de déchiffrer le partition boot, pour garder l&amp;rsquo;initramfs et le kernel chiffré. Mais grub en lui même est toujours modifiable, même chose pour le code exécuté directement dans le MBR.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Un système chiffré avec le userland et le kernel de chiffré" src="/static/img/secure_boot/Boot_mbr(2).png"&gt;&lt;/p&gt;
&lt;p&gt;En plus de ne pas être totalement sécurisé, avec cette méthodes la phrase de passe doit être tapée deux fois, une fois pour lire l&amp;rsquo;initramfs et une autre fois pour déchiffrer la partition root. (grub ne la retient pas).&lt;/p&gt;
&lt;p&gt;Une solution possible serait de signer les différents élément du boot, le problème est qu&amp;rsquo;en BIOS aucun mécanisme pour la vérification de signature existe.&lt;/p&gt;
&lt;p&gt;Avec un BIOS nous n&amp;rsquo;avons pas de possibilité de sécuriser entièrement un système Linux.&lt;/p&gt;
&lt;p&gt;Pour Windows, le concept est très proche, le BIOS va exécuter le code dans le MBR, ce code va enclencher le bootloader de Windows qui, depuis Windows Vista, est bootmgr, chiffrer son disque pose le même soucis que sous Linux, le bootloader restera en clair.&lt;/p&gt;
&lt;h2 id="uefi"&gt;UEFI&lt;/h2&gt;
&lt;p&gt;Avec UEFI on se passe de MBR au profit de GPT qui apporte un certain nombre d&amp;rsquo;avantages. Le processus de boot ne se passe plus par un code exécutable dans la partie MBR, ce code est contenu dans une partition en FAT32 (ou FAT16), ce qui permet de ne plus être aussi limité en taille, la partie dédié au code de démarrage dans MBR n&amp;rsquo;est que de 446 bytes. UEFI apporte aussi une évolution majeure pour la sécurité : Secure Boot, c&amp;rsquo;est un moyen de vérifier l&amp;rsquo;intégrité via une signature du fichier EFI. Un fichier EFI est un exécutable lancé par l&amp;rsquo;UEFI, on pourrait le comparer aux ELF de Linux, ou aux exe de Windows.&lt;/p&gt;
&lt;p&gt;Lorsque qu&amp;rsquo;un pc avec Secure Boot démarre, il vérifie le binaire EFI, pour voir si la signature corresponds à une clé de &amp;ldquo;confiance&amp;rdquo; et si la signature n&amp;rsquo;est pas dans dans la liste des clés à refuser.&lt;/p&gt;
&lt;p&gt;L&amp;rsquo;UEFI se base sur des variables pour les clés, vous pouvez les voir depuis Linux via l&amp;rsquo;utilitaire &amp;ldquo;efi-readvars&amp;rdquo;, ce qui sur ma machine donne :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Variable PK, length 823
PK: List 0, type X509
    Signature 0, size 795, owner 5b2a4205-8ee1-404d-a357-45629f968019
        Subject:
            CN=Ramle PK
        Issuer:
            CN=Ramle PK
Variable KEK, length 825
KEK: List 0, type X509
    Signature 0, size 797, owner 5b2a4205-8ee1-404d-a357-45629f968019
        Subject:
            CN=Ramle KEK
        Issuer:
            CN=Ramle KEK
Variable db, length 823
db: List 0, type X509
    Signature 0, size 795, owner 5b2a4205-8ee1-404d-a357-45629f968019
        Subject:
            CN=Ramle DB
        Issuer:
            CN=Ramle DB
Variable dbx has no entries
Variable MokList has no entries
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Regardons de plus près chaque variable :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;PK : C&amp;rsquo;est la clé la plus haute dans la chaine de confiance, elle est là pour signer la clé KEK, une seule clé est possible dans cette variable. En général c&amp;rsquo;est le constructeur qui met sa clé, si vous voulez contrôler totalement la chaine de confiance il faudra donc la changer.&lt;/li&gt;
&lt;li&gt;KEK : Ces clé sont utilisées pour signer les clés qui iront dans DB ou DBX, souvent de base il y a 2 KEK, une pour Microsoft et une autre pour le Fabricant.&lt;/li&gt;
&lt;li&gt;DB : Ce sont les clés utilisées pour la vérifications des binaires EFI, souvent l&amp;rsquo;ordinateur vient avec les clés du constructeur, de Microsoft, Canonical (entreprise qui est derrière Ubuntu) et parfois d&amp;rsquo;autres entreprises.&lt;/li&gt;
&lt;li&gt;DBX : C&amp;rsquo;est la liste des clés qui ne sont plus de confiance.&lt;/li&gt;
&lt;li&gt;MOKList : C&amp;rsquo;est utilisé par un outil du nom de Shim, cet outil est là pour charger un autre bootloader qui ne serait pas signé avec les clés présentent dans DB, Shim va vérifier le bootloader via les clés dans la MOKList qui est géré par l&amp;rsquo;utilisateur, et non via l&amp;rsquo;UEFI directement.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="La chaine de confiance de Secure Boot" src="/static/img/secure_boot/Cl_secure_boot(1).png"&gt;&lt;/p&gt;
&lt;p&gt;Ces variables sont bien sur modifiable sur la plupart des pc, ce qui permet de gérer sa propre PKI (public key infrastructure).&lt;/p&gt;
&lt;p&gt;Si on veut un réel contrôle il faut gérer soit même ses clés, sous Linux c&amp;rsquo;est possible sans trop de difficultés, FreeBSD et OpenBSD semblent supporter aussi (je n&amp;rsquo;ai pas eu l&amp;rsquo;occasion de tester) et sous Windows on peut soit utiliser les clés de Microsoft ou utiliser ses propres clés ce qui semble en théorie possible.&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;espère que cette article vous aura plus, je pense prochainement faire un petit guide pour la gestion de Secure Boot sous Linux, je vous laisse donc surveiller les sorties 👀. On se retrouve après demain pour un article sur MQTT&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Wed, 07 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-07:/secure_boot.html</guid><category>misc</category></item><item><title>Les version oubliées du protocole IP 🔎</title><link>https://ilearned.eu.org/versions-ip.html</link><description>&lt;p&gt;On connait tous IPv4 et &lt;a href="https://blog.eban.bzh/today-i-learned/ipv6.html"&gt;IPv6&lt;/a&gt; qui sont deux protocoles largement répandus (bien qu&amp;rsquo;un des deux ne le soit pas assez ^^), mais on pourrait légitimement se demander s&amp;rsquo;il existe d&amp;rsquo;autres version du Protocole Internet, nous ferrons donc dans cet article un petit tour d&amp;rsquo;horizon des différentes itérations du protocole IP et de leurs spécificités.&lt;/p&gt;
&lt;h1 id="ipv1-2-et-3-la-genese-du-protocole-internet"&gt;IPv1 2 et 3 − La genèse du protocole Internet&lt;/h1&gt;
&lt;p&gt;Le premier document décrivant le fonctionnement d&amp;rsquo;IP est la &lt;a href="https://www.rfc-editor.org/rfc/rfc675.html"&gt;RFC 675&lt;/a&gt; publiée en 1974 mais présentée dès 1973 à l&amp;rsquo;International Network Working Group. Si vous parcourez cette RFC vous remarquerez qu&amp;rsquo;elle ne fait pas mention du protocole IP, mais de TCP, en effet à l&amp;rsquo;époque, TCP et IP n&amp;rsquo;étaient pas séparés et le principe de couches apporté notamment par le modèle TCP/IP, sortit en 1976, n&amp;rsquo;était pas encore d&amp;rsquo;actualité. Parler d&amp;rsquo;IPv1 est donc un abus de langage, le terme adapté serait plutôt TCP version 1.&lt;/p&gt;
&lt;p&gt;Ce protocole avait une particularité intéressante, il contenait quatre champs adresse dans son header, contre deux pour IPv6. Un pour le réseau de destination (et d&amp;rsquo;origine), rappelez vous, nous sommes en 1974 et à cette époque le réseau Internet comme nous le connaissons aujourd&amp;rsquo;hui n&amp;rsquo;existe pas, il existe donc différents réseaux concurrent, ce champ dans l&amp;rsquo;en-tête a pour but de spécifier sur quel réseau le paquet doit transiter. Ainsi, vous pouvez voir ci-dessous les différentes valeurs possibles pour ce champ et donc les principaux réseaux qui cohabitent à cette époque.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mf"&gt;1010&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;ARPANET&lt;/span&gt;
&lt;span class="mf"&gt;1011&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;UCL&lt;/span&gt;
&lt;span class="mf"&gt;1100&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CYCLADES&lt;/span&gt;
&lt;span class="mf"&gt;1101&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;NPL&lt;/span&gt;
&lt;span class="mf"&gt;1110&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;CADC&lt;/span&gt;
&lt;span class="mf"&gt;1111&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;EPSS&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Les troisième et quatrième champs sont destinés à accueillir les &lt;code&gt;adresses TCP&lt;/code&gt; d&amp;rsquo;origine et de destination, ces adresses ne sont pas très détaillées dans la RFC, mais on sait qu&amp;rsquo;elles sont d&amp;rsquo;une longueur de 16 bits (65 536 adresses différentes), elles correspondent peu ou prou à ce qu&amp;rsquo;on appelle aujourd&amp;rsquo;hui &amp;ldquo;adresses IP&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Cette première version de TCP est vraiment expérimentale, elle n&amp;rsquo;a pas été déployée à grande échelle comme l&amp;rsquo;ont été IPv4 et IPv6&lt;/p&gt;
&lt;p&gt;Vient ensuite en 1977 la deuxième version de TCP (et donc par extension du protocole internet), cette version, publiée dans l&amp;rsquo;&lt;a href="https://www.rfc-editor.org/in-notes/ien/ien5.pdf"&gt;IEN 5&lt;/a&gt;, apporte certaines améliorations dont notamment le passage à un &amp;ldquo;Network Identifier&amp;rdquo;, ce qui était auparavant appelé réseau de destination/origine, codé sur 8 bits.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Liste des différents network" src="/static/img/versions-ip/network_list.png"&gt;&lt;/p&gt;
&lt;p&gt;Autre différence, les &amp;ldquo;host identifier&amp;rdquo;, anciennement appelés &lt;code&gt;adresses TCP&lt;/code&gt;, sont maintenant codés sur 24 bits, soit un total de 16 777 216 adresses. On peut aussi voir le début de la séparation entre TCP et IP dans ce schéma d&amp;rsquo;époque avec les parties &amp;ldquo;TCP Header&amp;rdquo; et &amp;ldquo;Internet Header&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Header TCP où l'on voit deux parties, une appelée &amp;quot;TCP Header&amp;quot; et l'autre &amp;quot;IP Header&amp;quot;" src="/static/img/versions-ip/header.png"&gt;&lt;/p&gt;
&lt;p&gt;Séparation qui sera &lt;a href="https://datatracker.ietf.org/doc/html/rfc760"&gt;actée&lt;/a&gt; dans la version 3 de TCP, publiée en 1978, ce qui représente une avancée majeure dans l&amp;rsquo;évolution du protocole internet.&lt;/p&gt;
&lt;h1 id="ipv5"&gt;IPv5&lt;/h1&gt;
&lt;p&gt;IPv5 n&amp;rsquo;a pas réellement existé, il s&amp;rsquo;agit en fait du &lt;a href="https://datatracker.ietf.org/doc/html/rfc1190"&gt;Stream Protocol&lt;/a&gt;, abrégé ST-II, un protocole de couche 3 (comme IP), créé pour faciliter l&amp;rsquo;envoi de vidéo et d&amp;rsquo;audio par internet et qui avait dans le champ version la valeur 5. C&amp;rsquo;était donc une version modifiée d&amp;rsquo;IPv4 mais qui avait des adresses codées sur 32 bits, comme pour IPv4, qui ne répondait donc pas à la problématique principale posée par IPv4, le manque d&amp;rsquo;adresses. Ce protocole marque le début de VoIP (Voice over IP) mais il ne sera pas déployé à grande échelle, VoIP sera ensuite simplement déployé sur IPv4.&lt;/p&gt;
&lt;h1 id="ipv7-8-et-9-le-futur-ou-pas"&gt;IPv7, 8 et 9 − Le futur ? Ou pas&amp;hellip;&lt;/h1&gt;
&lt;p&gt;IPv7 est un protocole appelé &lt;code&gt;TP/IX&lt;/code&gt; sortit en 1993, les adresses IP sont codées sur 64 bits (contre 128 avec IPv6), on ne détaillera pas plus ce protocole mais si vous souhaitez en savoir plus je vous invite à lire la &lt;a href="https://datatracker.ietf.org/doc/html/rfc1475"&gt;RFC&lt;/a&gt; d&amp;rsquo;IPv7 qui est très compréhensible.&lt;/p&gt;
&lt;p&gt;&lt;a href="https://datatracker.ietf.org/doc/html/rfc1621"&gt;IPv8&lt;/a&gt; (mon petit préféré ^^) appelé &lt;code&gt;PIP&lt;/code&gt; et sortit en 1994 son fonctionnement repose en partie sur le système de &lt;a href="https://ilearned.eu.org/les-bases-du-dns.html"&gt;DNS&lt;/a&gt;, chaque utilisateur du réseau a un &lt;code&gt;PIP ID&lt;/code&gt;, un identifiant unique codé sur 64 bits, ainsi, peu importe d&amp;rsquo;où il se connecte sur le réseau, il est possible de l&amp;rsquo;identifier rien qu&amp;rsquo;avec son ID. &lt;code&gt;PIP&lt;/code&gt; a donc été avant tout pensé pour faciliter les échanges entre appareils changeant d&amp;rsquo;adresse IP. On pourrait par exemple imaginer une connexion SSH utilisant uniquement le &lt;code&gt;PIP ID&lt;/code&gt; pour s&amp;rsquo;authentifier et qui, même si un des deux composants de la connexion (le client ou le serveur) change d&amp;rsquo;adresse IP reste stable. Je parlais plus tôt du DNS, en effet, avec &lt;code&gt;PIP&lt;/code&gt; le DNS est modifié pour renvoyer à la fois l(es) adresse(s) IP mais aussi le &lt;code&gt;PIP ID&lt;/code&gt;. Ce système a néanmoins un problème majeur, le &lt;code&gt;PIP ID&lt;/code&gt; permettrait de pister très facilement les utilisateurs.&lt;/p&gt;
&lt;p&gt;IPv9 enfin est un protocole très peu détaillé, il avait été &lt;a href="http://www.china.org.cn/english/scitech/100279.htm"&gt;annoncé&lt;/a&gt; en grande pompe par le gouvernement chinois, celui-ci se targuant du fait que cette version d&amp;rsquo;IP ait été adoptée dans les secteurs militaires et civils, mais depuis cet effet d&amp;rsquo;annonce aucune spécification technique n&amp;rsquo;a été publiée, seulement des bruits de couloir comme quoi les adresses seraient codées sur 256 bits et composées uniquement de caractères numériques (et non pas hexadécimaux comme c&amp;rsquo;est le cas d&amp;rsquo;IPv6).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Mon, 05 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-05:/versions-ip.html</guid><category>misc</category></item><item><title>Modèle de sécurité Windows</title><link>https://ilearned.eu.org/secu_windows.html</link><description>&lt;h2 id="introduction"&gt;Introduction&lt;/h2&gt;
&lt;p&gt;&amp;ldquo;Accès refusé&amp;rdquo;. S’il y a bien une erreur frustrante, c’est sûrement celle-ci. Sur Windows nous y sommes pourtant souvent confrontés, surtout dans une perspective attaquante. En revanche, peu de gens comprennent pourquoi cette erreur (ou d’autres) vient s’immiscer dans sa confortable utilisation de son système d’exploitation.&lt;/p&gt;
&lt;p&gt;Dans cet article, je tâcherais de vous présenter, dans les grandes lignes, le modèle de sécurité qu’utilise Windows, principalement les notions de privilège d’accès et de contrôle d’accès.&lt;/p&gt;
&lt;p&gt;De manière générale, lorsque je parlerais d’objet Windows, je parlerais d’utilisateurs, de machines, de fichiers, ou encore de processus.&lt;/p&gt;
&lt;h2 id="contexte-de-securite"&gt;Contexte de sécurité&lt;/h2&gt;
&lt;p&gt;Pour bien comprendre la suite, il est nécessaire de comprendre ce qu’est un contexte de sécurité chez notre ami Windows. Ce dernier désigne un ensemble d’attributs ou de règles de sécurité actuellement en vigueur pour reprendre la définition de Microsoft. Un contexte de sécurité se traduira par une structure de données particulières définis par la &lt;code&gt;SSPI&lt;/code&gt; (&amp;ldquo;Security Support Provider Interface&amp;rdquo;), une &lt;code&gt;API&lt;/code&gt; Windows écrite dans le but d’interagir avec le contexte de sécurité, elle est notamment utilisée, par exemple, pour l’authentification. Autrement dit, le contexte de sécurité définit les éléments de bases du système de sécurité de notre os favori (si c’est pas le cas faites comme si).&lt;/p&gt;
&lt;h2 id="securableobject"&gt;SecurableObject&lt;/h2&gt;
&lt;p&gt;Un objet est dit &amp;ldquo;sécurisable&amp;rdquo; s’il a la capacité de posséder un descripteur de sécurité. De manières générales, énormément d’objet dans Windows sont des &lt;code&gt;SecurableObject&lt;/code&gt;. Les processus, les clés de registre, les fichiers/répertoires, les objets ‘Active Directory’ et bien d’autres. Ils forment donc le cœur des interactions entre nous et le système d’exploitation. J’ai parlé des descripteurs de sécurité, ces derniers sont simplement des listes de plusieurs caractéristiques. Ils contiennent le &lt;code&gt;SID&lt;/code&gt; (&amp;ldquo;Security Identifier&amp;rdquo;, qui est un identifiant unique)  du propriétaire de l’objet, le &lt;code&gt;SID&lt;/code&gt; du groupe propriétaire, et des &lt;code&gt;ACLs&lt;/code&gt; pour &amp;ldquo;Access Control Lists&amp;rdquo;. Les descripteurs de sécurité sont usuellement au format &lt;code&gt;SDDL&lt;/code&gt; (&amp;ldquo;Security Descriptor Definition Langage&amp;rdquo;) bien que peu reluisant, il est en réalité très pratique car simple d’utilisation (non pas de compréhension).&lt;/p&gt;
&lt;h2 id="token-dacces"&gt;Token d’accès&lt;/h2&gt;
&lt;p&gt;Lorsqu’un utilisateur Windows se connecte à son compte local (ou Active Directory) plusieurs informations seront alors stockés dans la mémoire. De manière assez évidente, il contiendra le condensat du mot de passe (sauf configurations très improbable ou un système relativement vieux et dans ces cas précis, ce sera le mot de passe en claire), son &lt;code&gt;SID&lt;/code&gt;, le &lt;code&gt;SID&lt;/code&gt; de son groupe, des privilèges d’accès (nous y reviendrons plus tard) et bien d’autres informations. On regroupe tout cela dans ce que l’on appelle un &lt;code&gt;token&lt;/code&gt; d’accès. Ce dernier est alors gardé dans un processus un peu particulier appelé &lt;code&gt;LSASS.exe&lt;/code&gt; pour &amp;ldquo;Local Security Autority SubSystem Service&amp;rdquo;. Ce dernier est donc vital et très sensible.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Une fois le mot de passe spécifié, un token est créé" src="/static/img/secu_windows/Auth LSASS.png"&gt;&lt;/p&gt;
&lt;p&gt;Lorsqu&amp;rsquo;on interagit avec le système d’une quelconque manière, une copie de notre &lt;code&gt;token&lt;/code&gt; d’accès est alors utilisée. Dans le cas d’un fichier, les informations que le &lt;code&gt;token&lt;/code&gt; d’accès contient vont donc être comparées avec les informations contenues dans la &lt;code&gt;DACL&lt;/code&gt; (qui est une liste contenant les accès, plus d’information  sur ce sujet un peu après) garantissant ou non un accès d’une certaine valeur. Il peut être destiné à de l’écriture, de la lecture ou bien même pour de l’exécution.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Certaines informations du token sont comparées avec la DACL" src="/static/img/secu_windows/Principe d'accès.png"&gt;&lt;/p&gt;
&lt;p&gt;Un cas plus intéressant est celui du démarrage d’un programme. En effet, ce dernier est lancé en tant qu’un utilisateur en particulier, il ne doit donc pas contourner ce fameux système d’accès. C’est pourquoi les processus sont considérés comme des &lt;code&gt;SecurableObject&lt;/code&gt;, et dans cette situation, une copie de notre &lt;code&gt;token&lt;/code&gt; d’accès est également donné et quand le programme interagira avec le système, il le fera bien selon les droits et l’identité de l’utilisateur connecté.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Lorsque l'on créer un processus, on lui fournit notre token pour qu'il puisse l'utiliser" src="/static/img/secu_windows/Principe d'accès à un programme.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;La fonction &lt;a href="https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa"&gt;&lt;code&gt;CreateProcessA()&lt;/code&gt;&lt;/a&gt; est une fonction de l&amp;rsquo;&lt;code&gt;API&lt;/code&gt; Windows &lt;code&gt;kernel32.dll&lt;/code&gt; qui permet de créer un nouveau processus.&lt;/em&gt;&lt;/p&gt;
&lt;h2 id="privileges-dacces"&gt;Privilèges d’accès&lt;/h2&gt;
&lt;p&gt;Comme mentionné plus tôt, le &lt;code&gt;token&lt;/code&gt; d’accès renferme en son sein un certain nombre de privilèges. Ces derniers sont attribués à chaque connexion, en fonction des règles de sécurité. Plus précisément, les privilèges d’accès sont donnés en fonction du groupe d’appartenance auquel on attribut des droits par défaut grâce aux &lt;code&gt;GPOs&lt;/code&gt; locales (dans &lt;code&gt;gpedit.msc&lt;/code&gt;, &lt;code&gt;Configuration Ordinateur \ Paramètres windows\ Paramètres de sécurité\ Stratégies local\ Attribution des droits utilisateur&lt;/code&gt;). La liste de ces privilèges n’est pas présente sous forme d’énumération classique, en revanche voici une implémentation en PowerShell pour bien se rendre compte de l’ensemble de ces privilèges (issus de &lt;a href="https://github.com/jaredcatkinson/PSReflect-Functions"&gt;PSReflect-Functions&lt;/a&gt;).&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="nv"&gt;$SecurityEntity&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt; &lt;span class="n"&gt;psenum&lt;/span&gt; &lt;span class="nv"&gt;$ENUM&lt;/span&gt; &lt;span class="n"&gt;SecurityEntity&lt;/span&gt; &lt;span class="n"&gt;UInt32&lt;/span&gt; &lt;span class="p"&gt;@{&lt;/span&gt;
    &lt;span class="n"&gt;SeCreateTokenPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;1&lt;/span&gt;
    &lt;span class="n"&gt;SeAssignPrimaryTokenPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;2&lt;/span&gt;
    &lt;span class="n"&gt;SeLockMemoryPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;3&lt;/span&gt;
    &lt;span class="n"&gt;SeIncreaseQuotaPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;4&lt;/span&gt;
    &lt;span class="n"&gt;SeUnsolicitedInputPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;5&lt;/span&gt;
    &lt;span class="n"&gt;SeMachineAccountPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;6&lt;/span&gt;
    &lt;span class="n"&gt;SeTcbPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;7&lt;/span&gt;
    &lt;span class="n"&gt;SeSecurityPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;8&lt;/span&gt;
    &lt;span class="n"&gt;SeTakeOwnershipPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;9&lt;/span&gt;
    &lt;span class="n"&gt;SeLoadDriverPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;10&lt;/span&gt;
    &lt;span class="n"&gt;SeSystemProfilePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;11&lt;/span&gt;
    &lt;span class="n"&gt;SeSystemtimePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;12&lt;/span&gt;
    &lt;span class="n"&gt;SeProfileSingleProcessPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;13&lt;/span&gt;
    &lt;span class="n"&gt;SeIncreaseBasePriorityPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;14&lt;/span&gt;
    &lt;span class="n"&gt;SeCreatePagefilePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;15&lt;/span&gt;
    &lt;span class="n"&gt;SeCreatePermanentPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;16&lt;/span&gt;
    &lt;span class="n"&gt;SeBackupPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;17&lt;/span&gt;
    &lt;span class="n"&gt;SeRestorePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;18&lt;/span&gt;
    &lt;span class="n"&gt;SeShutdownPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;19&lt;/span&gt;
    &lt;span class="n"&gt;SeDebugPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;20&lt;/span&gt;
    &lt;span class="n"&gt;SeAuditPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;21&lt;/span&gt;
    &lt;span class="n"&gt;SeSystemEnvironmentPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;22&lt;/span&gt;
    &lt;span class="n"&gt;SeChangeNotifyPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;23&lt;/span&gt;
    &lt;span class="n"&gt;SeRemoteShutdownPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;24&lt;/span&gt;
    &lt;span class="n"&gt;SeUndockPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;25&lt;/span&gt;
    &lt;span class="n"&gt;SeSyncAgentPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;26&lt;/span&gt;
    &lt;span class="n"&gt;SeEnableDelegationPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;27&lt;/span&gt;
    &lt;span class="n"&gt;SeManageVolumePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;28&lt;/span&gt;
    &lt;span class="n"&gt;SeImpersonatePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;29&lt;/span&gt;
    &lt;span class="n"&gt;SeCreateGlobalPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;30&lt;/span&gt;
    &lt;span class="n"&gt;SeTrustedCredManAccessPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;31&lt;/span&gt;
    &lt;span class="n"&gt;SeRelabelPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;32&lt;/span&gt;
    &lt;span class="n"&gt;SeIncreaseWorkingSetPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;33&lt;/span&gt;
    &lt;span class="n"&gt;SeTimeZonePrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;34&lt;/span&gt;
    &lt;span class="n"&gt;SeCreateSymbolicLinkPrivilege&lt;/span&gt; &lt;span class="p"&gt;=&lt;/span&gt;  &lt;span class="n"&gt;35&lt;/span&gt;
&lt;span class="p"&gt;}&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Et oui, 35 privilèges  ça fait beaucoup. Mais à quoi servent-ils ? Ils permettent d’effectuer certaines tâches systèmes. Il ne faut donc pas les confondre avec les &lt;code&gt;ACE&lt;/code&gt; (&amp;ldquo;Access Control Entry&amp;rdquo;, qui représente un droit attribuer dans une &lt;code&gt;DACL&lt;/code&gt;), car ces dernières définissent l’accès à un &lt;code&gt;SecurableObject&lt;/code&gt;. Par exemple, le droit &lt;code&gt;SeBackupPrivilege&lt;/code&gt; est donné à tout membre du groupe &lt;code&gt;Backup Operators&lt;/code&gt; et permet de lire le contenu d’un fichier peu importe ses &lt;code&gt;ACLs&lt;/code&gt; (sauf si une interdiction explicite à votre encontre est présente).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Si un privilège est présent comme SeBackupPrivilege, l'étape de comparaison avec la DACL n'est pas effectuée" src="/static/img/secu_windows/Principe d'accès à un programme-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Le droit &lt;code&gt;SeRestorePrivilege&lt;/code&gt; permet identiquement d’écrire un fichier. Le droit &lt;code&gt;SeDebugPrivilege&lt;/code&gt; (réservé aux Administrateurs), permet d’accéder et de manipuler la mémoire d’un autre programme, un programme que nous n’avons pas lancé. C’est typiquement ce droit que demande Mimikatz pour accéder aux fameux condensats de mots de passe gardé par &lt;code&gt;LSASS.exe&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Vous pouvez trouver une liste complète des droits donnés par quel privilège dans la &lt;a href="https://docs.microsoft.com/en-us/windows/win32/secauthz/privilege-constants"&gt;documentation officielle de Microsoft&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ces privilèges, sont donc naturellement très puissant et il ne faut surtout pas négliger leur sécurité, qui possède quoi. Bon, mais comment puis-je clairement savoir de quels privilèges je dispose ? La commande la plus simple pour cela est &lt;code&gt;whoami /all&lt;/code&gt;. &lt;code&gt;whoami.exe&lt;/code&gt; ouvre le &lt;code&gt;token&lt;/code&gt; d’accès de son propre processus, or comme nous l’avons dit plus tôt, ce dernier contient toutes les informations dont le système à besoin pour achever ses tâches, notamment accéder aux &lt;code&gt;SecurableObject&lt;/code&gt;. Ainsi, nous pouvons voir nos privilèges (&lt;code&gt;whoami /priv&lt;/code&gt;), nos groupes (&lt;code&gt;whoami /groups&lt;/code&gt;), notre &lt;code&gt;SID&lt;/code&gt; (&lt;code&gt;whoami /user&lt;/code&gt;) et bien d’autres. Un petit exemple, une fois connecté, je lance une invite de commande PowerShell et tape &lt;code&gt;whoami /priv&lt;/code&gt;. Par malchance, le droit semble alors désactivé.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;Windows PowerShell
Copyright (C) Microsoft Corporation. Tous droits réservés.

Testez le nouveau système multiplateforme PowerShell https://aka.ms/pscore6

PS D:\&amp;gt; whoami /priv

Informations de privilèges
----------------------

Nom de privilège              Description                                  État
============================= ============================================ =========
SeShutdownPrivilege           Arrêter le système                           Désactivé
SeChangeNotifyPrivilege       Contourner la vérification de parcours       Activé
SeUndockPrivilege             Retirer l’ordinateur de la station d’accueil Désactivé
SeIncreaseWorkingSetPrivilege Augmenter une plage de travail de processus  Désactivé
SeTimeZonePrivilege           Changer le fuseau horaire                    Désactivé
PS D:\&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Pour éteindre mon ordinateur je dois donc activer ce droit. Grâce à une magie occulte je peux l’activer (en réalité j’use simplement d’un implémentation de la fonction &lt;code&gt;RtlAdjustPrivilege&lt;/code&gt; de &lt;code&gt;NTDLL.dll&lt;/code&gt;, qui permet d’ajuster les privilèges pour notre processus, en PowerShell) et on peut alors voir que maintenant je peux éteindre mon poste.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt; RtlAdjustPrivilege -Privilege SeShutdownPrivilege -Verbose
COMMENTAIRES : [RtlAdjustPrivilege] Attempting to enable &amp;#39;SeShutdownPrivilege&amp;#39; for the current process
COMMENTAIRES : [RtlAdjustPrivilege] enable for &amp;#39;SeShutdownPrivilege&amp;#39; successful
PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt; whoami /priv

Informations de privilèges
----------------------

Nom de privilège              Description                                  État
============================= ============================================ =========
SeShutdownPrivilege           Arrêter le système                           Activé
SeChangeNotifyPrivilege       Contourner la vérification de parcours       Activé
SeUndockPrivilege             Retirer l’ordinateur de la station d’accueil Désactivé
SeIncreaseWorkingSetPrivilege Augmenter une plage de travail de processus  Désactivé
SeTimeZonePrivilege           Changer le fuseau horaire                    Désactivé
PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Sauf qu’après une partie de &amp;ldquo;CS:GO&amp;rdquo; en compagnie d’une équipe russe le &amp;ldquo;ragequit&amp;rdquo; serait quelque peu ennuyant. C’est pour cela qu’il est possible d’activer ou de désactiver des privilèges. Attention, ces derniers doivent être contenu dans notre &lt;code&gt;token&lt;/code&gt; d’accès initiale, sinon cela serait beaucoup trop facile. Lorsque nous utilisons un programme tel &amp;ldquo;shutdown.exe&amp;rdquo; il va utiliser certaines fonctions de la &lt;code&gt;WinAPI&lt;/code&gt; (&lt;a href="https://docs.microsoft.com/en-us/windows/win32/api/securitybaseapi/nf-securitybaseapi-adjusttokenprivileges"&gt;&lt;code&gt;AdjustTokenPrivileges&lt;/code&gt;&lt;/a&gt; de &lt;code&gt;advapi32.dll&lt;/code&gt; pour les curieux) pour changer ses privilèges, et de ce fait pouvoir dire adieu à notre partie gagnée d’avance.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Pour activer un privilège tel SeShutdownPrivilege, un programme comme shutdown.exe utilise AdjustTokenPrivileges" src="/static/img/secu_windows/Principe d'accès à un programme-2.png"&gt;&lt;/p&gt;
&lt;h2 id="les-listes-dacces"&gt;Les listes d’accès&lt;/h2&gt;
&lt;p&gt;Il en existe deux types. La première est la &lt;code&gt;SACL&lt;/code&gt; pour &amp;ldquo;System Access Control List&amp;rdquo; qui est vraisemblablement la plus simple. En effet, elle permet d’établir un certain nombre de règles concernant l’audit d’accès à l’objet portant cette liste. On peut alors définir dans cette dernière quel événement, pour quel utilisateur, se doit d’être inscrit dans les journaux d’événements. L’autre type se nomme &lt;code&gt;DACL&lt;/code&gt; pour &amp;ldquo;Discretionary Access Control List&amp;rdquo;. La &lt;code&gt;DACL&lt;/code&gt; contient un certains nombres d’&lt;code&gt;ACE&lt;/code&gt; (&amp;ldquo;Access Control Entry&amp;rdquo;) qui précise le type de droit accordé à un objet. Leur structure est assez élémentaire. En outre, une &lt;code&gt;ACE&lt;/code&gt; contient un header déterminant son type c’est à dire accès autorisé ou refusé et d’autres informations. Le header, quant à lui, contient le droit garantit ou non. Ce droit est appelé masque d’accès. On énumère ce que l’on appelle les droits standards qui sont élémentaires:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;DELETE&lt;/code&gt; est le droit de supprimer l’objet, je vous l’accorde il n’était pas très complexe celui-là.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;READ_CONTROL&lt;/code&gt; est le droit de lire la &lt;code&gt;SACL/DACL&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WRITE_DAC&lt;/code&gt; est le droit de modifier les entrés de la &lt;code&gt;DACL&lt;/code&gt;, c’est à dire ajouter des &lt;code&gt;ACEs&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WRITE_OWNER&lt;/code&gt; est le droit de modifier le propriétaire d’un objet, l’intérêt étant que ce dernier possède implicitement tous les droits souhaités.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ces droits standards permettent alors de construire ce que l’on appelle les droits génériques:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;GENERIC_READ&lt;/code&gt; permet, comme son nom l’indique, de lire les attributs et propriétés d’un objet. Si c’est un fichier par exemple, ce droit permet la lecture du contenu du fichier. Son équivalent sous linux est le flag &amp;ldquo;r&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GENERIC_WRITE&lt;/code&gt; permet la modification des propriétés et attributs de l’objet. Pour continuer dans le précédent exemple, ce droit permet la modification de son contenu. Son équivalent sous linux est le flag &amp;ldquo;w&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GENERIC_EXECUTE&lt;/code&gt; permet de lire les permissions d’un objet. Factuellement si c’est un programme, il permet de le lancer. Son équivalent sous linux serait le flag &amp;ldquo;x&amp;rdquo;.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;GENERIC_ALL&lt;/code&gt; est la combinaison de ces droits. Attention cependant, il est sensiblement plus fort, dans de très rare cas. Il peut s’avérer que la combinaison &lt;code&gt;GENERIC_READ/WRITE/EXECUTE&lt;/code&gt; n’est pas équivalente à &lt;code&gt;GENERIC_ALL&lt;/code&gt;, il n’a donc pas d’équivalent dans le système au pingouin.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Il en existe encore un grand nombre mais l’objectif n’est pas l’exhaustivité. Pour voir ces accès, il faut utiliser l’onglet sécurité des propriétés d’un objet. On peut également utiliser notre shell préférer aka PowerShell (là pour le coup, vous n’avez pas d’excuse car PowerShell c’est génial et opensource). Une commande particulière est destinée à cela: &lt;code&gt;Get-Acl&lt;/code&gt;. Elle prend comme argument le chemin vers notre objet, &lt;code&gt;-Path&lt;/code&gt; et ce sera globalement tout pour une utilisation simple. Le résultat retourné est alors une &amp;ldquo;table&amp;rdquo; ce qui est assez inconfortable. Pour s’affranchir de se problème d’affichage, on utilise un pipe &lt;code&gt;|&lt;/code&gt; vers la commande &lt;code&gt;Format-List&lt;/code&gt; (ou son alias &lt;code&gt;fl&lt;/code&gt;). On peut alors apercevoir entre autre le propriétaire du fichier dans notre cas, les accès accordés ainsi que le descripteur de sécurité au format &lt;code&gt;SDDL&lt;/code&gt;. &lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt; Get-Acl .\ | fl


Path   : Microsoft.PowerShell.Core\FileSystem::D:\tools\PowerShellScript\PSReflect-Functions
Owner  : DESKTOP-8Q2CUHH\Lancelot
Group  : DESKTOP-8Q2CUHH\Aucun
Access : BUILTIN\Administrateurs Allow  FullControl
         BUILTIN\Administrateurs Allow  268435456
         AUTORITE NT\Système Allow  FullControl
         AUTORITE NT\Système Allow  268435456
         AUTORITE NT\Utilisateurs authentifiés Allow  Modify, Synchronize
         AUTORITE NT\Utilisateurs authentifiés Allow  -536805376
         BUILTIN\Utilisateurs Allow  ReadAndExecute, Synchronize
         BUILTIN\Utilisateurs Allow  -1610612736
Audit  :
Sddl   : O:S-1-5-21-1739485902-3336647338-3362325240-1001G:S-1-5-21-1739485902-3336647338-3362325240-513D:(A;ID;FA;;;BA)(A;OICIIOID;GA;;;BA)(A;ID;FA;;;SY)(A;OICIIOID;GA;;;SY)(A;ID;0x1301bf;;;AU)(A;OICIIOID;SD
         GXGWGR;;;AU)(A;ID;0x1200a9;;;BU)(A;OICIIOID;GXGR;;;BU)



PS D:\tools\PowerShellScript\PSReflect-Functions&amp;gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Si vous souhaitez plus de précisions, je vous invite à lire &lt;a href="http://theredwindows.net/index.php/2021/02/12/exploitation-dacl-en-active-directory/"&gt;mon article sur l’abus d’ACL en ActiveDirectory&lt;/a&gt;&lt;/p&gt;
&lt;h1 id="resumons"&gt;Résumons&lt;/h1&gt;
&lt;p&gt;Lorsqu’un utilisateur se connecte à sa session, des informations seront gardées en mémoire dans un &lt;code&gt;token&lt;/code&gt; d’accès. Lorsqu’il souhaite démarrer un programme, une copie de son &lt;code&gt;token&lt;/code&gt; est donné. Si ce dernier interagit avec le système, il devra utiliser ses privilèges pour réaliser certaines opérations. S’il n’est pas tout le temps nécessaire de les utiliser, lorsque l’on souhaite accéder à un objet (fichier, processus …) notre &lt;code&gt;token&lt;/code&gt; d’accès sert de carte d’identité qui sera comparer avec le contenu de la &lt;code&gt;DACL&lt;/code&gt; du descripteur de sécurité de l’objet auquel le programme/utilisateur souhaite accéder. En fonction des différentes entrés dans la liste d’accès, il se verra refuser ou autoriser un certain accès.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Description" src="https://ilearned.eu.org/static/img/secu_windows/schemasitemicrosoft.png"&gt;&lt;/p&gt;
&lt;p&gt;J’espère que vous comprenez mieux à présent la manière dont l’os de Microsoft gère les permissions. Si cet article vous a plu, je vous invite à consulter mes articles sur les privilèges d’accès ainsi que sur l’abus des &lt;code&gt;ACLs&lt;/code&gt; en Active Directory (et oui même si utile aux défenseurs, ils sont aussi utile aux attaquants).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Lancelot</dc:creator><pubDate>Thu, 01 Jul 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-07-01:/secu_windows.html</guid><category>misc</category></item><item><title>Comment fonctionne le protocole TLS</title><link>https://ilearned.eu.org/tls.html</link><description>&lt;p&gt;TLS est un protocole que nous utilisons quotidiennement, il est notamment utilisé dans &lt;code&gt;HTTPS&lt;/code&gt; pour sécuriser la connexion. TLS est le successeur de SSL, nous verrons prochainement pourquoi SSL a été abandonné au profit de TLS. Dans cet article, nous étudierons TLS1.3 qui est la dernière version du protocole sortie en 2018. TLS se base à la fois sur le chiffrement asymétrique et le chiffrement symétrique. Un échange de clé (appelé handshake ou poignée de main) a lieu au début de la connexion, une clé secrète est échangée de façon asymétrique, cette clé est ensuite utilisée pour chiffrer les données (du chiffrement symétrique donc). Voyons donc plus en détail comment se passe un handshake avec TLS1.3. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Schémas d'un handshake TLS1.3" src="/static/img/tls/handshake.png"&gt;&lt;/p&gt;
&lt;p&gt;Le client envoie donc dans un premier temps un &lt;code&gt;**Client Hello**&lt;/code&gt; qui contient entre autre :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Les différents protocoles cryptographiques (pour le chiffrement asymétrique et symétrique) qu&amp;rsquo;il supporte.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Key Share&lt;/code&gt; qui correspond a la clé publique du client, vous vous demanderez surement comment le client peut bien envoyer sa clé publique s&amp;rsquo;il ne sait pas les protocoles que le serveur supporte, c&amp;rsquo;est une différence majeur par rapport à TLS 1.2, avec TLS 1.3 le client part du principe que le serveur supporte un certain nombre de protocoles et envoie sa clé publique pour un de ces protocoles, s&amp;rsquo;il s&amp;rsquo;avère que ce n&amp;rsquo;est pas le cas, le serveur va renvoyer un &lt;code&gt;HelloRetryRequest&lt;/code&gt; ainsi que les protocoles qu&amp;rsquo;il supporte.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Le serveur répond ensuite avec un &lt;code&gt;**Server Hello**&lt;/code&gt; qui contient entre autre :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Le Certificat TLS qui permet d&amp;rsquo;assurer l&amp;rsquo;authenticité du serveur.&lt;/li&gt;
&lt;li&gt;Le &lt;code&gt;Certificate Verify&lt;/code&gt; qui correspond à la signature du handshake, il est utilisé pour s&amp;rsquo;assurer que  le handshake n&amp;rsquo;a pas été modifié en cours de route (dans le cas d&amp;rsquo;un attaque &lt;a href="https://en.wikipedia.org/wiki/Man-in-the-middle_attack"&gt;Man In The Middle&lt;/a&gt; par exemple).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Change Cipher Spec&lt;/code&gt; indique à l&amp;rsquo;autre participant le passage à un mode de chiffrement symétrique.&lt;/li&gt;
&lt;li&gt;Dans &lt;code&gt;Key Share&lt;/code&gt; le serveur indique sa clé publique&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Finished&lt;/code&gt; indique enfin la fin du handshake pour le client.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Le client envoie enfin pour terminer un &lt;code&gt;Change Cipher Spec&lt;/code&gt; et &lt;code&gt;Finished&lt;/code&gt;. Vous trouverez &lt;a href="/static/misc/tls/tls_1_3.pcapng"&gt;ici 📎&lt;/a&gt; un pcap d&amp;rsquo;un requête avec TLS 1.3.&lt;/p&gt;
&lt;p&gt;En parcourant vous verrez que la version de TLS affichée est TLS 1.2, &lt;em&gt;it&amp;rsquo;s not a bug, it&amp;rsquo;s a feature&lt;/em&gt; c&amp;rsquo;est en fait pour éviter que certaines middlebox &lt;s&gt;de merde 😡&lt;/s&gt;, utilisées notamment en entreprise pour espionner le trafic, bloquent le trafic pour des version de TLS au dessus de TLS 1.2.&lt;/p&gt;
&lt;p&gt;Des paires de clés publique/privée sont dérivées un clé secrète afin de chiffrer de façon symétrique les échanges. Nous détaillerons bientôt plus en détail ce fonctionnement au travers d&amp;rsquo;ECDH.&lt;/p&gt;
&lt;p&gt;Vous l&amp;rsquo;aurez sûrement remarqué, le nom de domaine est en clair dans les requêtes, à la base une fonctionnalité appelée ESNI (Encrypted Server Name Indication) qui permet de chiffrer le nom de domaine dans les requêtes aurait dû être implémentée dans TLS 1.3 mais ce n&amp;rsquo;est pas encore le cas, ESNI n&amp;rsquo;est qu&amp;rsquo;à l&amp;rsquo;état de &lt;a href="https://www.ietf.org/archive/id/draft-ietf-tls-esni-10.html"&gt;draft&lt;/a&gt;&amp;hellip; 😕&lt;/p&gt;
&lt;p&gt;Une autre fonctionnalité importante dans TLS 1.3 est le 0 RTT, c&amp;rsquo;est une fonctionnalité très controversée car elle ne respecte pas le principe de &lt;code&gt;forward-secrecy&lt;/code&gt;, si un attaquant arrive à trouver la clé utilisée pour le chiffrement symétrique, il pourra déchiffrer toutes les prochaines requêtes. Elle consiste, pour faire simple, à garder une même clé symétrique pour plusieurs échanges afin de reprendre un échange sans avoir à faire de handshake, mais cette fonctionnalité est une fausse bonne idée&amp;hellip;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sun, 30 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-30:/tls.html</guid><category>misc</category></item><item><title>Sécuriser votre réseau local avec 802.1x</title><link>https://ilearned.eu.org/802_1x.html</link><description>&lt;p&gt;En entreprise comme dans un réseau domestique, le contrôle d&amp;rsquo;accès au LAN (réseau local) est primordial pour garantir la sécurité des données transmises sur ce réseau, on connaît tous la classique authentification par mot de passe est la méthode d&amp;rsquo;authentification utilisée dans la grand majorité des points d&amp;rsquo;accès (= AP) grand publique, mais un simple mot de passe ne permet pas, par exemple, de donner des accès différents au réseau en fonction des utilisateurs, pour pallier à ce problème, le standard 802.1x a été créé, il est normalisé dans la RFC . Ce standard s&amp;rsquo;appuie sur le protocole EAP que nous allons détailler dans cet article.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma simple fonctionnement EAP avec intermédiaire Authenticator" src="/static/img/802_1x/Frame_50.png"&gt;&lt;/p&gt;
&lt;p&gt;L&amp;rsquo;authenticator (un point d&amp;rsquo;accès wifi dans notre exemple mais la même chose peut être mis en place en Ethernet) est un intermédiaire entre l&amp;rsquo;utilisateur et l&amp;rsquo;authentication server, la majorité du temps un serveur &lt;a href="https://blog.eban.bzh/misc/RADIUS.html"&gt;RADIUS&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma d'un requête EAP" src="/static/img/802_1x/Frame_53(1).png"&gt;&lt;/p&gt;
&lt;p&gt;Identity request correspond à la demande du username au client par l&amp;rsquo;authenticator&lt;/p&gt;
&lt;p&gt;Identity response est ce nom d&amp;rsquo;utilisateur, cette information est demandée pour permettre à l&amp;rsquo;Authentication Server de savoir quelle challenge demander, il existe plusieurs types de challenge en voici quelques-uns&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;MD5&lt;/code&gt; (simple mot de passe hashé avec MD5, cette méthode est controversée car MD5 n&amp;rsquo;est pas considéré comme sécurisé).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;SIM&lt;/code&gt; (authentification basée sur la carte SIM).&lt;/li&gt;
&lt;li&gt;&lt;code&gt;NFC&lt;/code&gt; (authentification basée sur le protocole NFC, c&amp;rsquo;est par exemple utilisé sur les badges d&amp;rsquo;entreprise.)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Le ou les challenges sont ensuite envoyés tour à tour dans des paquets &lt;code&gt;Challenge Request&lt;/code&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 21 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-21:/802_1x.html</guid><category>misc</category></item><item><title>Fonctionnement de RADIUS</title><link>https://ilearned.eu.org/RADIUS.html</link><description>&lt;p&gt;Une question se pose parfois, comment gérer facilement de l&amp;rsquo;authentification et des autorisations d&amp;rsquo;utilisateur sur un réseau avec plusieurs machines sans répliquer la liste d&amp;rsquo;utilisateur avec les propriétés unique à chacun sur chaque machine.&lt;/p&gt;
&lt;p&gt;Une solution pour ce genre de cas est RADIUS, c&amp;rsquo;est un protocole qui permet d&amp;rsquo;authentifier et de donner une liste de propriété pour un utilisateur.&lt;/p&gt;
&lt;p&gt;Un cas d&amp;rsquo;usage est par exemple un stockage réseau (aussi appelé &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt;). Le serveur &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt; va demander l&amp;rsquo;utilisateur et le mot de passe au client, il va ensuite se connecter avec le serveur RADIUS pour valider l&amp;rsquo;authentification.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Demande d'accès depuis le client" src="/static/img/client_nas_radius.png"&gt;&lt;/p&gt;
&lt;p&gt;À chaque requête le &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt; transmet les identifiants que le client lui a envoyé afin de savoir s&amp;rsquo;il peut accéder à la ressource demandée. Le client RADIUS (ici le &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt;) doit s&amp;rsquo;authentifier auprès du serveur RADIUS, pour se faire il utilise un secret qui est partagé entre le serveur RADIUS et le &lt;a href="https://fr.wikipedia.org/wiki/Serveur_de_stockage_en_r%C3%A9seau"&gt;NAS&lt;/a&gt;. Ce secret permet aussi de chiffrer les identifiants de l&amp;rsquo;utilisateur via un &amp;ldquo;&lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt;&amp;rdquo;, un &lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt; est un moyen de chiffrer sur base d&amp;rsquo;une clé unique, on parle donc de chiffrement symétrique.&lt;/p&gt;
&lt;p&gt;La communication entre le serveur RADIUS et son client se base sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; (il peut aussi passer par &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, mais nous n&amp;rsquo;en parlerons pas), le client doit donc être capable de gérer la retransmission dans le cas ou aucune réponse ne lui est accordée.&lt;/p&gt;
&lt;p&gt;La phase d&amp;rsquo;authentification du client se base sur un paquet contenant l&amp;rsquo;utilisateur et le mot de passe. Ce paquet est nommé &lt;code&gt;Access Challenge&lt;/code&gt;, il contient par exemple l&amp;rsquo;attribut &lt;code&gt;User-Name = ramle&lt;/code&gt; et &lt;code&gt;User-Passsword = phrase-de-passe&lt;/code&gt;. Le client reçoit ensuite une réponse du serveur, si le client RADIUS n&amp;rsquo;est pas connu du serveur il ne recevra pas de réponse. Si le client est connu alors, le serveur peut répondre de 3 manières &lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;Access-Accept&lt;/code&gt; en cas d&amp;rsquo;identifiant valide&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Access-Reject&lt;/code&gt; en cas d&amp;rsquo;identifiant invalide&lt;/li&gt;
&lt;li&gt;&lt;code&gt;Acces-Challenge&lt;/code&gt; si l&amp;rsquo;authentification requiert plus de paramètre, par exemple un code PIN ou un carte d&amp;rsquo;accès.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La réponse du serveur inclut aussi des informations supplémentaire appelé &lt;code&gt;attribut&lt;/code&gt;, ce champs peut contenir des informations sur l&amp;rsquo;adresse IP qui doit être assigné à l&amp;rsquo;appareil, à la VLAN dans le quel il doit se trouver et bien d&amp;rsquo;autre paramètre.&lt;/p&gt;
&lt;p&gt;Le paquet RADIUS se forme en plusieurs partie :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Code&lt;/strong&gt; : Il définit le type de paquet&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Identifier&lt;/strong&gt; : Il identifie le paquet, ce mécanisme permet de détecter une duplication, ou de savoir à quelle demande correspond la réponse car la réponse garde le même identifiant que la demande.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Authenticator :&lt;/strong&gt; Il authentifie la demande du client ou du serveur&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Attributes&lt;/strong&gt; : il permet de donner les attributs spécifiques au client&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Paquet RADIUS" src="/static/img/paquet_radius.png"&gt;&lt;/p&gt;
&lt;p&gt;La partie &lt;code&gt;Authenticator&lt;/code&gt; du paquet dans la requête &lt;code&gt;Access Challenge&lt;/code&gt; est intéressante à étudier, cette partie ne contient que 16bits et nécessite un haut taux de confidentialité car il contient le mot de passe utilisateur. On utilise &lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt; et le secret évoqué plus haut, dans le cas ou le password est trop long, il est alors hashé en MD5 puis transformé via un &lt;a href="https://fr.wikipedia.org/wiki/Fonction_OU_exclusif"&gt;xor&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;RADIUS gère aussi l&amp;rsquo;itinérance, le serveur RADIUS du réseau local fera donc un proxy pour renvoyer la requête au serveur qui gère l&amp;rsquo;utilisateur. Le canal peut être sécurisé de plusieurs manières, soit un tunnel chiffré entre les 2, ou bien en sécurisant le canal avec le protocole TLS.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Riaming Raadius" src="/static/img/roaming_radius.png"&gt;&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;espère que cette article vous aura plus :), on se retrouve demain pour parler de &lt;strong&gt;802.1x&lt;/strong&gt;, un protocole utilisant RADIUS.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Thu, 20 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-20:/RADIUS.html</guid><category>misc</category></item><item><title>Comment fonctionne HTTP/3 ?</title><link>https://ilearned.eu.org/http3.html</link><description>&lt;p&gt;Il n&amp;rsquo;y a pas longtemps nous avions découvert le fonctionnement d&amp;rsquo;&lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt;, et différentes versions de ce protocoles, mais l&amp;rsquo;une d&amp;rsquo;elle n&amp;rsquo;a pas été vue : HTTP/3, cette version apporte un changement sur la méthode de transport en se basant sur QUIC qui lui même utilise &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; au lieu de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Pour commencer, regardons de plus près QUIC, il existe pour le moment deux versions de ce protocole, une faite par Google qui n&amp;rsquo;a pas été standardisée, et une qui est en cours de rédaction pour être publiée sous forme d&amp;rsquo;une RFC à l&amp;rsquo;IETF (l&amp;rsquo;organe qui s&amp;rsquo;occupe de la publication des RFC). La version de Google se concentre sur HTTP/3, contrairement à la version de l&amp;rsquo;IETF qui veut faire de QUIC un protocole de transport servant pour d&amp;rsquo;autres usages que &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt;, pour le &lt;a href="https://blog.eban.bzh/today-i-learned/les-bases-du-dns.html"&gt;DNS&lt;/a&gt; par exemple.&lt;/p&gt;
&lt;p&gt;Pour le moment l&amp;rsquo;IETF (qui se base en partie sur les travaux de Google) est encore au stade de rédaction de la norme et se concentre sur HTTP/3 comme usage pour la première version. Cet article se basera sur les travaux de l&amp;rsquo;IETF et non ceux de Google.&lt;/p&gt;
&lt;p&gt;Pour commencer, QUIC se base sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; et veut résoudre certains problème de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, avec HTTP/2 par exemple, plusieurs transferts sont effectués sur un seul flux &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, je vous renvoie vers l&amp;rsquo;article sur &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt; qui explique en détail ce concept, avec &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; si dans la liste des paquets en attente un paquet se perd tous les paquets avant celui perdu devront attendre le renvoi. On peut faire un parallèle avec un embouteillage de voiture, si une voiture bloque la route, celles qui précèdent la voiture devront attendre son passage.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Congestion des paquets" src="/static/img/congestion_http.png"&gt;&lt;/p&gt;
&lt;p&gt;TCP rajoute aussi une latence importante due aux différents handshakes, &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; n&amp;rsquo;utilise pas de séquence de handshake. QUIC en rajoute pour assurer un minimum de fiabilité. On compte au total 4 aller-retours pour récupérer une page (ou un code d&amp;rsquo;erreur) contre 6 dans les versions d&amp;rsquo;HTTP basée sur &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;. Le client commence par l&amp;rsquo;envoi d&amp;rsquo;un &amp;ldquo;hello&amp;rdquo; pour donner différents paramètres sur lui, ensuite le serveur répond en envoyant directement le certificat et les informations pour commencer l&amp;rsquo;échange de donnée, le client envoie ensuite sa requête avec la méthode. Le client finit par y répondre par le code de retour ou la page demandée.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comparaison handshake HTTP vs HTTP/3" src="/static/img/http_handshake_vs.png"&gt;&lt;/p&gt;
&lt;p&gt;QUIC fonctionne sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; comme dit plus haut, il force un certain niveau de sécurité en imposant TLS en version 1.3, pour les communications. Il offre aussi une certaine fiabilité qu&amp;rsquo;UDP ne possède pas, rappelez-vous, &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; ne vérifie rien. QUIC résout ce problème en ajoutant une couche qui permet de gérer une retransmission de paquet au cas où celui-ci se perdrait en chemin, il permet aussi un contrôle de la congestion, la congestion en réseau c&amp;rsquo;est la saturation du réseau en lui même, cela cause un ralentissement ou une perte de paquet dans les cas extrêmes, le protocole est donc pas loin de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; sur la fiabilité.&lt;/p&gt;
&lt;p&gt;Sur un seul canal &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt;, QUIC permet de faire placer plusieurs flux en simultané.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Canal QUIC" src="/static/img/quic.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour le moment, nous avons vu principalement QUIC, la raison est que HTTP/3 n&amp;rsquo;apporte pas grand chose, c&amp;rsquo;est HTTP/2 adapté pour passer au dessus de QUIC, il y a quelques différences mineures comme la compression des en-têtes qui est adapté au protocole, mais les modifications sont mineure et viennent surtout adapté &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt; pour QUIC. Le rapprochement avec HTTP/2 est plutôt logique d&amp;rsquo;ailleurs si on regarde la chronologie le travail sur HTTP/3 à commencé dans la même période.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Couche HTTP/3" src="/static/img/couche_http3.png"&gt;&lt;/p&gt;
&lt;p&gt;Un point utile à aborder est de savoir comment le client sait si il doit communiqué en HTTP/3 ou non. En effet, les anciennes version d&amp;rsquo;HTTP utilise &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; contrairement à HTTP/3 qui utilise &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt;. Pour informer le navigateur de la présence d&amp;rsquo;HTTP/3 l&amp;rsquo;en-tête &lt;code&gt;Alt-Svc&lt;/code&gt; à été crée, elle indique le port &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; sur le quel le client doit aller voir, on peut aussi via l&amp;rsquo;en-tête indiquer un domaine différent.&lt;/p&gt;
&lt;p&gt;L&amp;rsquo;amélioration qu&amp;rsquo;apporte HTTP/3 est relativement mineure mais se révèle assez utile, sur une connexion stable avec peu de perte de paquet la différence n&amp;rsquo;est pas forcément visible, mais sur un réseau saturé avec un grand nombre de perte ne pas renvoyer toute la queue à chaque perte est un gain non négligeable. Une observation faite par certains est que HTTP/3 demande plus de CPU pour le serveur, ça peut être un frein pour le déploiement. Il faut aussi gardé en tête que QUIC est assez nouveau, les implémentations ne sont pas encore parfaite, le temps dira si ce protocole vaut le coup ou non.&lt;/p&gt;
&lt;p&gt;Niveau performance, HTTP/3 apporte un gain au niveau de la latence grâce à la poignée de main réduite, pour ce qui est de la vitesse de chargement, la prioritisation des flux, et la possibilité d&amp;rsquo;envoyer sur plusieurs flux en simultané permet de gagner un peu. Selon &lt;a href="https://blog.cloudflare.com/http-3-vs-http-2/"&gt;Cloudflare&lt;/a&gt; HTTP/3 améliore le temps d&amp;rsquo;établissement de la première connexion de 12,4%, pour ce qui est du chargement d&amp;rsquo;une page, ici leur propre blog, le temps diminue entre 1 et 4%, c&amp;rsquo;est au final assez peu, mais sur une connexions assez lente quelques pour-cent n&amp;rsquo;est pas négligeable.&lt;/p&gt;
&lt;p&gt;Si vous regardez un peu en détail votre navigateur vous remarquerez qu&amp;rsquo;HTTP/3 n&amp;rsquo;est pas encore activé par défaut, en effet ce protocole bien que prometteur n&amp;rsquo;est pas encore standardisé et est très minoritaire. Si par curiosité vous voulez tout de même activé dans &lt;code&gt;about:config&lt;/code&gt; sur votre firefox vous pouvez changez la configuration &lt;code&gt;network.http.http3.enabled&lt;/code&gt; vers &lt;code&gt;true&lt;/code&gt;. Sachez toutefois que des sites comme celui de Cloudflare où de Google intègrent déjà HTTP/3 ! &lt;/p&gt;
&lt;p&gt;J&amp;rsquo;espère que cet article vous aura plus :), on se retrouve demain pour parler de &lt;strong&gt;radius.&lt;/strong&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Tue, 18 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-18:/http3.html</guid><category>misc</category></item><item><title>Sécuriser NTP, à quoi bon ?</title><link>https://ilearned.eu.org/securiser_ntp.html</link><description>&lt;p&gt;Nous avons vu jeudi comment fonctionne le protocole NTP mais il reste un dernier point à aborder, comment assurer l&amp;rsquo;intégrité des données transmises via NTP ? Vous vous demanderez sûrement, à quoi bon sécuriser le protocole NTP, alors qu&amp;rsquo;il ne transmet que le temps 🤔. Le temps est une donnée très importante en informatique, plus qu&amp;rsquo;on ne pourrait le penser de prime abord, il est utilisé dans de nombreux protocoles cryptographiques, comme par exemple dans &lt;code&gt;TLS&lt;/code&gt; ou &lt;a href="https://blog.eban.bzh/today-i-learned/dnssec.html"&gt;&lt;code&gt;DNSSEC&lt;/code&gt;&lt;/a&gt; avec le système de TTL (time to live). Pour sécuriser NTP de nombreux protocoles ont été proposés et mis en place, nous en citerons ici trois.&lt;/p&gt;
&lt;h2 id="le-chiffrement-symetrique"&gt;Le chiffrement symétrique&lt;/h2&gt;
&lt;p&gt;Dans NTP3 est ajouté le système d&amp;rsquo;authentification par clés symétriques, un secret partagé est échangé la première fois entre le client et le serveur et c&amp;rsquo;est ce secret qui est ensuite utilisé pour sécuriser la connexion. Mais cette méthode pose un gros problème, il est nécessaire d&amp;rsquo;échanger une clé secrète la première fois, elle est donc très difficilement automatisable et impossible à déployer à grand échelle.&lt;/p&gt;
&lt;h2 id="autokey"&gt;Autokey&lt;/h2&gt;
&lt;p&gt;Une autre approche a été &lt;code&gt;autokey&lt;/code&gt;, ce système utilisé du &lt;a href="https://fr.wikipedia.org/wiki/Cryptographie_asym%C3%A9trique"&gt;chiffrement asymétrique&lt;/a&gt; et résous donc les problèmes qui se posaient avec le chiffrement symétrique, en partie seulement, car le protocole &lt;code&gt;autokey&lt;/code&gt; a de grosses lacunes en terme de sécurité, un comble, effet la taille du cookie utilisé pour s&amp;rsquo;authentifier avec autokey est de seulement 32 bits, ce qui le rend très vulnérable, mais ce n&amp;rsquo;est pas le seul problème d&amp;rsquo;autokey, le client n&amp;rsquo;est identifié que par son IP, un attaquant pourrait donc se faire passer pour le client et dérober le cookie.&lt;/p&gt;
&lt;h2 id="network-time-security-nts"&gt;Network Time Security (NTS)&lt;/h2&gt;
&lt;p&gt;Pour pallier aux faiblesses de ces deux protocoles, un nouveau protocole est un cours de création, NTS (standardisé dans la &lt;a href="https://datatracker.ietf.org/doc/rfc8915/"&gt;RFC 8915&lt;/a&gt; il se base sur le principe du chiffrement asymétrique sans les problèmes d&amp;rsquo;autokey. Ce protocole se base en partie sur TLS pour l&amp;rsquo;échange de clés, il utilise ensuite les parties des headers spécifiques à NTP pour sécuriser le reste de la connexion. C&amp;rsquo;est un protocole prometteur mais qui n&amp;rsquo;est malheureusement pas encore assez implémenté.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 15 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-15:/securiser_ntp.html</guid><category>misc</category></item><item><title>NTP, comment ça marche ?</title><link>https://ilearned.eu.org/ntp.html</link><description>&lt;p&gt;Depuis la démocratisation d&amp;rsquo;internet et de l&amp;rsquo;informatique en général, une question s&amp;rsquo;est posée, comment faire en sorte que les horloges de tous les ordinateurs soient coordonnées ? En septembre 1985 une première version du protocole NTP (Network Time Protocol) est publiée dans la &lt;a href="https://datatracker.ietf.org/doc/html/rfc958"&gt;RFC 958&lt;/a&gt;, ce protocole se base sur &lt;a href="https://blog.eban.bzh/today-i-learned/udp.html"&gt;UDP&lt;/a&gt; pour sa légèreté. NTP fonctionne sur une typologie de réseau dite &lt;em&gt;mesh&lt;/em&gt;, elle est découpée en strates afin de délivrer un temps équivalent partout et d&amp;rsquo;assurer une redondance. &lt;/p&gt;
&lt;p&gt;&lt;img alt="L'architecture de NTP" src="/static/img/ntp/schema_archi.png"&gt;&lt;/p&gt;
&lt;p&gt;Les serveurs de strate 1 sont les horloges principales, le temps qu&amp;rsquo;elles donne peut provenir de différentes sources comme le &lt;a href="https://en.wikipedia.org/wiki/Global_Positioning_System"&gt;GPS&lt;/a&gt; ou une &lt;a href="https://fr.wikipedia.org/wiki/Horloge_atomique"&gt;horloge atomique&lt;/a&gt;. Les serveurs des strates plus basse s&amp;rsquo;échangent entre eux leur temps afin de vérifier qu&amp;rsquo;il correspond bien. Quand nous, utilisateurs, accédons à un serveur NTP, on accède bien souvent à un serveur de strate 2 ou 3.&lt;/p&gt;
&lt;p&gt;Voici à quoi ressemble une requête NTP : &lt;/p&gt;
&lt;p&gt;&lt;img alt="Les headers d'une requête NTP" src="/static/img/ntp/schema_headers.png"&gt;&lt;/p&gt;
&lt;p&gt;Ça fait pas mal de parties 😄. Nous ne commenterons ici que les plus importantes.&lt;/p&gt;
&lt;p&gt;LI, Leap Indicator indique une &lt;a href="https://fr.m.wikipedia.org/wiki/Seconde_intercalaire"&gt;seconde intercalaire&lt;/a&gt; imminente. Une seconde intercalaire correspond, pour faire simple, à une seconde ajoutée sur toutes les horloges occasionnellement afin de synchroniser le temps universel coordonné (UTC) avec le temps solaire. &lt;/p&gt;
&lt;p&gt;VN, Version Number indique simplement la version de NTP utilisée.&lt;/p&gt;
&lt;p&gt;Mode, indique le mode dans lequel est l&amp;rsquo;émetteur, client, serveur etc.&lt;/p&gt;
&lt;p&gt;Poll correspond à l&amp;rsquo;intervalle à laquelle le client doit reinterroger le serveur NTP.&lt;/p&gt;
&lt;p&gt;Root delay correspond au temps pour faire un aller-retour vers un serveur de strate 1. Et root dispersion est une estimation de la marge d&amp;rsquo;erreur du serveur de strate 1.&lt;/p&gt;
&lt;p&gt;Reference ID correspond au type d&amp;rsquo;outil utilisé par le serveur root (strate 1) comme par exemple le GPS ou une horloge atomique.&lt;/p&gt;
&lt;p&gt;Reference Timestamp est le temps de la dernière mise à jour via NTP. &lt;/p&gt;
&lt;p&gt;Les trois autres timestamps sont décris ci-dessous &lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma représentant les différents timestamp" src="/static/img/ntp/schema_timestamps.png"&gt;&lt;/p&gt;
&lt;p&gt;Le &lt;code&gt;destination timestamp&lt;/code&gt; n&amp;rsquo;est logiquement pas inclut dans les headers, il est dans ce schéma à titre informatif.&lt;/p&gt;
&lt;p&gt;Ça fait beaucoup de paramètres 😅 Mais grâce à toutes ces informations on peut avoir une précision de l&amp;rsquo;ordre de quelques nanosecondes en soustrayant le temps de transfert !&lt;/p&gt;
&lt;p&gt;Un dernier problème se pose, comment assurer le fait que le serveur NTP ne se fasse pas usurper ? Nous avons déjà étudié dans d&amp;rsquo;autres articles des moyens de signature cryptographique, NTP implémente aussi une solution de ce type que nous étudierons très prochainement :). &lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, j&amp;rsquo;espère qu&amp;rsquo;il vous a plu 😄.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Thu, 13 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-13:/ntp.html</guid><category>misc</category></item><item><title>Comprendre le protocole UDP</title><link>https://ilearned.eu.org/udp.html</link><description>&lt;p&gt;Nous avions récemment vu le fonctionnement de &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;, ce protocole essaye d&amp;rsquo;avoir la meilleur fiabilité possible pour la transmission, mais un certain nombre d&amp;rsquo;échanges sont requis pour vérifier l’intégrité du flux ce qui rajoute de la latence qui dans certains cas, est problématique. UDP est un protocole qui tente de résoudre ce problème.&lt;/p&gt;
&lt;p&gt;UDP est l&amp;rsquo;acronyme de User Datagram Protocol (traduit par protocole de datagramme utilisateur), ce protocole se base sur IP et fait partie de la couche transport du &lt;a href="https://fr.wikipedia.org/wiki/Mod%C3%A8le_OSI"&gt;modèle OSI&lt;/a&gt;. Contrairement à TCP il ne fait pas de &amp;ldquo;poignée de main&amp;rdquo; (ou handshake en anglais) et ne nécessite pas d&amp;rsquo;accusé de réception (ACK), cette manière de fonctionner le rend plus tolérant à un réseau défectueux et lui permet un latence plus faible. Il n&amp;rsquo;est utile que dans des cas où une perte de paquet ne pose pas un soucis important. UDP est utilisé dans certains protocole très utilisé comme NTP, DNS, ou plus généralement les applications qui ont besoins de temps réel comme les jeux vidéo ou certains services de streaming.&lt;/p&gt;
&lt;p&gt;Comme je l&amp;rsquo;ai dis plus haut UDP ne vérifie pas la bonne réception d&amp;rsquo;un paquet (contrairement à TCP avec son système d&amp;rsquo;ACK), la machine envoie donc le paquet sans forcément attendre un retour. Ce protocole est bien plus simple que TCP dans sa conception. Un paquet UDP se compose tel que décrit sur ce schéma :&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma d'une trame UDP" src="/static/img/udp/schema_trame.png"&gt;&lt;/p&gt;
&lt;p&gt;Comme on peut le voir, il y a un minimum d&amp;rsquo;information comparé à TCP, le port source qui permet si besoin de répondre, le port de destination, la longueur totale du segment UDP (données comprises), une somme de contrôle (hash) et les données en elle même, chaque entrée de l&amp;rsquo;en-tête fait 16 bits ce qui au total fait 64 bits pour la partie header contre 192 avec TCP ! La partie données a une longueur variable.&lt;/p&gt;
&lt;p&gt;Comme à notre habitude, regardons une capture réseau :
&lt;img alt="Capture d'une requête DNS" src="/static/img/dns_capture.png"&gt;
On remarque directement la simplicité, 2 requêtes seulement pour un aller retour, chaque paquet est aussi assez léger, moins de 100 octets à chaque fois, pour ce qui est des nombres &amp;ldquo;0.000000&amp;rdquo; et 0.000093&amp;rdquo; il s&amp;rsquo;agit du temps où ont été capturés chaque paquet. Si vous voulez regarder plus en profondeur la capture réseau, je vous laisse le fichier disponible &lt;a href="/static/misc/dns.pcap"&gt;ici&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour cet article sur UDP, j&amp;rsquo;espère que vous l&amp;rsquo;aurez apprécié. On se retrouve demain pour parler de &lt;strong&gt;NTP&lt;/strong&gt; :).&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Wed, 12 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-12:/udp.html</guid><category>Today I Learned</category></item><item><title>Décentraliser, une priorité</title><link>https://ilearned.eu.org/decentralisation.html</link><description>&lt;p&gt;Internet est un grand réseau de réseau tous interconnectés de manière différentes, la conception permet en théorie une redondance importante, mais dans les faits ce n&amp;rsquo;est pas forcément le cas. En effet, beaucoup de services sont concentrer sur un nombre retreint d&amp;rsquo;acteur&lt;/p&gt;
&lt;p&gt;La concentration de ressource chez un nombre restreint d&amp;rsquo;acteurs pose un soucis, si un acteur tombe au plus il est utilisé au plus le nombre de personnes impactées sera important, c&amp;rsquo;est ce pour quoi ne pas passer par les géants d&amp;rsquo;un secteur est un choix non négligeable, cela permet une meilleur redondance d&amp;rsquo;internet.&lt;/p&gt;
&lt;p&gt;Une autre problématique d&amp;rsquo;utiliser des gros acteurs est leur possibilité à imposer des conditions pas forcément éthique, par exemple Cloudflare, qui promet une protection contre les dénis de services, mais au vu du coups d&amp;rsquo;une infrastructure contre les attaques par déni de service leur service gratuit n&amp;rsquo;est en réalité qu&amp;rsquo;un bon coup de pub pour leur offres payantes, qui est devant un grand nombre de sites, dans un premier temps si ils tombent internet le ressent de manière exagérée, en plus d&amp;rsquo;empêcher une navigation agréable au utilisateur du réseau Tor. Qui je le rappelle, ne sert pas forcément qu&amp;rsquo;aux cybercriminels comme aime le faire croire certains article :), ce réseau sert aussi à contourner des blocage en vigueur dans certains pays, ou à éviter l&amp;rsquo;espionnage. Il n&amp;rsquo;y a bien sur pas que Cloudflare qui pose soucis, je les cites parce que je vois une recrudescence de son utilisation, qui, qui plus est n&amp;rsquo;est pas forcément justifié ou utile je vous invite à lire &lt;a href="https://codeberg.org/crimeflare/cloudflare-tor.git"&gt;https://codeberg.org/crimeflare/cloudflare-tor.git&lt;/a&gt;. Bien sur ce ne sont pas les seuls, tous les grands acteurs comme Amazon avec AWS, Google avec GCP ou encore, bien que peu présent dans nos contrées, Alibaba Cloud.&lt;/p&gt;
&lt;p&gt;Il n&amp;rsquo;y a bien sur pas que l&amp;rsquo;hébergeur qui est important, mais les différents services qu&amp;rsquo;en temps qu&amp;rsquo;utilisateurs finaux nous sommes amenés à utiliser. Souvent ces outils sont très pratiques, mais que faire si celui ci n&amp;rsquo;est pas en ligne, l&amp;rsquo;entreprise disparait ou tout simplement supprime vos données ? Ce ne sont pas des cas inventés, pour ce qui est de l&amp;rsquo;indisponibilité on peut simplement observer les géants, Google avait une panne presque total à cause d&amp;rsquo;un quota (https://status.cloud.google.com/incident/zall/20013) de disque rempli. Pour ce qui est de la disparition de géant on peut regarde Yahoo, qui fut un temps était leader et n&amp;rsquo;est plus qu&amp;rsquo;un souvenir de nos jours. La suppression de contenu est un cas plus &amp;ldquo;compliqué&amp;rdquo; à aborder, souvent les conditions d&amp;rsquo;utilisations que vous acceptez en utilisant un service stipulent un grand nombre de raisons qui permettent sans trop de difficultés d’évincer un compte on peut prendre l&amp;rsquo;exemple de YouTube, bien connu pour ce genre de pratique, qui va jusqu&amp;rsquo;à fermer certaines chaines qui parlent de sécurité informatique, il y a aussi Github qui a supprimé youtube-dl de sa plateforme sur une demande illégitime, youtube-dl est de nouveau présent sur Github mais sans une communauté solide il est compliqué de contrer une telle suppression.&lt;/p&gt;
&lt;p&gt;Tout centraliser au même endroit pose aussi un soucis de vie privée, si par exemple vous avez vos mails, vos fichiers, votre agenda chez un seul acteur celui peut revendre ou utiliser ces données à des fin plus ou moins douteuses, et même si l&amp;rsquo;acteur est honnête, un pirate qui réussirait à s&amp;rsquo;introduire dans le système y trouverait une mine d&amp;rsquo;or pour usurper une identité, revendre à des agences de publicités etc.&lt;/p&gt;
&lt;p&gt;Après avoir parlé des problématique, il est intéressant de regarder les solutions. Pour ce qui est des réseaux sociaux il existe des alternatives comme Mastodon en équivalent à Twitter ou Facebook, pour Instagram je vous conseille Pixelfed et pour Youtube il y a PeerTube, ces solutions peuvent poser un problème, leur manque d&amp;rsquo;utilisateur mais ce n&amp;rsquo;est pas pour autant que aucun contenu de qualité y est présent, bien au contraire il y a beaucoup de contenu très qualitatif.&lt;/p&gt;
&lt;p&gt;Un soucis de ce genre de solution c&amp;rsquo;est l&amp;rsquo;hébergement, tout le monde n&amp;rsquo;a pas forcément l&amp;rsquo;envie de gérer soit même une instance, ou bien même la compétence. Pour palier à ça il y a un collectif : &lt;a href="https://chatons.org"&gt;https://chatons.org&lt;/a&gt; qui liste un nombre d&amp;rsquo;association.&lt;/p&gt;
&lt;p&gt;Pour ce qui est du choix d&amp;rsquo;un hébergeur autre que les géants on peut regarder dans un premier temps les entreprises plus locales, par exemple ce blog est hébergé chez &lt;a href="https://www.tetaneutral.net/"&gt;https://www.tetaneutral.net/&lt;/a&gt; une petite association française, en hébergeurs plus &amp;ldquo;business&amp;rdquo; il y a en France de très bonnes entreprises, comme Scaleway ou OVH.&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;espère que cette article plus politique est moins technique vous aura plus :).
Nous aimerions remercier toutes les personnes suivant régulièrement ce blog, les statistiques sont incroyables, au début nous pensions juste avoir quelques visiteurs mais c&amp;rsquo;est tout le contraire qui s&amp;rsquo;est produit, encore hier nous avons plus de 300 personnes qui sont passées sur le blog et certains articles comme celui sur TCP a reçu plus de 1300 vues ! Les commentaires que vous laissez pour des corrections, ou des remerciements nous motivent aussi beaucoup, alors un grand merci 😊.&lt;/p&gt;
&lt;p&gt;Nous avons un dernier messages, poster tous les jours deviens de plus en plus compliqué surtout avec la reprise des cours en présentiel et la période d&amp;rsquo;examens qui approche, c&amp;rsquo;est pour cela que l&amp;rsquo;on passe maintenant à un post deux jours sur trois, au lieu de chaque jours. Ce qui fait que ce n&amp;rsquo;est pas demain qu&amp;rsquo;on se retrouve, mais mercredi pour parler de &lt;strong&gt;UDP&lt;/strong&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Mon, 10 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-10:/decentralisation.html</guid><category>misc</category></item><item><title>Comment fonctionne le tracking par ETag</title><link>https://ilearned.eu.org/etag.html</link><description>&lt;p&gt;De plus en plus de navigateurs mettent en place des mesures pour bloquer le tracking, Firefox par exemple, &lt;a href="https://blog.mozilla.org/blog/2019/09/03/todays-firefox-blocks-third-party-tracking-cookies-and-cryptomining-by-default/"&gt;bloque&lt;/a&gt; par défaut les cookies third party. Pour contourner ces mesures de protection des utilisateurs, les entreprises de tracking sont à la recherche d&amp;rsquo;autres moyens de pister les utilisateurs, ETag est l&amp;rsquo;un d&amp;rsquo;eux. Nous en avons brièvement parlé dans l&amp;rsquo;article sur &lt;a href="https://blog.eban.bzh/today-i-learned/http.html"&gt;HTTP&lt;/a&gt;, l&amp;rsquo;en-tête ETag est dans le cas du serveur web &lt;a href="https://www.nginx.com/"&gt;Nginx&lt;/a&gt; que nous prendrons comme exemple ici, un condensat de la date de modification et de la longueur (lenght) du fichier demandé. Ce hash a été créé pour permettre au navigateur de savoir s&amp;rsquo;il y a eu des changements sur un fichier et s&amp;rsquo;il doit montrer la version du fichier conservée en cache à l&amp;rsquo;utilisateur ou télécharger à nouveau le fichier depuis le serveur.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma décrivant le fonctionnement de base des ETags" src="/static/img/etag/etag_fonctionnement_base.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma décrivant le fonctionnement des ETags, lorsque ceux du client et du serveur ne correspondent pas" src="/static/img/etag/etag_not_same.png"&gt;&lt;/p&gt;
&lt;p&gt;Ce système d&amp;rsquo;ETag peut cependant être détourné, afin de vérifier si les ETag correspondent, le client envoie l&amp;rsquo;ETag de la version qu&amp;rsquo;il a du fichier au serveur, le serveur peut donc, pour chaque utilisateur, servir un fichier différent (qui aura donc un ETag différent) et grâce à cet ETag savoir quel utilisateur a consulté quelle page à quelle moment. Des entreprises comme &lt;a href="https://www.extremetech.com/internet/91966-aol-spotify-gigaom-etsy-kissmetrics-sued-over-undeletable-tracking-cookies"&gt;Hulu ou Spotify&lt;/a&gt; ont été épinglées pour avoir mis en place cette pratique, qui ne respecte évidemment pas le RGPD. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma décrivant le fonctionnement du tracking via ETag" src="/static/img/etag/etag_based_tracking.png"&gt;&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, en espérant qu&amp;rsquo;il a été clair :) On se retrouve demain pour parler de décentralisation !&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sun, 09 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-09:/etag.html</guid><category>misc</category></item><item><title>Le fonctionnement d'HTTP</title><link>https://ilearned.eu.org/http.html</link><description>&lt;p&gt;Le web est l&amp;rsquo;usage le plus connu d&amp;rsquo;internet, un protocole assez vieux (mais pas aussi vieux qu&amp;rsquo;internet) se cache derrière ce succès : HTTP.&lt;/p&gt;
&lt;p&gt;HTTP est l&amp;rsquo;acronyme d&amp;rsquo;Hyper Text Transfer Protocol (protocole de transfert hypertexte si l&amp;rsquo;on traduit en français), il a été inventé pour palier à certains manques de FTP qui à l&amp;rsquo;époque était majoritaire, un des points principaux est la notion de format de données, c&amp;rsquo;est à dire indiquer au client quel est le type de donnée, cela permet au client de pouvoir interpréter et afficher sans demander à l&amp;rsquo;utilisateur ce qu&amp;rsquo;il doit faire de chaque fichier. Cette notion de &amp;ldquo;format de données&amp;rdquo; s&amp;rsquo;appelle le MIME.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma sur le MIME" src="/static/img/mime.png"&gt;&lt;/p&gt;
&lt;p&gt;HTTP a connu plusieurs versions, l&amp;rsquo;initiale étant la 0.9 (notée HTTP/0.9) qui n&amp;rsquo;a jamais été standardisée dans une RFC, une RFC (pour request for comment, soit demande de commentaires en français) est un document technique identifié par un numéro définissant des procédures ou protocoles, ces documents sont accessibles sur &lt;a href="https://www.rfc-editor.org/rfc/"&gt;https://www.rfc-editor.org/rfc/&lt;/a&gt; (ou gemini://gemini.bortzmeyer.org/rfc-mirror/rfc-index.gmi via &lt;a href="https://blog.eban.bzh/today-i-learned/gemini.html"&gt;Gemini&lt;/a&gt;), l&amp;rsquo;usage de cette version d&amp;rsquo;HTTP est assez marginal de nos jours. Quelques années plus tard est sorti au travers d&amp;rsquo;une RFC (la &lt;a href="https://www.rfc-editor.org/rfc/rfc1945.html"&gt;1945&lt;/a&gt;) HTTP/1.0 cette RFC s&amp;rsquo;occupe surtout de préciser comment HTTP fonctionne, il n&amp;rsquo;apporte pas d&amp;rsquo;évolution avec la version 0.9. Assez rapidement HTTP/1.1 sort, cette version apporte certaines optimisations, comme l&amp;rsquo;envoi de plusieurs requêtes en simultané.&lt;/p&gt;
&lt;p&gt;Le fonctionnement d&amp;rsquo;HTTP se base sur le &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;protocole TCP&lt;/a&gt;, par défaut le port utilisé est le 80. Pour demander ou envoyer des contenus on utilise des &amp;ldquo;méthodes&amp;rdquo;, une méthode est une commande envoyée au serveur. On peut en citer plusieurs :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;GET : Demande une ressource&lt;/li&gt;
&lt;li&gt;HEAD : Demande uniquement les informations&lt;/li&gt;
&lt;li&gt;POST : Envoie des données&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;La liste n&amp;rsquo;est pas complète, je vous laisse rechercher par vous même pour plus d&amp;rsquo;informations à ce propos ;).&lt;/p&gt;
&lt;p&gt;On peut regarder plus en profondeur HTTP en regardant les transmissions réseaux :
&lt;img alt="Schéma capture réseau HTTP" src="/static/img/capture_http.png"&gt;
La partie data, celle qui contient la page en elle même n&amp;rsquo;est pas directement visible ici, je vous laisse regarder le dump réseau sur wireshark, il est disponible &lt;a href="/static/misc/http.pcap"&gt;ici&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Un autre aspect intéressant d&amp;rsquo;HTTP sont les en-têtes (headers) qui donnent des informations au client à propos du serveur, et inversement. Côté client par exemple, on a l&amp;rsquo;en-tête &amp;ldquo;Host&amp;rdquo; qui donne le nom de domaine demandé par le client, cela permet de distribuer un contenu différent en fonction de celui-ci. Le serveur peut lui donner le type de contenu via &amp;ldquo;Content-Type&amp;rdquo;. Il y a beaucoup d&amp;rsquo;autres en-têtes possibles, si vous voulez regarder celle d&amp;rsquo;une URL la commande &lt;code&gt;curl&lt;/code&gt; le permet via l&amp;rsquo;option &lt;code&gt;-I&lt;/code&gt;, pour &lt;a href="https://ramle.be"&gt;https://ramle.be&lt;/a&gt; par exemple :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;% curl -I https://ramle.be
HTTP/2 &lt;span class="m"&gt;200&lt;/span&gt; 
server: nginx
date: Sat, &lt;span class="m"&gt;08&lt;/span&gt; May &lt;span class="m"&gt;2021&lt;/span&gt; &lt;span class="m"&gt;14&lt;/span&gt;:40:55 GMT
content-type: text/html&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nv"&gt;charset&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;utf-8
content-length: &lt;span class="m"&gt;1992&lt;/span&gt;
last-modified: Fri, &lt;span class="m"&gt;23&lt;/span&gt; Apr &lt;span class="m"&gt;2021&lt;/span&gt; &lt;span class="m"&gt;18&lt;/span&gt;:18:34 GMT
vary: Accept-Encoding
etag: &lt;span class="s2"&gt;&amp;quot;60830f7a-7c8&amp;quot;&lt;/span&gt;
content-security-policy: default-src &lt;span class="s1"&gt;&amp;#39;none&amp;#39;&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; style-src cdn.ramle.be&lt;span class="p"&gt;;&lt;/span&gt; img-src cdn.ramle.be
x-frame-options: SAMEORIGIN
x-xss-protection: &lt;span class="m"&gt;1&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="nv"&gt;mode&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;block
x-content-type-options: nosniff
referrer-policy: same-origin
x-permitted-cross-domain-policies: master-only
expect-ct: max-age&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;60&lt;/span&gt;, enforce
permissions-policy: &lt;span class="nv"&gt;accelerometer&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;camera&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;geolocation&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;gyroscope&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;magnetometer&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;microphone&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;payment&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;, &lt;span class="nv"&gt;usb&lt;/span&gt;&lt;span class="o"&gt;=()&lt;/span&gt;
strict-transport-security: max-age&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;31536000&lt;/span&gt;&lt;span class="p"&gt;;&lt;/span&gt; includeSubDomains&lt;span class="p"&gt;;&lt;/span&gt; preload
accept-ranges: bytes
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On remarque sur la première ligne la version d&amp;rsquo;HTTP, ici c&amp;rsquo;est la version 2. On voit ensuite la liste des en-têtes :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;content-type&lt;/strong&gt; indique le type de contenu (le &lt;a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types"&gt;MIME&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;etag&lt;/strong&gt; indique une suite de caractères ASCII, cette chaîne change si le contenu distant change, cela permet de mettre en cache les ressources. Il n&amp;rsquo;y a pas de méthode définie pour la génération de cette chaîne de caractères.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Je n&amp;rsquo;ai décrit ici que les en-têtes qui me semblait importants pour cet article, beaucoup d&amp;rsquo;autres en-têtes restent très utiles mais moins utilisés, souvent orientés sécurité, certains feront surement l&amp;rsquo;objet d&amp;rsquo;un article prochainement ;). Si vous voulez des informations plus précises sur celle-ci je vous laisse aller voir la documentation de MDN qui est assez complète.&lt;/p&gt;
&lt;p&gt;J&amp;rsquo;ai cité plus haut la version 2 d&amp;rsquo;HTTP (notée HTTP/2) sans expliquer les changements apportés par cette version, nous allons donc dans ce paragraphe voir les différences avec HTTP/1.1, pour commencer l&amp;rsquo;implémentation faite par beaucoup de navigateurs impose le chiffrement via HTTPS (on reparlera plus bas d&amp;rsquo;HTTPS), un autre changement est dans le transport lui même, HTTP/1.1 se base sur du texte, là ou HTTP/2 utilise du binaire, ça le rends plus compact et facile à parser, mais non lisible par un humain sans outil spécifique. Il y a aussi un changement dans la connexion TCP elle même, au lieu de faire une connexion &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt; par ressource, on utilise une seule connexion pour toutes les ressources le gain latence est assez important au vu du nombre d&amp;rsquo;aller-retour &lt;a href="https://blog.eban.bzh/today-i-learned/tcp.html"&gt;TCP&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma HTTP/2 vs HTTP/1.1" src="/static/img/http2.png"&gt;&lt;/p&gt;
&lt;p&gt;Vous avez probablement remarqué qu&amp;rsquo;HTTP ne présente presque aucun mécanisme de sécurité de base, il n&amp;rsquo;est en effet pas possible de vérifier l&amp;rsquo;authenticité des ressources ni d&amp;rsquo;empêcher un attaquant d&amp;rsquo;espionner la connexion, pour résoudre ce problème HTTPS est né, il s&amp;rsquo;agit simplement de faire passer HTTP via TLS, pour ce qui est de la vérification on se base sur les autorités de certification, contrairement à d&amp;rsquo;autres protocoles comme &lt;a href="https://blog.eban.bzh/today-i-learned/gemini.html"&gt;Gemini&lt;/a&gt;, je vous invite à aller voir l&amp;rsquo;article sur &lt;a href="https://blog.eban.bzh/today-i-learned/dane.html"&gt;DANE&lt;/a&gt; pour plus de détails à propos des autorités de certification. &lt;/p&gt;
&lt;p&gt;HTTP permet de réduire la taille des données envoyées en les compressant, les deux algorithmes utilisés pour compresser les données sont gzip et brotli, le client peut dire au serveur lequel de ces algorithmes il supporte via l&amp;rsquo;en-tête &amp;ldquo;&lt;strong&gt;Accept-encoding&lt;/strong&gt;&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour l&amp;rsquo;article d&amp;rsquo;aujourd&amp;rsquo;hui, j&amp;rsquo;espère qu&amp;rsquo;il vous aura plus :), On se retrouve demain pour parler de &lt;strong&gt;radvd&lt;/strong&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sat, 08 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-08:/http.html</guid><category>misc</category></item><item><title>IPv6, il est grand temps de migrer</title><link>https://ilearned.eu.org/ipv6.html</link><description>&lt;p&gt;Décembre 1998, c’est la date de parution de la &lt;a href="https://tools.ietf.org/html/rfc2460"&gt;RFC 2460&lt;/a&gt; introduisant IPv6, aujourd’hui, seulement 26% des sites les plus visités en France sont accessibles en IPv6 &lt;a href="https://www.arcep.fr/cartes-et-donnees/nos-publications-chiffrees/transition-ipv6/barometre-annuel-de-la-transition-vers-ipv6-en-france.html"&gt;d’après l’Arcep&lt;/a&gt;. Faisons donc un petit tour d’horizon de l’adoption d’IPv6.&lt;/p&gt;
&lt;p&gt;IPv6 a été créé pour répondre à une problématique simple, le manque croissant d’IPv4.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Taux d'adoption de l'IPv6 en France" src="/static/img/adoption_ipv6.png"&gt;&lt;/p&gt;
&lt;p&gt;En effet, avec IPv4 la quantité d’IPs total est théoriquement de &lt;code&gt;4 294 967 296&lt;/code&gt;, théoriquement car certains blocs d’IPs sont réservés à des usages privés comme par exemple 10.0.0.0/8. Le nombre de 4 milliards d’IPs peut sembler énorme, mais cela ne représente qu&amp;rsquo;une IP pour deux personnes sur terre, de plus beaucoups d&amp;rsquo;IPs sont allouées (plus d&amp;rsquo;informations sur l&amp;rsquo;allocation des IPs &lt;a href="https://blog.eban.bzh/today-i-learned/allocation-ips.html"&gt;ici&lt;/a&gt; 😉) mais pas utilisées, comme par exemple Apple qui monopolise un /8 soit 16 777 216 IPs qui n’est presque pas utilisé ! Avec IPv6 le nombre total d’IPs théoriquement disponible est de &lt;code&gt;340 282 366 920 938 463 463 374 607 431 768 211 456&lt;/code&gt;, IPv6 permet donc largement de pallier à ce problème de pénurie d’IPv4. Une adresse IPv6 typique ressemble à ça &lt;code&gt;2a03:7220:8083:3c00::1&lt;/code&gt; elle est codée sur 128 bits. Vous vous demandez sûrement ce à quoi correspondent les &lt;code&gt;::&lt;/code&gt; vers la fin de l’adresse, ils correspondent simplement à un remplissage avec des 0 afin d&amp;rsquo;atteindre le nombre de 128 bits. Par exemple : &lt;code&gt;2a03:7220:8083:3c00::1&lt;/code&gt; correspond en réalité à &lt;code&gt;2a03:7220:8083:3c00:0000:0000:0000:0001&lt;/code&gt;.  &lt;/p&gt;
&lt;p&gt;Les opérateurs ont développé plusieurs techniques pour contrer à ce manque croissant d&amp;rsquo;IPv4, comme par exemple le CG-NAT, pour ceux qui ne le sauraient pas, le NAT c&amp;rsquo;est basiquement le fait de partager une seule IP publique entre plusieurs appareils (nous aborderons le NAT plus en détail plus tard ;)) le CG-NAT c&amp;rsquo;est donc du NAT mais à l&amp;rsquo;échelle d&amp;rsquo;une rue, d&amp;rsquo;un quartier. Le problème principal du NAT c&amp;rsquo;est qu&amp;rsquo;il empêche de nombreuses applications et protocoles de fonctionner, comme par exemple le Torrent ou même Google Maps ! Il empêche aussi d&amp;rsquo;héberger des services chez soi car seule une plage de ports est allouée au client, il faut donc avoir la chance de tomber sur la plage contenant les ports 80 et 443 pour pouvoir auto-héberger un site web par exemple.&lt;/p&gt;
&lt;p&gt;La solution à ces maux est donc IPv6, mais comme nous l&amp;rsquo;avons vu en introduction son déploiement prend du temps, beaucoup de temps, dans son rapport annuel l&amp;rsquo;Arcep pointait du doigt la lenteur du déploiement d&amp;rsquo;IPv6, surtout chez certains opérateurs, mais aussi chez de nombreux hébergeurs qui ne fournissent pas d&amp;rsquo;IPv6 par défaut à leurs clients !&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/ipv6/Untitled.png" src="/static/img/ipv6/Untitled.png"&gt;&lt;/p&gt;
&lt;p&gt;Un des raisons de la lenteur du déploiement d&amp;rsquo;IPv6 est le fait qu&amp;rsquo;utilisateurs et hébergeurs se renvoient systématiquement la balle, les uns se demandant à quoi bon avoir de l&amp;rsquo;IPv6 si tous les sites qu&amp;rsquo;ils visitent sont disponibles en IPv4, les autres disant qu&amp;rsquo;il est inutile de déployer IPv6 puisque les clients ne sont en majorité pas équipés. Cette attitude dilatoire a pour conséquence de ralentir le déploiement d&amp;rsquo;IPv6 au détriment des petits hébergeurs associatifs qui n&amp;rsquo;ont pas forcément les moyens d&amp;rsquo;acheter des ranges d&amp;rsquo;IPv4 souvent très couteuses. &lt;/p&gt;
&lt;p&gt;Il existe un autre frein, et pas des moindres, au déploiement et l&amp;rsquo;utilisation massive d&amp;rsquo;IPv6, le réseau IPv6 est actuellement divisé en deux, en effet, Cogent un très gros fournisseur de &lt;a href="https://en.wikipedia.org/wiki/Internet_transit"&gt;transit&lt;/a&gt; refuse de peer (d&amp;rsquo;échanger ses routes) avec Hurrican Electric, un autre mastodonte du secteur. Ainsi, depuis le réseau IPv6 de Cogent il est impossible d&amp;rsquo;accéder à &lt;a href="http://he.net"&gt;he.net&lt;/a&gt; (le site de Hurrican Electric) en IPv6. Ce bloquage dure depuis 2009, et malgré les nombreuses demandes de Hurrican Electric, ces deux entreprises ne parviennent pas à un accord financier.&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/ipv6/Untitled%201.png" src="/static/img/ipv6/Untitled%201.png"&gt;&lt;/p&gt;
&lt;p&gt;Nous finirons donc cet article sur ce joli gâteau, merci beaucoup de l&amp;rsquo;avoir lu, si vous souhaitez savoir si vous avez de l&amp;rsquo;IPv6 je vous invite à faire le test sur &lt;a href="https://test-ipv6.com/"&gt;test-ipv6.com&lt;/a&gt;. Si vous n&amp;rsquo;en avez pas renseignez-vous, il existe probablement une démarche pour obtenir de l&amp;rsquo;IPv6 de la part de votre opérateur 😉, sauf si vous êtes chez orange, pas du bol :&amp;rsquo;(, il existe cependant des personnes qui offrent des tunnels IPv6 comme &lt;a href="https://enpls.org/"&gt;EnPLS&lt;/a&gt; par exemple.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 07 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-07:/ipv6.html</guid><category>misc</category></item><item><title>Gemini, une alternative viable à HTTP ?</title><link>https://ilearned.eu.org/gemini.html</link><description>&lt;p&gt;Hey 👋, aujourd&amp;rsquo;hui on parle du protocole Gemini, Gemini est un protocole alternatif à HTTP ou Gopher pour ne citer qu&amp;rsquo;eux, créé en Juin 2019 avec pour objectif d&amp;rsquo;être beaucoup plus léger qu&amp;rsquo;HTTP, et de mieux respecter la vie privée des utilisateurs, en effet, avec Gemini, pas de JS, de cookies ou de eTag, le tracking des utilisateurs est quasi impossible. Gemini n&amp;rsquo;a pas été créé pour concurrencer HTTP mais bien pour offrir une alternative plus légère et sécurisée aux utilisateurs. Ce protocole embarque d&amp;rsquo;office le protocole TLS, il n&amp;rsquo;y a donc contrairement à HTTP pas la possibilité d&amp;rsquo;avoir des communications en clair. Ce protocole est basé en partie sur HTTP 0.9 et essentiellement textuel, mais des images peuvent aussi être intégré. &lt;/p&gt;
&lt;p&gt;Une requête Gemini est très simple, le client demande un fichier sur le serveur cible, le serveur répond avec un code d&amp;rsquo;erreur (ici, 20 = OK), le type de fichier, le plus souvent &lt;code&gt;text/gemini&lt;/code&gt; et pour finir envoie le fichier. C&amp;rsquo;est plus simple que TCP avant-hier n&amp;rsquo;est-ce pas ? 😅 Voici donc une requête standard sur Gemini. C représente le client et S le serveur.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="n"&gt;C&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;gemini&lt;/span&gt;&lt;span class="o"&gt;://&lt;/span&gt;&lt;span class="n"&gt;gemini&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;circumlunar&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;space&lt;/span&gt;&lt;span class="sr"&gt;/docs/&lt;/span&gt;&lt;span class="n"&gt;faq&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;gmi&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="mi"&gt;20&lt;/span&gt; &lt;span class="n"&gt;text&lt;/span&gt;&lt;span class="o"&gt;/&lt;/span&gt;&lt;span class="n"&gt;gemini&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt; &lt;span class="n"&gt;Hey&lt;/span&gt; &lt;span class="o"&gt;!&lt;/span&gt;
&lt;span class="n"&gt;S&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;This&lt;/span&gt; &lt;span class="k"&gt;is&lt;/span&gt; &lt;span class="n"&gt;a&lt;/span&gt; &lt;span class="n"&gt;website&lt;/span&gt; &lt;span class="n"&gt;running&lt;/span&gt; &lt;span class="n"&gt;under&lt;/span&gt; &lt;span class="n"&gt;Gemini&lt;/span&gt; &lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="n"&gt;D&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;J&amp;rsquo;ai volontairement omis toute la partie correspondant à TLS dans l&amp;rsquo;exemple de requête ci-dessus car TLS fera l&amp;rsquo;objet d&amp;rsquo;un article plus complet dans peu de temps.&lt;/p&gt;
&lt;p&gt;Afin de se rendre indépendant de CA externes qui, &lt;a href="https://blog.eban.bzh/today-i-learned/dane.html"&gt;comme on l&amp;rsquo;a vu&lt;/a&gt; sont un SPOF (single point of failure, point unique de défaillance) qui, si il se trouve compromit, pourrait délivrer des certificats frauduleux Gemini s&amp;rsquo;appuie sur le principe de TOFU, Trust on first use, c&amp;rsquo;est un méchanisme aussi utilisé par SSH par exemple, pour faire confiance à un certificat, le logiciel s&amp;rsquo;appuie simplement sur le certificat qu&amp;rsquo;il a croisé pour la première fois sur ce site. Cette façon de fonctionner est décriée par certains préférant un fonctionnement avec CA. Cependant, des mécanismes comme &lt;a href="https://blog.eban.bzh/today-i-learned/dane.html"&gt;DANE&lt;/a&gt; couplé à &lt;a href="https://blog.eban.bzh/today-i-learned/dnssec.html"&gt;DNSSEC&lt;/a&gt; existent et permettent de rendre relativement sécurisé Gemini.&lt;/p&gt;
&lt;p&gt;À l&amp;rsquo;occasion de ce post, j&amp;rsquo;ai rendu mon blog accessible sur Gemini, je vous invite à faire un tour dessus à l&amp;rsquo;adresse &lt;code&gt;gemini://eban.bzh&lt;/code&gt; vous trouverez &lt;a href="https://gemini.circumlunar.space/clients.html"&gt;ici&lt;/a&gt; une liste de clients Gemini.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Thu, 06 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-06:/gemini.html</guid><category>misc</category></item><item><title>Le protocole IRC</title><link>https://ilearned.eu.org/irc.html</link><description>&lt;p&gt;Hier nous avions vu le protocole TCP, aujourd&amp;rsquo;hui nous allons en reparler en l&amp;rsquo;appliquant concrètement. Le protocole que nous allons voir est IRC qui est très simple dans sa conception, ce qui permet de l&amp;rsquo;utiliser à la main sans se prendre trop la tête.&lt;/p&gt;
&lt;p&gt;IRC est l&amp;rsquo;acronyme d&amp;rsquo;Internet Relay Chat (traduit littéralement par relai de discussion internet), comme son nom l&amp;rsquo;indique, le serveur ne fait que relayer les messages, il ne les stocke pas contrairement à de nombreux autres protocoles de chat.&lt;/p&gt;
&lt;p&gt;Comme sous entendu juste au dessus, IRC fonctionne dans un mode client serveur, le client est identifié par un &amp;ldquo;nick&amp;rdquo; (diminutif de nickname, pseudo), personne n&amp;rsquo;aura donc le même nick sur un serveur IRC. Le nick est le seule moyens d&amp;rsquo;identification d&amp;rsquo;un client, pour éviter de se le faire voler il faut laisser un client tourner en continu. Ce fonctionnement n&amp;rsquo;est pas forcément pratique et facilite l&amp;rsquo;usurpation, pour palier à ça beaucoup de serveur donnent la possibilité de s&amp;rsquo;authentifier à l&amp;rsquo;aide d&amp;rsquo;un mot de passe soit via un bot à qui on doit envoyer un message spécifique contenant le secret, soit via un système appelé SASL qui permet d&amp;rsquo;envoyer directement le mot de passe durant la phase de connexion au serveur. Pour ce qui est de l&amp;rsquo;usage principal de IRC, c&amp;rsquo;est à dire les messages, on fonctionne via des canaux, un peu comme discord, identifiés par une chaine de texte commençant par &amp;ldquo;#&amp;rdquo;, chaque canal peut posséder une description (cela reste facultatif).&lt;/p&gt;
&lt;p&gt;Pour essayer IRC on peut utiliser telnet qui est un outil qui permet d&amp;rsquo;établir des connexions TCP, on peut se connecter via la suite de commande :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;telnet irc.example.org &lt;span class="m"&gt;6667&lt;/span&gt; 
USER utilisateur * * :Une description
NICK utilisateur &lt;span class="c1"&gt;#Définit le fameux nick&lt;/span&gt;
JOIN &lt;span class="se"&gt;\#&lt;/span&gt;canal &lt;span class="c1"&gt;#Pour joindre un canal&lt;/span&gt;
PRIVMSG &lt;span class="se"&gt;\#&lt;/span&gt;canal Un message &lt;span class="c1"&gt;#Envoi &amp;quot;Un message&amp;quot; dans #canal&lt;/span&gt;
&lt;span class="c1"&gt;# Le serveur réponds par le &amp;quot;MOTD&amp;quot; (messaye of the day, ou message du jour en français)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Ce qui donnera la sortie :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;% telnet irc.lab.rameul.eu &lt;span class="m"&gt;6667&lt;/span&gt;
Trying &lt;span class="m"&gt;172&lt;/span&gt;.17.0.2...
Connected to irc.lab.rameul.eu.
Escape character is &lt;span class="s1"&gt;&amp;#39;^]&amp;#39;&lt;/span&gt;.
:irc.lab.rameul.eu NOTICE Auth :*** Looking up your hostname...
:irc.lab.rameul.eu NOTICE Auth :*** Could not resolve your hostname: Domain name not found&lt;span class="p"&gt;;&lt;/span&gt; using your IP address &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;172&lt;/span&gt;.17.0.1&lt;span class="o"&gt;)&lt;/span&gt; instead.
USER ramle * * :
NICK ramle
:irc.lab.rameul.eu NOTICE Auth :Welcome to rml-lab!
:irc.lab.rameul.eu &lt;span class="m"&gt;001&lt;/span&gt; ramle :Welcome to the rml-lab IRC Network ramle!ramle@172.17.0.1
:irc.lab.rameul.eu &lt;span class="m"&gt;002&lt;/span&gt; ramle :Your host is irc.lab.rameul.eu, running version InspIRCd-2.0
:irc.lab.rameul.eu &lt;span class="m"&gt;003&lt;/span&gt; ramle :This server was created on Debian
:irc.lab.rameul.eu &lt;span class="m"&gt;004&lt;/span&gt; ramle irc.lab.rameul.eu InspIRCd-2.0 iosw biklmnopstv bklov
:irc.lab.rameul.eu &lt;span class="m"&gt;005&lt;/span&gt; ramle &lt;span class="nv"&gt;AWAYLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;200&lt;/span&gt; &lt;span class="nv"&gt;CASEMAPPING&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;rfc1459 &lt;span class="nv"&gt;CHANMODES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;b,k,l,imnpst &lt;span class="nv"&gt;CHANNELLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;64&lt;/span&gt; &lt;span class="nv"&gt;CHANTYPES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="c1"&gt;# CHARSET=ascii ELIST=MU FNC KICKLEN=255 MAP MAXBANS=60 MAXCHANNELS=20 MAXPARA=32 :are supported by this server&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;005&lt;/span&gt; ramle &lt;span class="nv"&gt;MAXTARGETS&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="nv"&gt;MODES&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;20&lt;/span&gt; &lt;span class="nv"&gt;NETWORK&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;rml-lab &lt;span class="nv"&gt;NICKLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;32&lt;/span&gt; &lt;span class="nv"&gt;PREFIX&lt;/span&gt;&lt;span class="o"&gt;=(&lt;/span&gt;ov&lt;span class="o"&gt;)&lt;/span&gt;@+ &lt;span class="nv"&gt;STATUSMSG&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;@+ &lt;span class="nv"&gt;TOPICLEN&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="m"&gt;307&lt;/span&gt; VBANLIST WALLCHOPS WALLVOICES :are supported by this server
:irc.lab.rameul.eu &lt;span class="m"&gt;042&lt;/span&gt; ramle 476AAAAAK :your unique ID
:irc.lab.rameul.eu &lt;span class="m"&gt;375&lt;/span&gt; ramle :irc.lab.rameul.eu message of the day
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :-  _ __ _ __ ___ &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;      _ __   ___&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_ 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="s1"&gt;&amp;#39;__| &amp;#39;&lt;/span&gt;_ &lt;span class="sb"&gt;`&lt;/span&gt; _ &lt;span class="se"&gt;\|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_____&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="err"&gt;&amp;#39;&lt;/span&gt;_ &lt;span class="se"&gt;\ &lt;/span&gt;/ _ &lt;span class="se"&gt;\ &lt;/span&gt;__&lt;span class="p"&gt;|&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_____&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;  __/ &lt;span class="p"&gt;|&lt;/span&gt;_ 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;  &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;     &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt; &lt;span class="p"&gt;|&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="se"&gt;\_&lt;/span&gt;__&lt;span class="p"&gt;|&lt;/span&gt;&lt;span class="se"&gt;\_&lt;/span&gt;_&lt;span class="p"&gt;|&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- 
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- Description : Lab
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- NetAdmin : ramle
:irc.lab.rameul.eu &lt;span class="m"&gt;372&lt;/span&gt; ramle :- 
:irc.lab.rameul.eu &lt;span class="m"&gt;376&lt;/span&gt; ramle :End of message of the day.
:irc.lab.rameul.eu &lt;span class="m"&gt;251&lt;/span&gt; ramle :There are &lt;span class="m"&gt;1&lt;/span&gt; users and &lt;span class="m"&gt;0&lt;/span&gt; invisible on &lt;span class="m"&gt;1&lt;/span&gt; servers
:irc.lab.rameul.eu &lt;span class="m"&gt;254&lt;/span&gt; ramle &lt;span class="m"&gt;0&lt;/span&gt; :channels formed
:irc.lab.rameul.eu &lt;span class="m"&gt;255&lt;/span&gt; ramle :I have &lt;span class="m"&gt;1&lt;/span&gt; clients and &lt;span class="m"&gt;0&lt;/span&gt; servers
:irc.lab.rameul.eu &lt;span class="m"&gt;265&lt;/span&gt; ramle :Current Local Users: &lt;span class="m"&gt;1&lt;/span&gt;  Max: &lt;span class="m"&gt;2&lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;266&lt;/span&gt; ramle :Current Global Users: &lt;span class="m"&gt;1&lt;/span&gt;  Max: &lt;span class="m"&gt;2&lt;/span&gt;
JOIN &lt;span class="c1"&gt;#article&lt;/span&gt;
:ramle!ramle@172.17.0.1 JOIN :#article
:irc.lab.rameul.eu &lt;span class="m"&gt;353&lt;/span&gt; &lt;span class="nv"&gt;ramle&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="c1"&gt;#article :ramle @ramle2 &lt;/span&gt;
:irc.lab.rameul.eu &lt;span class="m"&gt;366&lt;/span&gt; ramle &lt;span class="c1"&gt;#article :End of /NAMES list.&lt;/span&gt;
PRIVMSG &lt;span class="c1"&gt;#article o/&lt;/span&gt;
:ramle2!ramle2@172.17.0.1 PRIVMSG &lt;span class="c1"&gt;#article :o/&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;~~Pour ceux qui souhaiteraient tester par eux même avec telnet, le serveur IRC ne sera up qu&amp;rsquo;à partir de 21h30 ;).~~ Il est en ligne.&lt;/p&gt;
&lt;p&gt;On peut voir dans ce court exemple plusieurs choses, déjà la simplicité du protocole, en seulement 3 commande on rejoint un canal. Un autre fait qui peut être noté, c&amp;rsquo;est la commande envoyée pour définir le nom d&amp;rsquo;utilisateur :  &lt;code&gt;USER ramle * * :&lt;/code&gt;, il n&amp;rsquo;y a en effet pas de description, c&amp;rsquo;est une option facultative. Un autre point important est le symbole &amp;ldquo;@&amp;rdquo; devant l&amp;rsquo;utilisateur &amp;ldquo;ramle2&amp;rdquo;, ce caractère signifie qu&amp;rsquo;il est &amp;ldquo;op&amp;rdquo; c&amp;rsquo;est à dire avec les permissions complète sur le canal, il peut donc expulser un membre, le bannir ou modifier des paramètres sur le canal, il ne peut par contre pas supprimer de messages vu que le serveur ne stocke rien, il ne sert que de relai entre les utilisateurs.&lt;/p&gt;
&lt;p&gt;&lt;img alt="IRC%2021507d67dcf84cbba48c88b9daad068c/Frame_30.png" src="/static/img/irc/Frame_30.png"&gt;&lt;/p&gt;
&lt;p&gt;Sur la capture réseau, on peut observer le peu de requête pour chaque étape, l&amp;rsquo;envoi du contenu en lui même et l&amp;rsquo;accusé. Si vous voulez observer par vous même, le fichier est ici &lt;/p&gt;
&lt;p&gt;&lt;a href="/static/misc/irc/irc.pcap"&gt;irc.pcap&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour IRC, j&amp;rsquo;espère que ça vous aura plus. N&amp;rsquo;hésitez pas à poster en commentaire si vous avec des remarques, des questions, on se retrouve demain pour Gemini :)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Wed, 05 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-05:/irc.html</guid><category>misc</category></item><item><title>Comprendre le protocole TCP</title><link>https://ilearned.eu.org/tcp.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui on s&amp;rsquo;attaque à un gros morceau, le protocole &lt;code&gt;TCP&lt;/code&gt;, vous êtes prêt·e·s ? C&amp;rsquo;est partit ! ;) TCP (= Transmission Control Protocol) est le protocole de &lt;a href="https://fr.wikipedia.org/wiki/Couche_transport"&gt;couche 4&lt;/a&gt; le plus utilisé et il fait partie intégrante de nos vies sans que nous ne nous en rendions compte. TCP a été créé afin de répondre à une problématique simple, permettre la communication de façon fiable entre deux machines. TCP est basé, comme de nombreux protocoles, sur une architecture &lt;code&gt;client-serveur&lt;/code&gt;. Les données sont découpées en blocs appelés segments.&lt;/p&gt;
&lt;p&gt;La communication s&amp;rsquo;effectue en trois parties : l&amp;rsquo;établissement de la connexion, le transfert des données, la fin de la connexion. Commençons donc par l&amp;rsquo;établissement de la connexion, il est fait grâce à un &lt;a href="https://fr.wikipedia.org/wiki/Three-way_handshake"&gt;handshake en trois étapes&lt;/a&gt; (Three-way handshake), la première étape est nommée &lt;code&gt;SYN&lt;/code&gt; (synchronized), le client va donc envoyer un paquet &lt;code&gt;SYN&lt;/code&gt; au serveur avec lequel il souhaite entamer la communication, il génère aussi aléatoirement un numéro de séquence qui est transmit dans ce paquet. Le serveur répond ensuite avec un paquet &lt;code&gt;SYN-ACK&lt;/code&gt; (synchronize, acknowledge), littéralement &lt;em&gt;accusé de réception de la demande de synchronisation&lt;/em&gt;, le numéro de séquence du serveur est généré aléatoirement, le numéro d&amp;rsquo;acquittement correspond au numéro de séquence du client incrémenté d&amp;rsquo;un. Pour finir, le client envoie un dernier paquet &lt;code&gt;ACK&lt;/code&gt; au serveur pour confirmer qu&amp;rsquo;il a bien reçu le paquet &lt;code&gt;SYN-ACK&lt;/code&gt;, le numéro de séquence de ce paquet est égal à celui généré par le client plus tôt + un, le numéro d&amp;rsquo;acquittement quant a lui est égal au numéro de séquence du serveur augmenté de 1.&lt;/p&gt;
&lt;p&gt;Ne vous en faites pas, nous allons voir plus précisément à quoi correspondent les numéros d&amp;rsquo;acquittement et de séquence ;).&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_25.png" src="/static/img/tcp/Frame_25.png"&gt;&lt;/p&gt;
&lt;p&gt;Une fois cette initialisation faite, la communication peut commencer, regardons donc de plus près le contenu d&amp;rsquo;un paquet TCP, accrochez vous il y a pas mal de contenu 😄. Cette partie s&amp;rsquo;appuie en grand partie sur &lt;a href="https://fr.wikipedia.org/wiki/Transmission_Control_Protocol#D%C3%A9veloppement_de_TCP"&gt;l&amp;rsquo;article wikipedia de TCP&lt;/a&gt;. Nous ne détaillerons pas l&amp;rsquo;utilité de chacune de ces informations, seulement des plus importantes à nos yeux.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_26.png" src="/static/img/tcp/Frame_26.png"&gt;&lt;/p&gt;
&lt;p&gt;Les numéros d&amp;rsquo;acquittement et de séquence sont deux valeurs aléatoires que l&amp;rsquo;on incrémente avec le nombre de données reçues afin de vérifier que tout les paquets sont bien arrivées dans l&amp;rsquo;ordre. Les numéros d&amp;rsquo;acquittement et de séquence initiaux sont générés aléatoirement durant la séquence d&amp;rsquo;initialisation de la connexion que nous avons vu plus tôt, le three way handshaking.&lt;/p&gt;
&lt;p&gt;Le partie &amp;ldquo;Somme de contrôle&amp;rdquo; est en fait un condensat des données transmises qui est calculé par le serveur et vérifié par le client afin de garantir l&amp;rsquo;intégrité des paquets. Si les hash correspondent on considère alors que le paquet a été transmit sans erreur. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_27.png" src="/static/img/tcp/Frame_27.png"&gt;&lt;/p&gt;
&lt;p&gt;Le flag &lt;code&gt;PSH&lt;/code&gt; (push) indique l&amp;rsquo;envoie de données.&lt;/p&gt;
&lt;p&gt;Le flag &lt;code&gt;URG&lt;/code&gt; indique la présence de données urgentes.&lt;/p&gt;
&lt;p&gt;Le flag &lt;code&gt;ECN/NS&lt;/code&gt; sert quant à lui à signaler la présence de congestion sur le réseau.&lt;/p&gt;
&lt;p&gt;Dans la partie &lt;code&gt;Options&lt;/code&gt; on pourrait par exemple citer la MSS (Maximum Segment Size) qui correspond à la taille maximale de la partie data. &lt;/p&gt;
&lt;p&gt;Nous avons vu les parties les plus importantes d&amp;rsquo;un trame TCP, étudions maintenant comment fermer une session avec le protocole TCP.&lt;/p&gt;
&lt;p&gt;Pour fermer une session TCP, c&amp;rsquo;est relativement simple, le premier appareil envoie un paquet &lt;code&gt;FIN&lt;/code&gt; au second avec son numéro de séquence, afin de vérifier que tous les paquets ont été reçu avant de fermer la communication. Le serveur répond alors avec un &lt;code&gt;ACK&lt;/code&gt; pour confirmer la réception du message. Le même échange a ensuite lieu dans l&amp;rsquo;autre sens, le serveur envoie un paquet &lt;code&gt;FIN&lt;/code&gt; et le client répond avec un &lt;code&gt;ACK&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_28.png" src="/static/img/tcp/Frame_28.png"&gt;&lt;/p&gt;
&lt;p&gt;Pfiou, ça fait beaucoup d&amp;rsquo;un coup 😅. Mettons maintenant tout ça en pratique, si vous êtes arrivé jusqu&amp;rsquo;ici, vous avez fait le plus dur, bravo 🎉.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Comprendre%20le%20protocole%20TCP%20c2ad32e581ef4daebd3dee3d401ad213/Frame_29(5).png" src="/static/img/tcp/Frame_29(5).png"&gt;&lt;/p&gt;
&lt;p&gt;Vous remarquerez surement la présence des mentions de &lt;code&gt;Win&lt;/code&gt;; &lt;code&gt;TSval&lt;/code&gt; et &lt;code&gt;TSecr&lt;/code&gt;, regardons à quoi elles correspondent&lt;/p&gt;
&lt;p&gt;&lt;code&gt;Win&lt;/code&gt; correspond à la fenêtre, pour faire simple, la taille maximale d&amp;rsquo;un paquet.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;TSval&lt;/code&gt; et &lt;code&gt;TSecr&lt;/code&gt; sont simplement des &lt;a href="https://fr.wikipedia.org/wiki/Horodatage"&gt;timestamps&lt;/a&gt;, &lt;code&gt;TSval&lt;/code&gt; correspond au moment de l&amp;rsquo;envoi du paquet et &lt;code&gt;TSecr&lt;/code&gt; au moment de la réception, chacun des deux participants de la conversation peut soustraire ces deux valeurs pour déterminer le &lt;code&gt;Round Trip Time (RTT)&lt;/code&gt;, le temps que prend un paquet à être échangé.&lt;/p&gt;
&lt;p&gt;Si vous souhaitez à votre tour inspecter ce simple échange tcp, le fichier est disponible &lt;a href="/static/misc/tcp/record.pcapng"&gt;ici&lt;/a&gt;, je vous recommande l&amp;rsquo;outil &lt;a href="https://www.wireshark.org/"&gt;Wireshark&lt;/a&gt; si vous voulez inspecter des paquets de ce type.&lt;/p&gt;
&lt;p&gt;Vous l&amp;rsquo;aurez surement remarqué, le protocole TCP a été conçu dans l&amp;rsquo;optique de minimiser au maximum la perte de donnée, grâce à des fonctionnalité comme les accusés de réception (&lt;code&gt;ACK&lt;/code&gt;) ou la somme de contrôle. Mais ces fonctionnalités posent un problème, les paquets s&amp;rsquo;en retrouvent alourdis, la partie somme de contrôle (checksum) pèse à elle seule 16 bits par exemple, autre exemple, pour chaque paquet d&amp;rsquo;envoie de données (&lt;code&gt;PSH&lt;/code&gt;), un paquet &lt;code&gt;ACK&lt;/code&gt; supplémentaire est nécessaire, à chaque fois ! Cette lourdeur pose notamment problème dans le cadre d&amp;rsquo;applications en temps réel, d&amp;rsquo;autres protocoles comme UDP que nous étudierons bientôt ont été créés pour remédier à ce problème.&lt;/p&gt;
&lt;p&gt;Merci beaucoup d&amp;rsquo;être arrivé jusqu&amp;rsquo;ici, cet article était plutôt complexe j&amp;rsquo;en suis conscient, si vous avez des question n&amp;rsquo;hésitez surtout pas à les poser, si vous souhaitez commenter n&amp;rsquo;oubliez pas que vous pouvez vous connecter (avec le bouton &lt;em&gt;Log In&lt;/em&gt;) via Github, Twitter et Gitlab.&lt;/p&gt;
&lt;p&gt;À demain 👋&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Tue, 04 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-04:/tcp.html</guid><category>Today I Learned</category></item><item><title>Le soucis du DNS de son opérateur</title><link>https://ilearned.eu.org/dns-fai.html</link><description>&lt;h1 id="le-soucis-du-dns-de-son-operateur"&gt;Le soucis du DNS de son opérateur&lt;/h1&gt;
&lt;p&gt;Pour le moment, nous avons beaucoup abordé le DNS, avec différents moyens de sécuriser et les risques associés. Aujourd&amp;rsquo;hui, on va voir comment choisir correctement un résolveur, enfin pour être précis comment savoir le quel ne pas prendre.&lt;/p&gt;
&lt;p&gt;Je suppose que vous avez résolu le NDD (nom de domaine) &lt;code&gt;blog.eban.bzh&lt;/code&gt; grâce au DNS distribué par votre box, il y a fort à parier que vous ne l&amp;rsquo;ayez pas changé et donc que ce soit votre FAI qui réponde aux requêtes, le problème étant que la plupart des gros FAI ne valident pas les requêtes via DNSSEC. Souvent, ces DNS mentent (envoient une réponse volontairement erronée, le plus plus souvent pour bloquer des sites.) sur base de demande faite par l&amp;rsquo;état, les listes sont d&amp;rsquo;ailleurs privées ce qui permettrai sans soucis de bloquer des sites totalement légitimes, c&amp;rsquo;est le cas de sci-hub par exemple, une plateforme qui partage des documents scientifiques.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;dig&lt;/span&gt; &lt;span class="mf"&gt;@109.88.203.3&lt;/span&gt; &lt;span class="n"&gt;sci&lt;/span&gt;&lt;span class="o"&gt;-&lt;/span&gt;&lt;span class="n"&gt;hub&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="n"&gt;se&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="o"&gt;+&lt;/span&gt;&lt;span class="kt"&gt;short&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="n"&gt;DNS&lt;/span&gt; &lt;span class="n"&gt;de&lt;/span&gt; &lt;span class="n"&gt;VOO&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;un&lt;/span&gt; &lt;span class="n"&gt;opérateur&lt;/span&gt; &lt;span class="n"&gt;belge&lt;/span&gt;
&lt;span class="mf"&gt;54.36.19.166&lt;/span&gt; &lt;span class="err"&gt;#&lt;/span&gt;&lt;span class="n"&gt;IPv4&lt;/span&gt; &lt;span class="n"&gt;redirigeant&lt;/span&gt; &lt;span class="n"&gt;vers&lt;/span&gt; &lt;span class="n"&gt;une&lt;/span&gt; &lt;span class="n"&gt;page&lt;/span&gt; &lt;span class="n"&gt;du&lt;/span&gt; &lt;span class="n"&gt;gouvernement&lt;/span&gt; &lt;span class="n"&gt;belge&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="c"&gt;% dig A sci-hub.se +short #Utilisation d&amp;#39;un DNS propre&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;span class="mf"&gt;186.2&lt;/span&gt;&lt;span class="p"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;163.219&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;#&lt;span class="n"&gt;IPv4&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;correct&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;pour&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;le&lt;/span&gt;&lt;span class="w"&gt; &lt;/span&gt;&lt;span class="n"&gt;site&lt;/span&gt;&lt;span class="w"&gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Il y a aussi un autre problème, la confidentialité. En effet, le serveur distant peut voir toutes les requêtes faites par un client, dans le cas d&amp;rsquo;un FAI il peut théoriquement savoir précisément qui vous êtes. Ils sont (obligation légal) déjà en possession de votre identité liée à l&amp;rsquo;adresse IP. Il reste peut probable que les FAI le fassent vraiment, ça leur rajouterai un coup conséquent pour le stockage de logs, sans oublier les risques de sanction si il n&amp;rsquo;est pas stipulé dans les CGU (conditions générales d&amp;rsquo;utilisation) ce stockage des requêtes.&lt;/p&gt;
&lt;p&gt;Il y aussi le problème de MITM, les DNS des opérateurs n&amp;rsquo;utilise pas de protocole comme DoH ou DoT, un pirate pourrait donc intercepter les requêtes.&lt;/p&gt;
&lt;p&gt;Dans cet article, on s&amp;rsquo;est concentré sur les opérateurs, mais ces problèmes existent sur beaucoup de résolveur publique qui bien souvent, offrent peu de garantie quand à la confidentialité, ou l&amp;rsquo;authenticité des réponses.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Mon, 03 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-03:/dns-fai.html</guid><category>misc</category></item><item><title>Usage des VLAN</title><link>https://ilearned.eu.org/vlan.html</link><description>&lt;p&gt;Souvent pour des raisons de sécurité ou par nécessité de priorisation du flux de certains appareils,  il est nécessaire de séparer le réseau en différentes parties, pour par exemple, séparer un réseau d&amp;rsquo;administration de serveurs et du matériel réseau avec le réseau destiné aux machines d&amp;rsquo;une entreprise. Dans ce cas deux solutions sont possible, soit utiliser plusieurs interfaces réseaux, soit faire des VLANs.&lt;/p&gt;
&lt;p&gt;Les VLANs permettent de gérer de manière plus aisée de la segmentation de réseaux, le principe est de par exemple permettre à un switch réseau en fonction du port sur lequel est branché une machine d&amp;rsquo;être sur une VLAN différente, chaque VLAN possède un ID numérique pour l&amp;rsquo;identifier. &lt;/p&gt;
&lt;p&gt;Un autre concept intéressant des VLAN, c&amp;rsquo;est le trunk, cela permet de faire passer plusieurs VLAN sur un seul port en tagant les paquets. Ce tag est rajouté dans l&amp;rsquo;en-tête ethernet  il contient l&amp;rsquo;ID de la VLAN dans laquelle le trafic doit aller. On peut aussi avoir des VLANs dites untagged, c&amp;rsquo;est à dire qui ne demande pas la modification de l&amp;rsquo;en-tête ethernet. Une VLAN untagged ne demande pas de configuration spécifique sur le client, c&amp;rsquo;est la VLAN &amp;ldquo;par défaut&amp;rdquo;, contrairement à une VLAN tagged qui demande que le client rajoute l&amp;rsquo;information dans l&amp;rsquo;en-tête on ne peut donc avoir qu&amp;rsquo;une seule VLAN untagged.&lt;/p&gt;
&lt;p&gt;On peut prendre un exemple du quotidien, la box de votre FAI, si vous avez une box pour la TV par exemple, il y a de forte chance que ce soit une VLAN séparée, cela permet de prioriser le trafic de la box TV afin d&amp;rsquo;éviter des coupures si vous téléchargez de gros fichiers par exemple. Ici, VLAN 10 est un VLAN taged et VLAN 20 est untagged, tout les appareils passent de base par VLAN 20.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma VLAN" src="/static/img/vlan.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sun, 02 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-02:/vlan.html</guid><category>Today I Learned</category></item><item><title>DANE et TLSA - Empêcher les certificats TLS frauduleux</title><link>https://ilearned.eu.org/dane.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui nous allons étudier le protocole DANE, ce protocole a été créé pour répondre à une problématique simple, comment garantir l&amp;rsquo;authenticité d&amp;rsquo;un certificat TLS si le &lt;a href="https://fr.wikipedia.org/wiki/Autorit%C3%A9_de_certification"&gt;CA&lt;/a&gt; est corrompu et délivre un certificat à, par exemple, un service de renseignement afin qu&amp;rsquo;il puisse intercepter et déchiffrer les requêtes des utilisateurs ? Cet exemple n&amp;rsquo;est pas pris par hasard, &lt;a href="https://security.googleblog.com/2013/12/further-improving-digital-certificate.html"&gt;un cas similaire&lt;/a&gt; s&amp;rsquo;est produit en 2013 où l&amp;rsquo;ANSSI avait délivré des certificats pour des domaines de Google, probablement à des fins de renseignement. La &lt;a href="https://tools.ietf.org/html/rfc6698"&gt;&lt;code&gt;RFC 6698&lt;/code&gt;&lt;/a&gt; introduit donc le standard DANE (DNS Authentication of Named Entities) et le record DNS &lt;code&gt;TLSA&lt;/code&gt;. Le principe est simple, ajouter un record dans la zone DNS qui contient un condensat du véritable certificat TLS, cette méthode ressemble très fortement au TLS Pinning, évoqué dans &lt;a href="https://blog.eban.bzh/today-i-learned/dot-doh.html"&gt;l&amp;rsquo;article d&amp;rsquo;hier&lt;/a&gt; mais a pour spécificité de placer le condensat au niveau du DNS.&lt;/p&gt;
&lt;p&gt;Voici un exemple de record pour &lt;a href="http://blog.eban.bzh"&gt;blog.eban.bzh&lt;/a&gt; :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;_443._tcp.blog.eban.bzh. 10800  IN  TLSA    3 1 1 D7DF5F6E8325454CF25B711D7FCB22CD639C4F26514E5473EC73C59353C16F0D
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On voit donc que l&amp;rsquo;on doit spécifier dans le record le port (ici, 443), le protocole utilisé (ici TCP, en passant, restez à l&amp;rsquo;affut dans les prochains jours un article à propos de ce protocole pourrait sortir 👀) puis le domaine auquel il s&amp;rsquo;applique, les trois numéros suivant &lt;code&gt;3 1 1&lt;/code&gt; correspondent respectivement, à l&amp;rsquo;utilité du cadre d&amp;rsquo;utilisation de ce record, ici &lt;code&gt;DANE-EE: Domain Issued Certificate&lt;/code&gt; un certificat donné pour un nom de domaine. Le &lt;code&gt;1&lt;/code&gt; suivant indique le type de certificat hashé, &lt;code&gt;0&lt;/code&gt; correspondant à un &lt;a href="https://en.wikipedia.org/wiki/Chain_of_trust"&gt;certificat fullchain&lt;/a&gt; et &lt;code&gt;1&lt;/code&gt; à la clé publique uniquement, le dernier &lt;code&gt;1&lt;/code&gt; correspond enfin à la fonction de hashage utilisée, ici &lt;a href="https://en.wikipedia.org/wiki/SHA-2"&gt;SHA-256&lt;/a&gt;. Une fois ce certificat mis en place le navigateur devrait, en principe, comparer ce hash avec un hash qu&amp;rsquo;il génèrerait de son côté, en principe car DANE n&amp;rsquo;est présent dans &lt;a href="https://bugzilla.mozilla.org/show_bug.cgi?id=1479423"&gt;aucun navigateur grand publique&lt;/a&gt;. Il existe cependant le module &lt;a href="https://addons.mozilla.org/en-US/firefox/addon/dnssec-dane-validator"&gt;DNSSEC/DANE Validator&lt;/a&gt; pour firefox et &lt;a href="https://chrome.google.com/webstore/detail/tlsa-validator/gmgeefghnadlmkpbjfamblomkoknhjga"&gt;TLSA Validator&lt;/a&gt; pour chromium et dérivés. Pour résumer le fonctionnement de DANE, voici un petit schéma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/dane/Frame_21.png" src="/static/img/dane/Frame_21.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="/static/img/dane/Frame_22.png" src="/static/img/dane/Frame_22.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 01 May 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-05-01:/dane.html</guid><category>misc</category></item><item><title>Fonctionnement du DNS over TLS et du DNS over HTTPS</title><link>https://ilearned.eu.org/dot-doh.html</link><description>&lt;p&gt;Hier on évoquait le problème de l’authenticité des réponses d&amp;rsquo;un serveur DNS. Nous avons vu la solution : DNSSEC mais ce mécanisme ne fait que signer les requêtes pour empêcher une modification, il n&amp;rsquo;empêche pas un espionnage passif des requêtes. Le risque d&amp;rsquo;espionnage demande de sécuriser le canal, deux solutions ont été retenues : &lt;code&gt;DoT&lt;/code&gt; et &lt;code&gt;DoH&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;DoT est l&amp;rsquo;acronyme de DNS  over TLS, ce protocole est assez &amp;ldquo;simple&amp;rdquo; si on omet l&amp;rsquo;explication de TLS qui sera vue prochainement, c&amp;rsquo;est du DNS qui passe par un canal chiffré via TLS. On utilise TCP sur le port 853.&lt;/p&gt;
&lt;p&gt;Un soucis ce pose, TLS se base souvent, comme dans le monde du web avec HTTPS par exemple, sur des autorités de certification (abrégé CA) qui en théorie s&amp;rsquo;assure de délivrer des certificat qu&amp;rsquo;ils ont signés pour prouver la légitimité, mais en réalité ce système est assez peu fiable, il n&amp;rsquo;est en effet pas rare de voir une autorité délivrer par erreur ou même intentionnellement des certificats vérolés, qui n&amp;rsquo;aurait pas du sortir, de plus, historiquement un certificat coute assez chère, même si de nos jours certaines organisations comme &lt;a href="https://letsencrypt.org/"&gt;Let&amp;rsquo;s Encrypt&lt;/a&gt; délivre gratuitement un certificat TLS.&lt;/p&gt;
&lt;p&gt;Pour se passer de CA plusieurs solutions existent, la plus simple est tout simplement de ne pas vérifier le certificat, cela protège d&amp;rsquo;un attaquant &amp;ldquo;passif&amp;rdquo; mais Il reste relativement aisé de remplacer le certificat à la volé. Pour empêcher ce cas on peut faire de l&amp;rsquo;épinglage de clé, ce principe se base sur un condensat du certificat qui est ensuite mit en base64, le logiciel peut ensuite comparer le certificat distant avec la clé qu&amp;rsquo;il a en local si un pirate effectue une attaque de l&amp;rsquo;homme du milieu (MITM) et remplace le certificat en court de route le client se rendra compte du subterfuge.&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSL pining" src="/static/img/ssl-pining.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="SSL pining mauvais certificat" src="/static/img/ssl-pining-fail.png"&gt;&lt;/p&gt;
&lt;p&gt;Un dernier problème dans DoT existe, un pare feu peut facilement en empêcher le fonctionnement, dans le cadre de portail captif par exemple souvent seul le trafic HTTP est autorisé. Une solution pour pallier à ce problème existe : DNS over HTTPS (DoH).&lt;/p&gt;
&lt;p&gt;DoH permet comme DoT de chiffrer le canal de communication, mais en passant par HTTPS l&amp;rsquo;avantage est qu&amp;rsquo;il est difficilement bloquable, en effet bloquer HTTPS bloquerai par la même occasion un grands nombres de sites web. Le fonctionnement reste axé sur le principe d&amp;rsquo;HTTP, l&amp;rsquo;avantage d&amp;rsquo;HTTP est le contrôle du cache directement sur le client avec l&amp;rsquo;en-tête &lt;code&gt;Cache-Control: max-age=X&lt;/code&gt; (ou X est le temps en seconde). Comme pour DoT plusieurs choix existe pour la validité du certificat, ce sont les mêmes choix qui s&amp;rsquo;offrent à nous. Pour ce qui est des codes de retour du DNS ils sont dans le corps du message, et non sous forme de code HTTP, bien sur les codes classiques HTTP sont toujours appliqués.&lt;/p&gt;
&lt;p&gt;Ces deux méthodes peuvent poser soucis dans certains cadre, en effet, il est dans beaucoup de cas requis de passer par un programme qui &amp;ldquo;traduit&amp;rdquo; de DoH ou DoT vers le protocole DNS directement. Un exemple de logiciel est par exemple &lt;code&gt;stubby&lt;/code&gt; sous Linux.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Proxy DoH/DoT" src="/static/img/proxy-dot-doh.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Fri, 30 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-30:/dot-doh.html</guid><category>misc</category></item><item><title>Fonctionnement de DNSSEC</title><link>https://ilearned.eu.org/dnssec.html</link><description>&lt;p&gt;Petit rappel: ce blog a un &lt;a href="https://blog.eban.bzh/rss.xml"&gt;flux RSS&lt;/a&gt;, n&amp;rsquo;hésitez pas à l&amp;rsquo;ajouter à votre lecteur de flux RSS favori :)&lt;/p&gt;
&lt;p&gt;Hier nous avons vu comment sécuriser la connexion entre un serveur slave et un serveur master, mais le problème d&amp;rsquo;authenticité des réponses se pose encore, pour commencer le trafic entre le serveur autoritaire et résolveur n&amp;rsquo;est pas chiffré, n&amp;rsquo;importe quel attaquant qui pratique une attaque type &lt;a href="https://fr.wikipedia.org/wiki/Attaque_de_l%27homme_du_milieu"&gt;&lt;code&gt;MITM&lt;/code&gt;&lt;/a&gt; peut donc modifier les réponses. Le canal n&amp;rsquo;est pas le seul problème, surtout qu&amp;rsquo;il est déjà possible de sécuriser le canal entre résolveur et autoritaire, et entre le résolveur et le client via &lt;code&gt;DoT&lt;/code&gt; (DNS over TLS) et &lt;code&gt;DoH&lt;/code&gt; (DNS over HTTPS), nous en parlerons plus largement demain ;). Sécuriser le canal si le serveur est corrompu ne sert pas à grand chose, c&amp;rsquo;est la raison pour laquelle &lt;code&gt;DNSSEC&lt;/code&gt; (&lt;code&gt;RFC 4033&lt;/code&gt;) a été inventé.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma sur les risques sans DNSSEC" src="/static/img/schema_risques_dnssec.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;DNSSEC&lt;/code&gt; est une manière de signer de façon cryptographique une zone DNS sur base d&amp;rsquo;un système de clés asymétriques, un système de clés asymétriques repose sur 2 clés, une privée qui est gardée précieusement et qui sert à signer ou déchiffrer des données et une publique qui sert à vérifier ou chiffrer des données. Dans le cadre du DNSSEC le chiffrement ne sert pas, la clé privée sert donc uniquement à signer. &lt;/p&gt;
&lt;p&gt;Pour procéder on utilise en général deux pairs de clés : la &lt;code&gt;KSK&lt;/code&gt; (key-signing key) et la &lt;code&gt;ZSK&lt;/code&gt; (zone-signing key). La clé KSK est seulement là pour la signature de la ZSK, on lui donne une durée de vie plus grande que la ZSK et elle peut être stockée et générée hors ligne pour accroitre la sécurités de celle ci, l&amp;rsquo;avantage de ce système est de pouvoir garder plus longtemps la même clé sans rajouter trop de risque de fuite vu que stockée hors ligne, dans un lieu sécurisé. La ZSK quand à elle est sert à signer la zone, elle doit donc être présente sur la machine qui génère la zone, on la change plus souvent pour éviter les risques de fuites. Les serveurs esclaves n&amp;rsquo;ont besoin d&amp;rsquo;aucune des 2 clés, ils reçoivent directement la zone signée, la modification de la zone de leur part n&amp;rsquo;est donc plus possible si le résolveur vérifie avec DNSSEC.&lt;/p&gt;
&lt;p&gt;DNSSEC ne signe pas la zone de manière entière, mais signe chaque enregistrement indépendamment, la signature est contenue dans le record de type &lt;code&gt;RSSIG&lt;/code&gt;. Ce fonctionnement pose un soucis si il permet de signer une entrée DNS, comment prouve t&amp;rsquo;on inexistante d&amp;rsquo;un enregistrement ? Pour résoudre cette problématique l’enregistrement de type &lt;code&gt;NSEC&lt;/code&gt; existe.&lt;/p&gt;
&lt;p&gt;NSEC est un moyen de prouver l’inexistence (symbolisé par le code de retour &lt;code&gt;NXDOMAIN&lt;/code&gt;) d&amp;rsquo;un record en donnant le prochain (par ordre alphabétique) enregistrement de la zone, un problème de confidentialité se pose avec cet méthode, il est en effet très simple d&amp;rsquo;énumérer la liste d&amp;rsquo;enregistrement. Pour empêcher ce type d&amp;rsquo;attaque NSEC3 est né, au lieu de donner le FQDN on ne retourne que le condensat, l&amp;rsquo;énumération devient donc impossible.&lt;/p&gt;
&lt;p&gt;Une dernière problématique, et pas des moindres existe, comment s&amp;rsquo;échanger de manière fiable les clés à grande échelle ? On ne peut pas se les donner de personne à personne, c&amp;rsquo;est ingérable au vu du nombre de zones présentes sur internet. Pour résoudre cette problématique deux enregistrements existent : DS et DNSKEY.&lt;/p&gt;
&lt;p&gt;Commençons pas DNSKEY, il permet d&amp;rsquo;enregistrer la clé publique qui signe la zone, cette enregistrement est stocké dans la zone elle même.&lt;/p&gt;
&lt;p&gt;Avec uniquement DNSKEY on ne peut pas valider correctement la zone, la fiabilité de la chaine n&amp;rsquo;est pas garantie, il slave pourrait modifier ce record pour modifier la zone à sa guise, pour vérifier il existe donc un enregistrement DS qui se situe dans la zone parente et permet de faire une référence à la clé publique utilisée pour signer la zone du FQDN, c&amp;rsquo;est le registrar qui s&amp;rsquo;occupe de faire placer cet enregistrement. Pour ce qui est de la zone &lt;code&gt;.&lt;/code&gt; il est impossible de définir un record DS au dessus, car c&amp;rsquo;est la zone la plus basse, l&amp;rsquo;IANA donne donc la clé utilisée et c&amp;rsquo;est disponible ici : &lt;a href="https://www.iana.org/dnssec/files"&gt;https://www.iana.org/dnssec/files&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma fonctionnement DNSSEC" src="/static/img/schema_dnssec.png"&gt;&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour cet article, j&amp;rsquo;espère que ça vous aura plus. Si vous avez des remarques ou questions n&amp;rsquo;hésitez pas en commentaire. On se retrouve demain pour parler de &lt;strong&gt;DNS over TLS et DNS over HTTPS&lt;/strong&gt; :)&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Thu, 29 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-29:/dnssec.html</guid><category>misc</category></item><item><title>Comment sont allouées les adresses IPs</title><link>https://ilearned.eu.org/allocation-ips.html</link><description>&lt;p&gt;Internet est un énorme &amp;ldquo;réseau de réseaux&amp;rdquo; et comme toute grande organisation son fonctionnement est relativement complexe, aujourd&amp;rsquo;hui nous allons tenter de décrypter le fonctionnement de l&amp;rsquo;allocation d&amp;rsquo;adresse IP sur Internet 🙂. Vous commencez à avoir l&amp;rsquo;habitude, commençons par un schéma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma allocation IP" src="/static/img/schema-ip.png"&gt;&lt;/p&gt;
&lt;p&gt;À la tête d&amp;rsquo;Internet, il y a une organisation, l&amp;rsquo;ICANN (Internet Corporation for Assigned Names and Numbers soit Société pour l&amp;rsquo;attribution des noms de domaine et des numéros sur Internet en français) cette entreprise américaine gère les noms de domaine et les adresses IPs via l&amp;rsquo;IANA qui est un département de cette institution. &lt;/p&gt;
&lt;p&gt;Les IPs sont ensuite redistribuées entre cinq organisations appelés RIRs,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;L&amp;rsquo;ARIN pour les pays d&amp;rsquo;Amérique du nord. À qui l&amp;rsquo;IANA attribue 93 /8&lt;/li&gt;
&lt;li&gt;Le LACNIC pour les pays d&amp;rsquo;Amérique du sud. À qui l&amp;rsquo;IANA attribue 10 /8&lt;/li&gt;
&lt;li&gt;L&amp;rsquo;AFRINIC pour les pays d&amp;rsquo;Afrique. À qui l&amp;rsquo;IANA attribue 42 /8&lt;/li&gt;
&lt;li&gt;Le RIPE NCC pour l&amp;rsquo;Europe et le Moyen-Orient? À qui l&amp;rsquo;IANA attribue 6 /8&lt;/li&gt;
&lt;li&gt;L&amp;rsquo;APNIC pour l&amp;rsquo;Asie et le Pacifique. À qui l&amp;rsquo;IANA attribue 51 /8&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Organisation par continent" src="/static/img/organisation-ip-continent.svg"&gt;&lt;/p&gt;
&lt;p&gt;On remarque donc de grandes inégalités dans l&amp;rsquo;allocation des IPs entre les RIRs. Ces RIRs attribuent ensuite eux même des plages d&amp;rsquo;IPs à de LIRs (Local Internet Registry ou registre Internet local), nous prendrons ici l&amp;rsquo;exemple de &lt;em&gt;iFog GmbH&lt;/em&gt; qui est un LIR déclaré après du RIPE NCC. Les LIRs sont des intermédiaires entre les RIR et les AS. &lt;/p&gt;
&lt;p&gt;Nous en venons donc à notre dernier point, les AS (Autonomous System) sont des entités identifiées par un numéro de 32 bits (ou 16 avant 2007 ou dans certains cas aujourd&amp;rsquo;hui), ces numéros sont appelés ASN (Autonomous System Number), promit c&amp;rsquo;est le dernier acronyme 😛, ce sont ces AS qui peuvent avoir des ranges d&amp;rsquo;IPs, par exemple l&amp;rsquo;AS213253 a le range &lt;code&gt;2a0c:9a40:81fb::/48&lt;/code&gt; qui lui est attribué par l&amp;rsquo;intermédiare d&amp;rsquo;iFog GmbH, cette AS possède aussi &lt;code&gt;2a0e::fd45::2a00::/40&lt;/code&gt; qui lui est attribué par un autre LIR : Bakker IT. &lt;/p&gt;
&lt;p&gt;Il faut savoir qu&amp;rsquo;un AS est couteux, pour vous donner un ordre d&amp;rsquo;idée le coût approximatif d&amp;rsquo;un AS à l&amp;rsquo;année est d&amp;rsquo;environ 4000€ en prenant en compte le transit, les IPs etc.&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article qui, je l&amp;rsquo;espère vous aura éclairé sur le fonctionnement d&amp;rsquo;Internet ;) Si vous avez des questions n&amp;rsquo;hésitez pas à les formuler dans les commentaires, on se retrouve demain pour parler de DNSSEC.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Wed, 28 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-28:/allocation-ips.html</guid><category>misc</category></item><item><title>Sécuriser la connexion entre Master et Slave</title><link>https://ilearned.eu.org/tsig-xot.html</link><description>&lt;p&gt;Comme nous l&amp;rsquo;avons vu &lt;a href="https://google.com/"&gt;hier&lt;/a&gt;, la communication entre &lt;code&gt;master&lt;/code&gt; et &lt;code&gt;slave&lt;/code&gt; est faite en claire ce qui peut représenter une problème de sécurité, plusieurs systèmes ont donc été mit en place afin de sécuriser ce système.&lt;/p&gt;
&lt;h1 id="le-filtrage-par-ip"&gt;Le filtrage par IP&lt;/h1&gt;
&lt;p&gt;Le moyen le plus courant pour filtrer les demandes de transfert de zone est le filtrage par IP, mais il présente deux inconvénients principaux, ce filtrage par IP peut poser problème dans le cas où le slave aurait un IP dynamique et pose aussi un problème de sécurité dû au fait qu&amp;rsquo;une IP puisse être &amp;ldquo;&lt;a href="https://en.wikipedia.org/wiki/IP_address_spoofing"&gt;spoofé&lt;/a&gt;&amp;rdquo; (= usurpée), ce type d&amp;rsquo;attaque fera très probablement l&amp;rsquo;objet d&amp;rsquo;un article dans un futur proche 😉.&lt;/p&gt;
&lt;h1 id="le-protocole-tsig"&gt;Le protocole TSIG&lt;/h1&gt;
&lt;p&gt;Le protocole &lt;code&gt;TSIG&lt;/code&gt;, introduit en Mai 2000 par la &lt;a href="https://tools.ietf.org/html/rfc2845"&gt;RFC 2845&lt;/a&gt; (pour info, une RFC, requests for comments, est un documents qui détaille le fonctionnement d&amp;rsquo;Internet ou de différents matériels informatique) permet d&amp;rsquo;authentifier un &lt;code&gt;slave&lt;/code&gt; grâce à un secret partagé, le &lt;code&gt;slave&lt;/code&gt; envoie un premier paquet contenant un &lt;a href="https://en.wikipedia.org/wiki/Cryptographic_hash_function"&gt;condensat&lt;/a&gt; (hash) de la clé, le master compare alors ce hash avec celui qu&amp;rsquo;il génère aussi de son côté à partir de cette même clé, s&amp;rsquo;ils correspondent et que les &lt;code&gt;id&lt;/code&gt; (= nom de la clé) sont identiques le slave est authentifié, pour résumer cela, voici un schéma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="https://i.postimg.cc/0yhhnRjL/Frame-4.png" src="/static/img/tsig-xot/Frame_4.png"&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Se%CC%81curiser%20la%20connexion%20entre%20Master%20et%20Slave%206ab075baba074e2a967914523258907d/Frame_5.png" src="/static/img/tsig-xot/Frame_5.png"&gt;&lt;/p&gt;
&lt;p&gt;Ce protocole a cependant deux tares, premièrement, la clé doit être partagée pour la première fois de façon sécurisée, ce qui n&amp;rsquo;est pas toujours chose facile, deuxième tare, l&amp;rsquo;authentification est bien sécurisée, mais c&amp;rsquo;est moins le cas pour les requêtes &lt;a href="https://google.com"&gt;AXFR/IXFR&lt;/a&gt; qui sont seulement signée, ainsi, l&amp;rsquo;intégrité de la réponse peut être assurée mais son contenu transite en clair sur internet, il existe cependant un autre projet de protocole qui pourrais permettre de sécuriser ces échanges.&lt;/p&gt;
&lt;h1 id="xfr-over-tls"&gt;XFR over TLS&lt;/h1&gt;
&lt;p&gt;Le protocole &lt;a href="https://tools.ietf.org/html/draft-ietf-dprive-xfr-over-tls-11"&gt;XoT&lt;/a&gt; (XFR over TLS) est encore à l&amp;rsquo;état de &amp;ldquo;draft&amp;rdquo; (brouillon) mais il permettrait de pallier à ce problème en chiffrant les requêtes grâce au protocole TLS. Il existe malgré tout une implémentation expérimentale de XoT dans le logiciel &lt;a href="https://gitlab.isc.org/isc-projects/bind9"&gt;Bind&lt;/a&gt;, XoT est donc un protocole très prometteur afin de garantir la confidentialité des transferts de zone.&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, on se retrouve demain pour parler de l&amp;rsquo;allocation des adresses IP sur
internet🙂.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Tue, 27 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-27:/tsig-xot.html</guid><category>Today I Learned</category></item><item><title>Communication entre Master et Slave - Vulnérabilité transfert de zone</title><link>https://ilearned.eu.org/xfr-zone-transfer.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui, on parle des procotoles AXFR et IXFR ainsi que de la vulnérabilité que peut représenter un transfert de zone non autorisé !&lt;/p&gt;
&lt;p&gt;AXFR est un protocole qui sert à faire des transferts de zone du &lt;code&gt;master&lt;/code&gt; vers le &lt;code&gt;slave&lt;/code&gt;, le &lt;code&gt;slave&lt;/code&gt; vérifie périodiquement si le serial (=numéro de version, voir &lt;a href="https://blog.eban.bzh/today-i-learned/les-bases-du-dns.html"&gt;ici&lt;/a&gt; si vous ne vous rappelez plus de ce que c&amp;rsquo;est) de son SOA est inférieur à celui du &lt;code&gt;master&lt;/code&gt;, si c&amp;rsquo;est le cas, il fait une demande de transfert de zone, qui peut être fait grâce au protocole AXFR. Concrètement le &lt;code&gt;master&lt;/code&gt; envoie simplement une copie de sa zone DNS vers le &lt;code&gt;slave&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Il existe aussi un autre protocole pour le même usage appelé IXFR, avec IXFR, si le &lt;code&gt;slave&lt;/code&gt; remarque que son serial est inférieur à celui du &lt;code&gt;master&lt;/code&gt;, il envoie le serial de la version de la zone qu&amp;rsquo;il détient au &lt;code&gt;master&lt;/code&gt;, le &lt;code&gt;master&lt;/code&gt; envoie ensuite le nouveau serial et deux listes, une pour les records à supprimer et une autre pour les records à ajouter/modifier. IXFR a pour avantage principal de nécessiter moins de bande passante qu&amp;rsquo;AXFR.&lt;/p&gt;
&lt;p&gt;Un fois ces petites explications faites, passons à la partie la plus intéressante, l&amp;rsquo;exploitation d&amp;rsquo;un transfert de zone :p. Pour authentifier un slave on effectue souvent un filtrage par IP, néanmoins il arrive que ce filtrage ne soit pas mit en place, n&amp;rsquo;importe qui peut alors dumper (= avoir une copie) de la zone très facilement, voici un exemple que vous pouvez essayer de reproduire chez vous.&lt;/p&gt;
&lt;p&gt;Nous allons dans un premier temps demander à notre serveur DNS résolveur la liste des serveurs DNS autoritaires pour le domaine &lt;code&gt;zonetransfer.me&lt;/code&gt;. L&amp;rsquo;option &lt;code&gt;+short&lt;/code&gt; que j&amp;rsquo;ai ajouté ici permet simplement d&amp;rsquo;avoir directement le résultat sans d&amp;rsquo;autres informations.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;➤ dig zonetransfer.me NS +short
nsztm1.digi.ninja.
nsztm2.digi.ninja.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;Nous avons donc ici les deux serveurs DNS autoritaires du nom de domaine &lt;code&gt;zonetransfer.me&lt;/code&gt;. Essayons donc de faire une requête DNS de type AXFR sur un de ces deux serveurs.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;➤ dig axfr @nsztm2.digi.ninja zonetransfer.me

&lt;span class="p"&gt;;&lt;/span&gt; &amp;lt;&amp;lt;&amp;gt;&amp;gt; DiG &lt;span class="m"&gt;9&lt;/span&gt;.11.28-RedHat-9.11.28-1.fc33 &amp;lt;&amp;lt;&amp;gt;&amp;gt; axfr @nsztm2.digi.ninja zonetransfer.me
&lt;span class="p"&gt;;&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;1&lt;/span&gt; server found&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="p"&gt;;;&lt;/span&gt; global options: +cmd
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  SOA nsztm1.digi.ninja. robin.digi.ninja. &lt;span class="m"&gt;2019100801&lt;/span&gt; &lt;span class="m"&gt;172800&lt;/span&gt; &lt;span class="m"&gt;900&lt;/span&gt; &lt;span class="m"&gt;1209600&lt;/span&gt; &lt;span class="m"&gt;3600&lt;/span&gt;
zonetransfer.me.    &lt;span class="m"&gt;300&lt;/span&gt; IN  HINFO   &lt;span class="s2"&gt;&amp;quot;Casio fx-700G&amp;quot;&lt;/span&gt; &lt;span class="s2"&gt;&amp;quot;Windows XP&amp;quot;&lt;/span&gt;
zonetransfer.me.    &lt;span class="m"&gt;301&lt;/span&gt; IN  TXT &lt;span class="s2"&gt;&amp;quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&amp;quot;&lt;/span&gt;
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;0&lt;/span&gt; ASPMX.L.GOOGLE.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;10&lt;/span&gt; ALT1.ASPMX.L.GOOGLE.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;10&lt;/span&gt; ALT2.ASPMX.L.GOOGLE.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX2.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX3.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX4.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  MX  &lt;span class="m"&gt;20&lt;/span&gt; ASPMX5.GOOGLEMAIL.COM.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  A   &lt;span class="m"&gt;5&lt;/span&gt;.196.105.14
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  NS  nsztm1.digi.ninja.
zonetransfer.me.    &lt;span class="m"&gt;7200&lt;/span&gt;    IN  NS  nsztm2.digi.ninja.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;J&amp;rsquo;ai volontairement coupé une bonne partie de la réponse car elle serait trop longue sinon. Nous pouvons donc voir que nous arrivons à avoir une copie de la zone DNS complète, copie que nous ne devrions normalement pas avoir car elle peut comporter des informations sensibles comme par exemple des sous-domaines censés rester en interne ou des record PTR (les enregistrements PTR associent une IP à un nom de domaine) qui permettraient de trouver des IPs à analyser.&lt;/p&gt;
&lt;p&gt;Et voilà concrètement ce que donne une requête AXFR sur le réseau :&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="m"&gt;10&lt;/span&gt;.2.0.2.36871 &amp;gt; &lt;span class="m"&gt;34&lt;/span&gt;.225.33.2.53: Flags &lt;span class="o"&gt;[&lt;/span&gt;P.&lt;span class="o"&gt;]&lt;/span&gt;, cksum 0xa73b &lt;span class="o"&gt;(&lt;/span&gt;correct&lt;span class="o"&gt;)&lt;/span&gt;, seq &lt;span class="m"&gt;1&lt;/span&gt;:59, ack &lt;span class="m"&gt;1&lt;/span&gt;, win &lt;span class="m"&gt;502&lt;/span&gt;, options &lt;span class="o"&gt;[&lt;/span&gt;nop,nop,TS val &lt;span class="m"&gt;3406917213&lt;/span&gt; ecr &lt;span class="m"&gt;943752624&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;, length &lt;span class="m"&gt;58&lt;/span&gt; &lt;span class="m"&gt;38384&lt;/span&gt; &lt;span class="o"&gt;[&lt;/span&gt;1au&lt;span class="o"&gt;]&lt;/span&gt; AXFR? zonetransfer.me. &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="m"&gt;56&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;

&lt;span class="m"&gt;34&lt;/span&gt;.225.33.2.53 &amp;gt; &lt;span class="m"&gt;10&lt;/span&gt;.2.0.2.36871: Flags &lt;span class="o"&gt;[&lt;/span&gt;.&lt;span class="o"&gt;]&lt;/span&gt;, seq &lt;span class="m"&gt;1&lt;/span&gt;:1441, ack &lt;span class="m"&gt;59&lt;/span&gt;, win &lt;span class="m"&gt;489&lt;/span&gt;, options &lt;span class="o"&gt;[&lt;/span&gt;nop,nop,TS val &lt;span class="m"&gt;943753618&lt;/span&gt; ecr &lt;span class="m"&gt;3406917375&lt;/span&gt;&lt;span class="o"&gt;]&lt;/span&gt;, length &lt;span class="m"&gt;1440&lt;/span&gt; &lt;span class="m"&gt;38384&lt;/span&gt;*- &lt;span class="m"&gt;51&lt;/span&gt;/0/1 zonetransfer.me. SOA nsztm1.digi.ninja. robin.digi.ninja. &lt;span class="m"&gt;2019100801&lt;/span&gt; &lt;span class="m"&gt;172800&lt;/span&gt; &lt;span class="m"&gt;900&lt;/span&gt; &lt;span class="m"&gt;1209600&lt;/span&gt; &lt;span class="m"&gt;3600&lt;/span&gt;, zonetransfer.me. HINFO, zonetransfer.me. TXT &lt;span class="s2"&gt;&amp;quot;google-site-verification=tyP28J7JAUHA9fw2sHXMgcCC0I6XBmmoVi04VlMewxA&amp;quot;&lt;/span&gt;, zonetransfer.me. MX ASPMX.L.GOOGLE.COM. &lt;span class="m"&gt;0&lt;/span&gt;, zonetransfer.me. MX ALT1.ASPMX.L.GOOGLE.COM. &lt;span class="m"&gt;10&lt;/span&gt;, zonetransfer.me. MX ALT2.ASPMX.L.GOOGLE.COM. &lt;span class="m"&gt;10&lt;/span&gt;, zonetransfer.me. MX ASPMX2.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;, zonetransfer.me. MX ASPMX3.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;, zonetransfer.me. MX ASPMX4.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;, zonetransfer.me. MX ASPMX5.GOOGLEMAIL.COM. &lt;span class="m"&gt;20&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On voit donc que les informations transitent &lt;strong&gt;en clair&lt;/strong&gt; (= non chiffrées) sur le réseau.&lt;/p&gt;
&lt;p&gt;C&amp;rsquo;est tout pour aujourd&amp;rsquo;hui merci beaucoup d&amp;rsquo;avoir lu cet article, n&amp;rsquo;hésitez pas à laisser un commentaire si vous avez des remarques à faire dessus, on se retrouve demain pour parler de comment &lt;strong&gt;sécuriser la communication entre master slave&lt;/strong&gt;. 👋&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Mon, 26 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-26:/xfr-zone-transfer.html</guid><category>Today I Learned</category></item><item><title>Le principe de Master/Slave - Le rôle du registrar</title><link>https://ilearned.eu.org/master-slave-registrar.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui, on parle du rôle d&amp;rsquo;un Registrar puis dans une seconde partie du principe de Master/Slave dans le cadre de serveur DNS autoritaire.&lt;/p&gt;
&lt;p&gt;Les registrars ou bureaux d&amp;rsquo;enregistrement en français sont des organisations qui gèrent les domaines de premier niveau (TLD). On peut citer par exemple EURid qui gère le &lt;code&gt;.eu&lt;/code&gt;, DNS Belgium pour le &lt;code&gt;.be&lt;/code&gt; ou encore l&amp;rsquo;AFNIC pour le &lt;code&gt;.fr&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;Ces registrars obtiennent leurs domaines de premier niveau auprès de l&amp;rsquo;IANA. &lt;em&gt;je suppose que vous vous demandez ce qu&amp;rsquo;est l&amp;rsquo;IANA ?&lt;/em&gt; L&amp;rsquo;IANA est une branche de l&amp;rsquo;iCANN, c&amp;rsquo;est la branche qui gère l&amp;rsquo;attribution de ressource comme les blocs d&amp;rsquo;IP ou les TLD.&lt;/p&gt;
&lt;p&gt;Pour ce qui est de la revente de domaines, souvent les bureaux d&amp;rsquo;enregistrements passent par des sous-traitants, ces sous-traitants doivent respecter certaines règles comme par exemple un prix fixe reversé au registrar, ou des restrictions géographiques.&lt;/p&gt;
&lt;h1 id="le-principe-de-masterslave"&gt;Le principe de Master/Slave&lt;/h1&gt;
&lt;p&gt;Le principe de master et de slave est assez important dans le monde du DNS et de l&amp;rsquo;informatique en général, il permet, dans le cadre du DNS, de redonder facilement une zone sur plusieurs serveurs autoritaires.&lt;/p&gt;
&lt;p&gt;Le serveur dit &lt;code&gt;master&lt;/code&gt; (maître) est celui qui contrôle la zone, il possède le fichier &amp;ldquo;original&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;Dans certains contextes, comme pour éviter la corruption de tous les serveurs en cas d&amp;rsquo;erreur sur le maître, on utilise plusieurs serveurs masters, il n&amp;rsquo;y a plus une seule zone &amp;ldquo;original &amp;rdquo; mais plusieurs, le désavantage d&amp;rsquo;un tel système c&amp;rsquo;est qu&amp;rsquo;on est obligé de mettre à jour chaque serveurs master &lt;em&gt;manuellement&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Le serveur dit &lt;code&gt;slave&lt;/code&gt; (esclave) est celui qui reçoit la zone depuis un serveur master, ce transfert de zone DNS &lt;em&gt;&lt;em&gt;utilise des protocoles comme AXFR ou IXFR &lt;/em&gt;mais ça c&amp;rsquo;est pour demain 😉.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Ce concept de master/slave permet de redonder une zone bien plus facilement que si on le faisait manuellement.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Schéma sur le fonctionnement master/slave" src="/static/img/master-slave-registrar/schema-master-slave.png"&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Ramle</dc:creator><pubDate>Sun, 25 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-25:/master-slave-registrar.html</guid><category>misc</category></item><item><title>Les bases du DNS</title><link>https://ilearned.eu.org/les-bases-du-dns.html</link><description>&lt;p&gt;Pour ce premier post dans la catégorie &lt;em&gt;Today I Learned&lt;/em&gt;, on repart des bases, aujourd&amp;rsquo;hui on parle de DNS 😄. Pour les lecteurs les plus expérimentés connaissant déjà bien les bases du système de DNS, rendez-vous demain 😉. Les prérequis pour aborder cet article sont : des &lt;strong&gt;petites bases de réseau&lt;/strong&gt;, la notion d&amp;rsquo;IP, de nom de domaine, et ça devrait suffire :) Vous trouverez à chaque fois en début d&amp;rsquo;article une petite &amp;ldquo;carte mentale&amp;rdquo; représentant les sujets que nous aurons déjà abordé en lien avec cet article, afin que vous puissiez avoir un accès plus facile aux pré-requis il suffit de cliquer sur le nom de l&amp;rsquo;article ou de la notion dans le schéma pour avoir le lien.&lt;/p&gt;
&lt;p&gt;Le DNS (Domain Name System) est un protocole permettant de &amp;ldquo;traduire&amp;rdquo; un &lt;a href="https://www.wikipedia.com/wiki/Domain_name"&gt;nom de domaine&lt;/a&gt; en une &lt;a href="https://www.wikipedia.com/wiki/IP_address"&gt;adresse IP&lt;/a&gt;. Il existe deux types de serveurs DNS, les serveurs DNS résolveur, aussi appelés récurseurs (comme 1.1.1.1 ou 80.67.169.40 par exemple) servent à &amp;ldquo;traduire&amp;rdquo; un nom de domaine en adresse IP, et les serveurs DNS autoritaires, ce type de serveur DNS &amp;ldquo;fait autorité&amp;rdquo; sur une zone DNS (une zone DNS c&amp;rsquo;est l&amp;rsquo;ensemble des enregistrement DNS, une sorte de base de donnée qui fait la relation entre nom de domaine et IP), c&amp;rsquo;est à lui que vont se référer les serveurs DNS résolveurs pour associer nom de domaine et IP. Ça fait beaucoup de termes d&amp;rsquo;un coup 😅 pour rendre ça plus clair voici un petit schéma et les définitions.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;DNS&lt;/p&gt;
&lt;p&gt;Domain Name Système, protocole servant à traduire un nom de domaine en une adresse IP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Zone DNS&lt;/p&gt;
&lt;p&gt;Ensemble des enregistrement DNS, sorte de base de donnée qui fait la relation etre nom de domaine et IP&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Serveur DNS récurseur&lt;/p&gt;
&lt;p&gt;Serveur DNS &amp;ldquo;intermédiaire&amp;rdquo; qui fait office de passerelle etre les serveurs DNS autoritaires et l&amp;rsquo;utilisateur&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Serveur DNS autoritaire&lt;/p&gt;
&lt;p&gt;Contient tout les enregistrement DNS d&amp;rsquo;une zone.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img alt="Frame 1" src="/static/img/les-bases-des-dns/schema1.png"&gt;&lt;/p&gt;
&lt;p&gt;Vous l&amp;rsquo;imaginez bien, les informations ne sont pas stockées tel-quel sur les serveurs DNS, ils sont stocké sous forme d&amp;rsquo;enregistrement DNS, en voici un exemple commenté tout droit tiré de mon propre serveur DNS autoritaire.&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;eban.bzh.   1800 IN A 89.234.156.60
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;&lt;code&gt;eban.bzh.&lt;/code&gt; correspond au domaine que nous avons demandé, vous vous demanderez sûrement, mais pourquoi y a-t-il un . à la fin ? &lt;em&gt;Comment ça vous ne vous êtes pas posé la question ? 😛&lt;/em&gt; En fait, la résolution des DNS fonctionne sous forme de couches, voici un petit schéma qui explique tout ça&lt;/p&gt;
&lt;p&gt;&lt;img alt="Frame 2" src="/static/img/les-bases-des-dns/schema2.png"&gt;&lt;/p&gt;
&lt;p&gt;Les serveurs DNS &amp;ldquo;root&amp;rdquo; correspondent à la première couche, ils contiennent les records DNS pour tous les &lt;code&gt;TLD&lt;/code&gt; &lt;em&gt;Un TLD ? Quèsaco ?&lt;/em&gt; Un TLD (Top level domain name) c&amp;rsquo;est en fait tout les &lt;code&gt;.&lt;/code&gt; quelque chose que vous rencontrez au quotidien, &lt;code&gt;bzh&lt;/code&gt; , &lt;code&gt;fr&lt;/code&gt;, &lt;code&gt;com&lt;/code&gt;, &lt;code&gt;be&lt;/code&gt; en sont quelques exemples. Les serveurs DNS root contiennent donc les record correspondants aux TLD. &lt;/p&gt;
&lt;p&gt;Les TLD, &lt;code&gt;bzh.&lt;/code&gt; dans notre exemple, contient quant à lui les informations sur les domaines de sa zone, &lt;code&gt;*.bzh.&lt;/code&gt;. &lt;/p&gt;
&lt;p&gt;&lt;code&gt;eban.bzh.&lt;/code&gt; pour finir contient tout les records pour &lt;code&gt;eban.bzh.&lt;/code&gt; et tout ses sous-domaines (&lt;code&gt;git.eban.bzh.&lt;/code&gt;, &lt;code&gt;blog.eban.bzh.&lt;/code&gt;&amp;hellip;) cette &amp;ldquo;couche&amp;rdquo; est appelée &lt;code&gt;FQDN&lt;/code&gt; (Fully Qualified Domain Name). Pour rendre tout ça plus simple voici (à nouveau :p) un petit schéma.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Frame 3" src="/static/img/les-bases-des-dns/schema3.png"&gt;&lt;/p&gt;
&lt;p&gt;Et voilà le schéma corrigé d&amp;rsquo;une requête DNS.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Frame 4" src="/static/img/les-bases-des-dns/schema4.png"&gt;&lt;/p&gt;
&lt;p&gt;Ces petites explications faites, continuons avec notre record &lt;code&gt;eban.bzh.    1800 IN A 89.234.156.60&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;1800&lt;/code&gt; correspond au &lt;a href="https://www.wikiwand.com/fr/Time_to_Live"&gt;TTL&lt;/a&gt; (Time to Live) de ce record, c&amp;rsquo;est le temps en secondes après lequel le serveur DNS résolveur devra réinterroger le serveur DNS autoritaire afin de mettre à jour son cache. Le serveur DNS résolveur gardera donc ce record en cache pendant &lt;code&gt;1800 secondes&lt;/code&gt; puis réinterrogera le serveur DNS autoritaire à la prochaine requête si ce temps est passé.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;IN A&lt;/code&gt; correspond au type du record, ici &lt;code&gt;A&lt;/code&gt; qui correspond à un record qui renvoie une adresse IPv4, il existe de nombreux autres types de records, vous trouverez ci-dessous une liste des plus courants.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;89.234.156.60&lt;/code&gt; enfin correspond à l&amp;rsquo;adresse IP qui nous est renvoyée.&lt;/p&gt;
&lt;table&gt;
&lt;thead&gt;
&lt;tr&gt;
&lt;th&gt;Type&lt;/th&gt;
&lt;th&gt;Définition&lt;/th&gt;
&lt;th&gt;Exemple&lt;/th&gt;
&lt;/tr&gt;
&lt;/thead&gt;
&lt;tbody&gt;
&lt;tr&gt;
&lt;td&gt;A&lt;/td&gt;
&lt;td&gt;Renvoie une Ipv4&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN A 89.234.156.60&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;AAAA&lt;/td&gt;
&lt;td&gt;Renvoie une Ipv6&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN AAAA 2a03:7220:8083:3c00::1&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;CNAME&lt;/td&gt;
&lt;td&gt;Renvoie vers un autre record&lt;/td&gt;
&lt;td&gt;&lt;code&gt;blog.eban.bzh. 1800 IN CNAME veil.eban.bzh.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;NS&lt;/td&gt;
&lt;td&gt;Spécifie les NS d&amp;rsquo;une zone&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN NS ns1.eban.bzh.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;MX&lt;/td&gt;
&lt;td&gt;Indique les serveurs &lt;a href="https://www.wikiwand.com/fr/Simple_Mail_Transfer_Protocol"&gt;SMTP&lt;/a&gt; (mail) à utiliser&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 1800 IN MX 10 spool.mail.gandi.net.&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td&gt;SOA&lt;/td&gt;
&lt;td&gt;Contient les informations suivantes, dans l&amp;rsquo;ordre : &lt;br&gt;  &lt;code&gt;Serveur DNS autoritaire principal&lt;/code&gt; &lt;br&gt; &lt;code&gt;Email de contact&lt;/code&gt;, le @ est remplacé par un point, l&amp;rsquo;adresse ici est donc ns@eban.bzh &lt;br&gt; &lt;code&gt;Serial&lt;/code&gt; &amp;ldquo;version&amp;rdquo; de la zone &lt;br&gt; &lt;code&gt;Refresh&lt;/code&gt; délai en secondes entre demandes d&amp;rsquo;update des slaves &lt;br&gt; &lt;code&gt;Retry&lt;/code&gt; délai en secondes entre demandes d&amp;rsquo;update lors d&amp;rsquo;un fail &lt;br&gt; &lt;code&gt;Expire&lt;/code&gt; expiration de la zone &lt;br&gt; &lt;code&gt;Minimum TTL&lt;/code&gt; TTL pour les records inexistants&lt;/td&gt;
&lt;td&gt;&lt;code&gt;eban.bzh. 86400 IN SOA ns1.eban.bzh. ns.eban.bzh. 1618240745 10800 3600 604800 10800&lt;/code&gt;&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;Si vous voulez essayer d&amp;rsquo;interroger les serveurs DNS à la main, &lt;code&gt;dig(1)&lt;/code&gt; est un bon outil, il existe aussi la commande &lt;code&gt;nslookup&lt;/code&gt; pour les &lt;s&gt;hérétiques&lt;/s&gt; personnes sous Windows.&lt;/p&gt;
&lt;p&gt;Pour les plus curieux, voici un petit bonus :) Nous allons analyser ce qui se passe concrètement sur un réseau local lors d&amp;rsquo;un requête DNS vers un serveur DNS résolveur.
Cette petite analyse est faite sur un système basé sur &lt;code&gt;linux&lt;/code&gt; mais est aussi valable pour Windows. J&amp;rsquo;ai donc capturé le trafic sortant de ma machine avec un outil nommé &lt;code&gt;tcpdump(8)&lt;/code&gt;. Et voici ce que l&amp;rsquo;on obtient&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre&gt;&lt;span&gt;&lt;/span&gt;&lt;code&gt;&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.272734&lt;/span&gt; &lt;span class="n"&gt;IP&lt;/span&gt; &lt;span class="mf"&gt;10.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;60081&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;proto&lt;/span&gt; &lt;span class="n"&gt;UDP&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt;&lt;span class="o"&gt;?&lt;/span&gt; &lt;span class="n"&gt;eban&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="na"&gt;bzh&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;37&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;span class="mi"&gt;10&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mi"&gt;31&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt;&lt;span class="mf"&gt;13.309725&lt;/span&gt; &lt;span class="n"&gt;IP&lt;/span&gt; &lt;span class="mf"&gt;10.0&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt; &lt;span class="o"&gt;&amp;gt;&lt;/span&gt; &lt;span class="mf"&gt;10.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;0.2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mi"&gt;60081&lt;/span&gt;&lt;span class="o"&gt;:&lt;/span&gt; &lt;span class="n"&gt;proto&lt;/span&gt; &lt;span class="n"&gt;UDP&lt;/span&gt; &lt;span class="n"&gt;A&lt;/span&gt; &lt;span class="mf"&gt;89.234&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="mf"&gt;156.60&lt;/span&gt; &lt;span class="o"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;53&lt;/span&gt;&lt;span class="o"&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;

&lt;p&gt;On voit donc que l&amp;rsquo;ordinateur va interroger le serveur DNS (ici sur &lt;code&gt;10.0.0.1&lt;/code&gt;) sur le port 53 qui est le port par défaut du protocole DNS pour lui demander un record &lt;code&gt;A&lt;/code&gt; pour la zone &lt;code&gt;eban.bzh.&lt;/code&gt;. On remarque aussi que ce protocole est basé sur le protocole &lt;code&gt;UDP&lt;/code&gt; que nous étudierons sûrement d&amp;rsquo;ici peu longtemps ;). Le serveur DNS répond ensuite à la demande en renvoyant le type de record (ici &lt;code&gt;A&lt;/code&gt;) et l&amp;rsquo;adresse IP demandée.&lt;/p&gt;
&lt;p&gt;Voilà, c&amp;rsquo;en est finit pour ce premier post de la catégorie Today I Learned, demain nous nous intéresserons au fonctionnement à la fonction d&amp;rsquo;un &lt;strong&gt;&lt;code&gt;registrar&lt;/code&gt;&lt;/strong&gt; ainsi qu&amp;rsquo;au fonctionnement des serveurs DNS autoritaires sur le principe de &lt;strong&gt;&lt;code&gt;slave/master&lt;/code&gt;&lt;/strong&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 24 Apr 2021 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-04-24:/les-bases-du-dns.html</guid><category>misc</category></item><item><title>SolarWinds, l'arbre qui cache la forêt 👾</title><link>https://ilearned.eu.org/solarwinds-larbre-qui-cache-la-foret.html</link><description>&lt;h2 id="avant-propos"&gt;Avant propos&lt;/h2&gt;
&lt;p&gt;Cet article a pour but de retracer les évènements à propos de la récente attaque dont SolarWinds a été victime, ces actualités étant relativement récentes à l&amp;rsquo;heure où j&amp;rsquo;écris cet article (07/02/2021) des mises à jour seront sûrement apportées à ce dernier.&lt;/p&gt;
&lt;h2 id="signal-dalarme"&gt;Signal d&amp;rsquo;alarme&lt;/h2&gt;
&lt;p&gt;Le 8 décembre 2020, Kevin Mandia, PDG de la société FireEye poste un communiqué nommé &lt;a href="https://www.fireeye.com/blog/products-and-services/2020/12/fireeye-shares-details-of-recent-cyber-attack-actions-to-protect-community.html"&gt;FireEye Shares Details of Recent Cyber Attack, Actions to Protect Community&lt;/a&gt; dans lequel il informe que l&amp;rsquo;entreprise a été victime d&amp;rsquo;une cyberattaque de la part d&amp;rsquo;un &amp;ldquo;acteur hautement sophistiqué&amp;rdquo; et que ce dernier avait accédé à leur réseau interne et volé un grand nombre d&amp;rsquo;outils de Red Team de la société. Ce communiqué fait aussi part du fait que &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sa discipline, sa sécurité opérationnelle et ses techniques nous conduisent à penser que [l&amp;rsquo;acteur malveillant derrière cette attaque] était soutenu par un état&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Matt Gorham le directeur adjoint de la division cyber du FBI indique dans la foulée&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Le FBI enquête sur l&amp;rsquo;incident  et les premières constatations montrent un acteur avec un haut niveau de sophistication conforme à un État-nation&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Ce qui semble donc confirmer les dires de FireEye.&lt;/p&gt;
&lt;p&gt;Le 08 décembre 2020 à 20h11, dans &lt;a href="https://www.nytimes.com/2020/12/08/technology/fireeye-hacked-russians.html"&gt;un article&lt;/a&gt; le New York Times suppute que &lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ce piratage soulève la possibilité que les agences de renseignement russes aient vu un avantage à monter l&amp;rsquo;attaque alors que l&amp;rsquo;attention américaine - y compris celle de FireEye - était concentrée sur la sécurisation du système des élections présidentielles.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Sans pour autant apporter de preuve tangible.&lt;/p&gt;
&lt;p&gt;Le 13 décembre 2020, coup de tonnerre, FireEye indique dans &lt;a href="https://www.fireeye.com/blog/products-and-services/2020/12/global-intrusion-campaign-leverages-software-supply-chain-compromise.html"&gt;ce communiqué&lt;/a&gt; que l&amp;rsquo;attaque qu&amp;rsquo;ils ont subi a été propagée par le système de mise à jour d&amp;rsquo;Orion, un logiciel de gestion de réseau édité par SolarWinds, un cheval de Troie nommé Sunburst avait été inséré dans les version 2019.4 HF 5, 2020.2 et 2020.2 HF 1 d&amp;rsquo;Orion. Microsoft, les départements américains du Commerce, du Trésor, de l&amp;rsquo;Énergie et plus encore ont déclaré avoir été victimes de cette cyberattaque.&lt;/p&gt;
&lt;h2 id="un-peu-de-reverse-engineering"&gt;Un peu de reverse engineering&lt;/h2&gt;
&lt;p&gt;Ce travail d&amp;rsquo;analyse est en grande partie basé sur les travaux de &lt;a href="https://www.youtube.com/channel/UCND1KVdVt8A580SjdaS4cZg"&gt;Colin Hardy.&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Ce malware a été conçu pour être le plus discret possible, lors de la première exécution, le code malveillant commence par attendre 12 à 14 jours avant de s&amp;rsquo;exécuter. &lt;img alt="Screenshot de la fonction" src="https://i.postimg.cc/Y2ZNCqJc/Group-1-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Puis, il vérifie si le hostname de la machine contient &lt;em&gt;&amp;ldquo;solarwinds&amp;rdquo;&lt;/em&gt; ou &lt;em&gt;&amp;ldquo;test&amp;rdquo;&lt;/em&gt;, ou s&amp;rsquo;il correspond à une liste de noms d&amp;rsquo;hôte qui contient, par exemple, swdev.dmz, swdev.local, on peut donc imaginer que l&amp;rsquo;attaquant a eu accès au réseau local de SolarWinds et a pu collecter ces noms d&amp;rsquo;hôte&amp;hellip; Tout cela dans le but d&amp;rsquo;éviter que le malware ne se déclenche sur un émulateur d&amp;rsquo;un AV et qu&amp;rsquo;il soit détecté. &lt;/p&gt;
&lt;p&gt;&lt;img alt="Deuxième screenshot" src="https://i.postimg.cc/d0V8cwKf/Group-2-6.png"&gt;&lt;/p&gt;
&lt;p&gt;Le malware va ensuite vérifier si, dans la liste des processus actifs sur la machine, un ou plusieurs correspond à une liste qui contient les noms de processus d&amp;rsquo;antivirus (f-secure gatekeeper, carbonblack), de Command and Control (csagent, csfalconcontainer) - probablement afin de ne pas infecter une machine qui le serait déjà - de logiciels de virtualisation (vboxservice) et même d&amp;rsquo;analyse réseau (wireshark, tcpdump). Tout cela dans la but de rester le plus discret possible.&lt;/p&gt;
&lt;p&gt;Puis, un userID est créé, il est généré à partir du hostname de la machine, du MachineGuid et de l&amp;rsquo;adresse MAC&lt;/p&gt;
&lt;p&gt;&lt;a href="https://postimg.cc/SnbF8Dq2"&gt;&lt;img alt="Group-3.png" src="https://i.postimg.cc/htfSk55r/Group-3.png"&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Le code malveillant fait ensuite appel au domaine &lt;em&gt;avsvmcloud.com&lt;/em&gt;, il génère une URL avec la fonction suivante&lt;/p&gt;
&lt;p&gt;&lt;img alt="Group-5.png" src="https://i.postimg.cc/NFngF8yT/Group-5.png"&gt;&lt;/p&gt;
&lt;p&gt;Cette URL est composée du domaine &lt;em&gt;eu-west-1.appsync-api.avsvmcloud.com&lt;/em&gt; (la &lt;em&gt;eu-west-1&lt;/em&gt; peut aussi être &lt;em&gt;us-west-2&lt;/em&gt;, &lt;em&gt;us-east-1&lt;/em&gt; ou &lt;em&gt;us-east-2&lt;/em&gt;, le choix est fait aléatoirement) et d&amp;rsquo;un sous domaine qui est généré par la fonction DecryptShort à partir du UserID généré plus tôt et du hostname de la machine. C&amp;rsquo;est à partir de ce sous-domaine que la machine communique avec le C2.&lt;/p&gt;
&lt;p&gt;Je n&amp;rsquo;irais pas plus loin dans l&amp;rsquo;analyse de ce malware, la partie communication avec le C2 étant relativement complexe et peu intéressante selon moi.&lt;/p&gt;
&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Le 10 juin 2021, le spécialiste en cybersécurité Kaspersky publie un article dans lequel il indique que la backdoor de Sunburst a beaucoup de similitude avec une autre nommée Kazuar, une backdoor qui a été attribuée à la Russie. Cette attaque pourrait donc etre appuyée par le FSB. Le 29 janvier 2021, Brandon Wales, dirigeant du CISA a révélé dans le &lt;a href="https://www.wsj.com/articles/suspected-russian-hack-extends-far-beyond-solarwinds-software-investigators-say-11611921601"&gt;Wall Street Journal&lt;/a&gt; que 30 % des victimes de l’attaque ne seraient pas clientes de SolarWinds, cette attaque pourrait donc etre seulement la face visible d&amp;rsquo;une grande opération de cyberespionnage.&lt;/p&gt;
&lt;p&gt;Merci beaucoup d&amp;rsquo;avoir lu cette article, si vous avez des questions / remarques, n&amp;rsquo;hésitez pas à m&amp;rsquo;en faire part &lt;a href="https://twitter.com/eban_non/status/1358429605376458752"&gt;ici&lt;/a&gt; ou par mail à &lt;a href="mailto:contact+blog@eban.bzh"&gt;contact@eban.bzh&lt;/a&gt;&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Sat, 06 Feb 2021 00:00:00 +0100</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2021-02-06:/solarwinds-larbre-qui-cache-la-foret.html</guid><category>misc</category></item><item><title>WannaCry, le virus le plus dévastateur jamais créé 👾</title><link>https://ilearned.eu.org/wannacry-le-virus-le-plus-devastateur-jamais-cree.html</link><description>&lt;p&gt;En mai 2017, un virus informatique du nom de WannaCry fait son apparition, il a infecté quelques 300 000 ordinateurs dans plus de 150 pays ! Trois ans plus tard, revenons ensemble sur le ransomware le plus dévastateur jamais créé.&lt;/p&gt;
&lt;h3 id="la-genese-du-projet"&gt;La genèse du projet&lt;/h3&gt;
&lt;p&gt;Le 13 août 2016, un groupe de hackers dénommé &lt;strong&gt;The Shadow Brokers&lt;/strong&gt; met en libre téléchargement sur Tumblr, GitHub et Pastebin de nombreux programmes d&amp;rsquo;espionnage et de piratage informatique de la NSA dont la faille de sécurité EternalBlue, cette dernière permettant une RCE (remote code execution) sur un machine distante à partir d&amp;rsquo;un partage SMBv1 (plus d&amp;rsquo;infos &lt;a href="https://docs.microsoft.com/fr-fr/security-updates/SecurityBulletins/2017/ms17-010"&gt;ici&lt;/a&gt;).
Cette vulnérabilité a été utilisée par le malware WannaCry afin de se propager.&lt;/p&gt;
&lt;p&gt;Ce virus aujourd&amp;rsquo;hui attribué a la Corée du Nord et plus particulièrement au groupe Lazarus par de nombreux acteurs tel que le conseiller à la sécurité intérieure des USA &lt;a href="https://www.washingtonpost.com/world/national-security/us-set-to-declare-north-korea-carried-out-massive-wannacry-cyber-attack/2017/12/18/509deb1c-e446-11e7-a65d-1ac0fd7f097e_story.html"&gt;Tom Bossert&lt;/a&gt; ou le chercheur en cybersécurité Matthieu Suiche interrogé par &lt;a href="https://yewtu.be/watch?v=Mp3TH5PI6rc"&gt;Envoyé Spécial&lt;/a&gt; aurait donc été créé dans un but lucratif.&lt;/p&gt;
&lt;h3 id="fonctionnement-du-ransomware"&gt;Fonctionnement du Ransomware&lt;/h3&gt;
&lt;p&gt;Comme vu plus haut, WannaCry se propage tout seul (c&amp;rsquo;est un virus auto-répliquant ou vers) grâce à la faille de sécurité EternalBlue. Une fois executé sur la machine, le logiciel se met à chiffrer tout les fichiers personnels de l&amp;rsquo;ordinateur avec la méthode de chiffrement AES-128 (Une paire de clés RSA est générée au lancement du programme, la clé privée était utilisée pour chiffrer les fichiers).
Après l&amp;rsquo;infection, une somme équivalente à 300€ (voir 600€ en fonction des cas) en Bitcoin est demandée pour déchiffrer les fichiers. Il n&amp;rsquo;existe aucune preuve du fait que les personnes derrière WannaCry sont en capacité de déchiffrer les fichiers.
En effet, il est impossible pour les pirates de relier une transaction à un ordinateur spécifique. Une fois lancé, le logiciel installe aussi Tor sur la machine et essaie de se connecter aux serveurs C2 (&lt;a href="https://www.wikiwand.com/en/Command_and_control"&gt;Command and Control&lt;/a&gt;) suivants:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;gx7ekbenv2riucmf.onion&lt;/li&gt;
&lt;li&gt;57g7spgrzlojinas.onion&lt;/li&gt;
&lt;li&gt;xxlvbrloxvriy2c5.onion&lt;/li&gt;
&lt;li&gt;76jdd2ir2embyv47.onion&lt;/li&gt;
&lt;li&gt;cwwnhwhlz52maqm7.onion&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="un-antidote"&gt;Un Antidote ?&lt;/h3&gt;
&lt;p&gt;Un groupe de trois experts en sécurité informatique français ont créé logiciel nommé &lt;a href="https://github.com/gentilkiwi/wanakiwi"&gt;Wanakiwi&lt;/a&gt;.
Cet outil permet de déchiffrer les fichiers qui l&amp;rsquo;ont été par WannaCry.
WannaCry utilise &lt;a href="https://fr.wikipedia.org/wiki/Cryptographic_Application_Programming_Interface"&gt;&lt;strong&gt;CryptoAPI&lt;/strong&gt;&lt;/a&gt; (les fonctions cryptographiques de Windows) pour générer les clés de chiffrement, cependant ces fonctions inscrivent dans la RAM de l&amp;rsquo;ordinateur la clé privée en claire, WanaKiwi va donc aller chercher dans la RAM des traces de la clé privée utilisée pour chiffrer les données.&lt;/p&gt;
&lt;h3 id="comment-se-premunir-de-ce-type-dattaques-dans-le-futur"&gt;Comment se prémunir de ce type d&amp;rsquo;attaques dans le futur ?&lt;/h3&gt;
&lt;p&gt;On ne le dira jamais assez, mais n&amp;rsquo;ouvrez jamais de pièces jointes venant d&amp;rsquo;un destinataire inconnu.
Mettez à jour régulièrement votre OS, Microsoft propose une fonction très intéressante dans leur suite de sécurité Windows Defender nommée &lt;strong&gt;Dispositif d&amp;rsquo;accès contrôlé aux dossiers&lt;/strong&gt;.
Cet outil permet de contrôler l&amp;rsquo;accès aux fichiers systèmes de Windows et aux données personnelles des utilisateurs par des programmes, il fonctionne avec un système de withelist, chaque programme doit donc être autorisé manuellement pour pouvoir modifier ces fichiers (plus d&amp;rsquo;infos &lt;a href="https://docs.microsoft.com/fr-fr/windows/security/threat-protection/microsoft-defender-atp/evaluate-controlled-folder-access"&gt;ici&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;Merci d&amp;rsquo;avoir lu cet article, j&amp;rsquo;espère qu&amp;rsquo;il vous aura plu.
Je suis preneur de vos retours :)&lt;/p&gt;
&lt;h3 id="remerciements"&gt;Remerciements&lt;/h3&gt;
&lt;p&gt;Merci à xeway, 0xThxmxs, Shcanovishka, Sycorax, look, Ramle et Lancelot de m&amp;rsquo;avoir aidé pour la relecture.&lt;/p&gt;
&lt;p&gt;Sources :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;https://fr.wikipedia.org/wiki/WannaCry&lt;/li&gt;
&lt;li&gt;https://fr.wikipedia.org/wiki/The_Shadow_Brokers&lt;/li&gt;
&lt;li&gt;https://docs.microsoft.com/fr-fr/security-updates/SecurityBulletins/2017/ms17-010&lt;/li&gt;
&lt;li&gt;https://www.washingtonpost.com/world/national-security/us-set-to-declare-north-korea-carried-out-massive-wannacry-cyber-attack/2017/12/18/509deb1c-e446-11e7-a65d-1ac0fd7f097e_story.html&lt;/li&gt;
&lt;li&gt;https://yewtu.be/watch?v=Mp3TH5PI6rc&lt;/li&gt;
&lt;li&gt;https://www.secureworks.com/research/wcry-ransomware-analysis&lt;/li&gt;
&lt;li&gt;https://fr.wikipedia.org/wiki/Cryptographic_Application_Programming_Interface&lt;/li&gt;
&lt;li&gt;https://docs.microsoft.com/fr-fr/windows/security/threat-protection/microsoft-defender-atp/evaluate-controlled-folder-access&lt;/li&gt;
&lt;/ul&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Wed, 12 Aug 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-08-12:/wannacry-le-virus-le-plus-devastateur-jamais-cree.html</guid><category>Culture Hack</category></item><item><title>Vos mots de passe sont ils vraiment sécurisés 🔐</title><link>https://ilearned.eu.org/vos-mots-de-passe-sont-ils-vraiment-securises.html</link><description>&lt;p&gt;Aujourd&amp;rsquo;hui, nous utilisons des mots de passe partout, pour déverrouiller son téléphone, son ordinateur, son compte en banque et bien d&amp;rsquo;autres. Il parait donc indispensable d&amp;rsquo;avoir des mots de passe &lt;strong&gt;forts&lt;/strong&gt; pour sécuriser ces comptes. Dans cet article nous allons donc nous pencher sur comment sécuriser ces précieux sésames.&lt;/p&gt;
&lt;h3 id="1-avoir-des-mots-de-passe-differents"&gt;1) Avoir des mots de passe différents&lt;/h3&gt;
&lt;p&gt;Il est très important d&amp;rsquo;avoir des mots de passe différents sur chaque compte, imaginez un de vos comptes est piraté et votre mot de passe est récupéré, il suffirait donc au pirate de réutiliser ce même mot de passe sur tous vos comptes pour y avoir accès… Etant donné qu&amp;rsquo;il est impossible de retenir des dizaines de mots de passe différents, les gestionnaires de mots de passe ont été inventés, ils permettent de n&amp;rsquo;avoir qu&amp;rsquo;à retenir qu&amp;rsquo;un mot de passe, celui de votre gestionnaire ! Il existe de nombreux services de gestionnaires de mots de passe, je vous conseille :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="Nexcloud Passwords"&gt;https://apps.nextcloud.com/apps/passwords&lt;/a&gt; (Si vous avez un cloud Nextcloud, Nexcloud Passwords est le meilleur gestionnaire de mots de passe)&lt;/li&gt;
&lt;li&gt;&lt;a href="Bitwarden"&gt;https://bitwarden.com/&lt;/a&gt; (Très bon gestionnaire de mot de passe entièrement open source)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Il ne vous reste plus qu&amp;rsquo;à installer un de ces services sur tout vos appareils.&lt;/p&gt;
&lt;h3 id="2-utiliser-des-mots-de-passe-vraiment-complexes"&gt;2) Utiliser des mots de passe vraiment complexes&lt;/h3&gt;
&lt;p&gt;Le meilleur moyen d&amp;rsquo;avoir des mots de passe sécurisés est d&amp;rsquo;utiliser des caractères spéciaux, traditionnellement on recommande d&amp;rsquo;utiliser des caractères comme @, $ ou *.
Il existe cependant une façon plus facile mais méconnue d&amp;rsquo;avoir un mot de passe complexe facilement, &lt;strong&gt;les emojis&lt;/strong&gt;.
Beaucoup de services acceptent les emojis comme mot de passe ! En voici une liste :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Twitter ✅&lt;/li&gt;
&lt;li&gt;Github ✅&lt;/li&gt;
&lt;li&gt;Amazon ✅&lt;/li&gt;
&lt;li&gt;Discord ✅&lt;/li&gt;
&lt;li&gt;Protonmail ✅&lt;/li&gt;
&lt;li&gt;Spotify ✅&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;On peut aussi, pour sécuriser nos mots de passe, utiliser des caractères d&amp;rsquo;autres alphabets que l&amp;rsquo;alphabet latin, du cyrillique, des lettres de l&amp;rsquo;alphabet arabe ou même des caractères en Japonais, Coréen, en bref tous les charactères de la table Unicode.&lt;/p&gt;
&lt;p&gt;Pour simplifier cette démarche de création de mot de passe, j&amp;rsquo;ai fait un petit script Python sur mon Github disponible &lt;a href="https://github.com/ebanDev/unicode-password-generator"&gt;ici&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;Il est enfin, très important d&amp;rsquo;activer l&amp;rsquo;A2F sur tous vos comptes, je recommande l&amp;rsquo;app Aegis pour mettre en place cette authentification à deux facteurs.&lt;/p&gt;
&lt;p&gt;Il existe aussi des Clés USB A2F ! Plus sécurisées qu&amp;rsquo;une app sur mobile&amp;hellip; En voici une liste : &lt;a href="https://shutuptrackers.com/hardware/authentification.php"&gt;https://shutuptrackers.com/hardware/authentification.php&lt;/a&gt;&lt;/p&gt;
&lt;h2 id="remerciements"&gt;Remerciements&lt;/h2&gt;
&lt;p&gt;Merci à Erispar pour la relecture.&lt;/p&gt;
&lt;p&gt;Merci à 0x66 de m&amp;rsquo;avoir donné l&amp;rsquo;idée de parler des Clés USB A2F.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Wed, 22 Jul 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-07-22:/vos-mots-de-passe-sont-ils-vraiment-securises.html</guid><category>Tutoriel</category></item><item><title>Debuter dans l'infosec 👨‍💻</title><link>https://ilearned.eu.org/debuter-dans-linfosec.html</link><description>&lt;p&gt;Dans ce nouvel article, nous allons traiter de la fameuse question&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;La sécurité informatique, ca m&amp;rsquo;intéresse, mais par où commencer ?&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Par où commencer, la question est vaste mais voici un petit résumé des prérequis nécessaires pour commencer dans l&amp;rsquo;Infosec :&lt;/p&gt;
&lt;p&gt;Pour commencer dans le monde de la cybersecurité, il est recommandé d&amp;rsquo;apprendre un language de scripting tel que le python ( voici un très bon cours venant du site de &lt;a href="https://zestedesavoir.com/tutoriels/799/apprendre-a-programmer-avec-python-3/"&gt;zeste de savoir&lt;/a&gt;, les bases des languages web sont aussi quasi-indispensables (&lt;a href="https://apprendre-html.3wa.fr/courses"&gt;ici&lt;/a&gt; ou &lt;a href="https://openclassrooms.com/fr/courses/918836-concevez-votre-site-web-avec-php-et-mysql"&gt;là&lt;/a&gt; vous pourrez trouver un cours sur le html, le css, le js ainsi que le php) il est aussi important d&amp;rsquo;apprendre les bases du fonctionnement des protocoles réseaux les plus courants (voici &lt;a href="https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip"&gt;un cours&lt;/a&gt; qui peut vous aider à comprendre ces protocoles), pour finir, je recommanderais de passer sous une distribution Linux comme Ubuntu ou Arch pour les plus téméraires et de vous familiariser avec cet OS et au terminal linux.&lt;/p&gt;
&lt;p&gt;Une fois tout ces prerequis validés, vous pourrez vous entrainer sur Root-Me&lt;/p&gt;
&lt;h2 id="specialisation"&gt;Spécialisation&lt;/h2&gt;
&lt;p&gt;Après avoir découvert les bases de ce milieu, vous pourrez vous spécialiser dans certains domaines spécifiques&lt;/p&gt;
&lt;h4 id="le-rereverse-engineering-retro-ingenerie"&gt;Le RE(Reverse Engineering / Rétro Ingénerie)&lt;/h4&gt;
&lt;p&gt;Le Reverse Engineering est le fait d&amp;rsquo;étudier le fonctionnement d&amp;rsquo;un programme pour en comprendre le fonctionnement sans avoir le code source de celui-ci.
Pour débuter dans ce domaine, il est indispensable de connaitre le &lt;a href="https://zestedesavoir.com/tutoriels/755/le-langage-c-1/"&gt;language C&lt;/a&gt; ainsi que de &lt;a href="https://www.youtube.com/watch?v=yxzUi8MdOAA&amp;amp;list=PLcT0DaY68xGzzmj47WSbb8XaIwWFjVlKz"&gt;l&amp;rsquo;assembleur&lt;/a&gt; (de préférence x86_64).
Vous pourrez alors vous entraîner sur des crackme, si vous voulez de l&amp;rsquo;aide ou seulement discuter de ces sujets, je vous invite à rejoindre l&amp;rsquo;un des serveurs discord listés ci-dessous.&lt;/p&gt;
&lt;h4 id="les-ctfs"&gt;Les CTFs&lt;/h4&gt;
&lt;p&gt;Les CTFs consistent en un machine faite pour être &lt;em&gt;piratée&lt;/em&gt;, le but est de devenir administrateur (ou &lt;em&gt;root&lt;/em&gt;) de la machine en utilisant plusieurs failles informatiques. Pour vous entrainer à cela, je vous invite à aller sur &lt;a href="https://hackthebox.eu"&gt;HackTheBox&lt;/a&gt; ainsi que sur &lt;a href="https://vulnhub.com"&gt;Vulnhub&lt;/a&gt;.
Comme dans le domaine du reverse engineering, si vous avez besoin d&amp;rsquo;aide pour le CTF n&amp;rsquo;hésitez pas à rejoindre un serveur discord, parfois les plateformes proposent le leur pour les haxors.&lt;/p&gt;
&lt;h2 id="bonus-ressources"&gt;Bonus : Ressources&lt;/h2&gt;
&lt;p&gt;Voici une liste non exhaustive de ressources qui pourraient vous aider :&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/wapiflapi/exrs"&gt;https://github.com/wapiflapi/exrs&lt;/a&gt; (Exercices de RE)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://root-me.org/"&gt;https://root-me.org/&lt;/a&gt; (Challenges toutes catégories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.newbiecontest.org/"&gt;https://www.newbiecontest.org/&lt;/a&gt; (Challenges toutes catégories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hackthebox.eu/"&gt;https://www.hackthebox.eu/&lt;/a&gt; (Challenges, plus orienté test d&amp;rsquo;intrusion)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.vulnhub.com/"&gt;https://www.vulnhub.com/&lt;/a&gt; (VM vulnérables)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.dailysecurity.fr/"&gt;https://www.dailysecurity.fr/&lt;/a&gt; (Blog de Geluchat)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://beta.hackndo.com/"&gt;https://beta.hackndo.com/&lt;/a&gt; (Blog de pixis)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hacktion.be/"&gt;https://www.hacktion.be/&lt;/a&gt; (Blog de Que20)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inf0sec.fr/"&gt;https://inf0sec.fr/&lt;/a&gt; (Blog de Unknow101 orienté test d&amp;rsquo;intrusion windows)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://sideway.re/"&gt;https://sideway.re/&lt;/a&gt; (Blog de @SideWay&amp;rsquo;CSS )&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inshallhack.org/"&gt;https://inshallhack.org/&lt;/a&gt; (Blog de l&amp;rsquo;équipe française de CTF [Inshall&amp;rsquo;hack] (https://ctftime.org/team/44256))&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.google.fr/"&gt;https://www.google.fr/&lt;/a&gt; (RTFM, la base avant toute question.)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://exploit.education/"&gt;http://exploit.education/&lt;/a&gt; (Un bon site pour débuter en pwn)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/heAw9mZ"&gt;Rainbow&lt;/a&gt; (Serveur discord parlant d&amp;rsquo;infosec mais aussi de programmation.)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/YEy6aZ4"&gt;inf0sec&lt;/a&gt; (Serveur discord de [@inf0sec1] (https://twitter.com/inf0sec1) parlant de cybersécurité)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/gFws9jH"&gt;ret2school&lt;/a&gt; (Serveur discord de &lt;a href="https://twitter.com/nasm_re"&gt;@nasm_re&lt;/a&gt; et de l&amp;rsquo;équipe de CTF, &lt;a href="https://twitter.com/ret2school_fr"&gt;ret2school&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id="remerciements"&gt;Remerciements :&lt;/h5&gt;
&lt;p&gt;Merci à SoEasY de m&amp;rsquo;avoir aidé pour la définition du RE.&lt;/p&gt;
&lt;p&gt;Merci à MorpheusH3x pour la liste des ressources.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 10 Jul 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-07-10:/debuter-dans-linfosec.html</guid><category>misc</category></item><item><title>Getting started in infosec</title><link>https://ilearned.eu.org/getting-started-in-infosec.html</link><description>&lt;p&gt;In this new article, we will deal with the famous question&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&amp;ldquo;I&amp;rsquo;m interested in computer security, but where to start?&amp;rdquo;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Where to start, the question is vast but here is a small summary of the prerequisites necessary to start in Infosec :&lt;/p&gt;
&lt;p&gt;To start in the world of cybersecurity, it is recommended to learn a scripting language such as Python (here is a very good course coming from the site of &lt;a href="https://zestedesavoir.com/tutoriels/799/apprendre-a-programmer-avec-python-3/"&gt;zeste de savoir (fr)&lt;/a&gt;), the basics of web languages are also almost essential (&lt;a href="https://apprendre-html.3wa.fr/courses"&gt;here (fr)&lt;/a&gt; or &lt;a href="https://openclassrooms.com/fr/courses/918836-concevez-votre-site-web-avec-php-et-mysql"&gt;there (fr)&lt;/a&gt; you can find a course on html, css, js and php ) it is also important to learn the basics of how the most common network protocols work (&lt;a href="https://openclassrooms.com/fr/courses/857447-apprenez-le-fonctionnement-des-reseaux-tcp-ip"&gt;here (fr)&lt;/a&gt; is a course that can help you understand these protocols). Finally, I would recommend to switch to a Linux distribution like Ubuntu or Arch for the more adventurous and to familiarize yourself with this OS and the Linux terminal.&lt;/p&gt;
&lt;p&gt;Once all these prerequisites are validated, you can train on Root-Me.&lt;/p&gt;
&lt;h2 id="specialization"&gt;Specialization :&lt;/h2&gt;
&lt;p&gt;After having discovered the basics of this field, you will be able to specialize in certain specific areas.&lt;/p&gt;
&lt;h4 id="the-re-reverse-engineering"&gt;The RE (Reverse Engineering) :&lt;/h4&gt;
&lt;p&gt;Reverse Engineering is the fact of studying the functioning of a program to understand its operation without having the source code of it.
To start in this field, it is essential to know the C language &lt;a href="https://zestedesavoir.com/tutoriels/755/le-langage-c-1/"&gt;ressource (fr)&lt;/a&gt; and assembler (preferably x86_64) &lt;a href="https://www.youtube.com/watch?v=yxzUi8MdOAA&amp;amp;list=PLcT0DaY68xGzzmj47WSbb8XaIwWFjVlKz"&gt;ressource (fr)&lt;/a&gt;.
You will then be able to train on crackme, if you want help or just discuss these topics, I invite you to join one of the discord servers listed below.&lt;/p&gt;
&lt;h4 id="ctfs"&gt;CTFs :&lt;/h4&gt;
&lt;p&gt;The CTFs consist in a machine made to be &lt;em&gt;hacked&lt;/em&gt;, the goal is to become administrator (or &lt;em&gt;root&lt;/em&gt;) of the machine by using several computer flaws. To practice this, I invite you to go on &lt;a href="https://hackthebox.eu"&gt;HackTheBox&lt;/a&gt; and on &lt;a href="https://vulnhub.com"&gt;Vulnhub&lt;/a&gt;.
As in the field of reverse engineering, if you need help for CTF do not hesitate to join a discord server, sometimes platforms propose their own for haxors.&lt;/p&gt;
&lt;h2 id="bonus-resources"&gt;Bonus : Resources&lt;/h2&gt;
&lt;p&gt;Here is a non-exhaustive list of resources that might help you:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="https://github.com/wapiflapi/exrs"&gt;https://github.com/wapiflapi/exrs&lt;/a&gt; (RE exercises)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://root-me.org/"&gt;https://root-me.org/&lt;/a&gt; (Challenges: all categories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.newbiecontest.org/"&gt;https://www.newbiecontest.org/&lt;/a&gt; (Challenges: all categories)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hackthebox.eu/"&gt;https://www.hackthebox.eu/&lt;/a&gt; (Rooms penetration test oriented)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.vulnhub.com/"&gt;https://www.vulnhub.com/&lt;/a&gt; (Vulnerable VMs, like hackthebox but locally)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.dailysecurity.fr/"&gt;https://www.dailysecurity.fr/&lt;/a&gt; (Geluchat&amp;rsquo;s blog)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://beta.hackndo.com/"&gt;https://beta.hackndo.com/&lt;/a&gt; (pixis&amp;rsquo;s blog)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.hacktion.be/"&gt;https://www.hacktion.be/&lt;/a&gt; (Que20&amp;rsquo;s blog)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inf0sec.fr/"&gt;https://inf0sec.fr/&lt;/a&gt; (Unknow101&amp;rsquo;s blog about windows penetration testing)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://sideway.re/"&gt;https://sideway.re/&lt;/a&gt; (Blog of @SideWay&amp;rsquo;CSS )&lt;/li&gt;
&lt;li&gt;&lt;a href="https://inshallhack.org/"&gt;https://inshallhack.org/&lt;/a&gt; (Blog of the french CTF team &lt;a href="https://ctftime.org/team/44256"&gt;Inshall&amp;rsquo;hack&lt;/a&gt;)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://www.google.fr/"&gt;https://www.google.fr/&lt;/a&gt; (RTFM, the base before any question)&lt;/li&gt;
&lt;li&gt;&lt;a href="http://exploit.education/"&gt;http://exploit.education/&lt;/a&gt; (A site that will teach you the basics in pwn)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://cryptopals.com/"&gt;https://cryptopals.com/&lt;/a&gt; (A site that will teach you the basics in crypto)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/heAw9mZ"&gt;Rainbow&lt;/a&gt; (Discord server talking about infosec but also programming)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/YEy6aZ4"&gt;inf0sec&lt;/a&gt; (Discord server from &lt;a href="https://twitter.com/inf0sec1"&gt;@inf0sec1&lt;/a&gt; talking about cybersecurity)&lt;/li&gt;
&lt;li&gt;&lt;a href="https://discord.gg/gFws9jH"&gt;ret2school&lt;/a&gt; (Discord server from &lt;a href="https://twitter.com/nasm_re"&gt;@nasm_re&lt;/a&gt; and the &lt;a href="https://twitter.com/ret2school_fr"&gt;ret2school team&lt;/a&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;h5 id="acknowledgements"&gt;Acknowledgements :&lt;/h5&gt;
&lt;p&gt;Thanks to &lt;a href="https://twitter.com/0xSoEasY"&gt;SoEasY&lt;/a&gt; for helping me with the RE definition.&lt;/p&gt;
&lt;p&gt;Thanks to &lt;a href="https://twitter.com/MorpheusH3x"&gt;MorpheusH3x&lt;/a&gt; for the list of resources.&lt;/p&gt;
&lt;p&gt;Translated by &lt;a href="https://twitter.com/MorpheusH3x"&gt;MorpheusH3x&lt;/a&gt;.&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Fri, 10 Jul 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-07-10:/getting-started-in-infosec.html</guid><category>i18n</category></item><item><title>AdGuard Home, La sécurité et la vie privée dans votre maison 🛡️</title><link>https://ilearned.eu.org/adguard-home-la-securite-et-la-vie-privee-dans-votre-maison.html</link><description>&lt;p&gt;Dans ce nouvel article, nous allons traiter du logiciel open-source AdGuard Home qui est un bloqueur de publicités et de trackers qui intègre des fonctions supplémentaires tel que le DOH qui permet de chiffrer les requêtes DNS de votre réseau Wi-Fi !&lt;/p&gt;
&lt;h2 id="a-quoi-bon"&gt;A quoi bon ?&lt;/h2&gt;
&lt;p&gt;Il est vrai que l&amp;rsquo;on pourrait se demander à quoi pourrait servir un tel outil. Laissez moi vous expliquer : quand vous possédez un appareil connecté à Internet (téléphone, tablette, ordinateur, etc.), des trackers enregistrent votre activité afin de revendre ces données à des annonceurs leur permettant ainsi de faire de la publicité ciblée. Ces données peuvent révéler beaucoup sur vous, tel que votre localisation, votre situation familiale, votre état de santé, etc. C&amp;rsquo;est pourquoi il est très important de se protéger de ces trackers.&lt;/p&gt;
&lt;h2 id="prerequis"&gt;Prérequis&lt;/h2&gt;
&lt;p&gt;Pour ce tutoriel, vous aurez besoin :&lt;/p&gt;
&lt;p&gt;• D&amp;rsquo;un Raspberry Pi disposant d&amp;rsquo;un module WiFi&lt;br&gt;
• D&amp;rsquo;un câble RJ45 (Ethernet)&lt;/p&gt;
&lt;p&gt;Et c&amp;rsquo;est tout !&lt;/p&gt;
&lt;h2 id="tutoriel"&gt;Tutoriel&lt;/h2&gt;
&lt;p&gt;Dans ce tutoriel nous allons donc voir l&amp;rsquo;installation de RaspAP qui permet de faire un point d&amp;rsquo;accès wifi à partir d&amp;rsquo;un cable Ethernet branché au Raspberry Pi puis nous verrons l&amp;rsquo;installation de AdGuard Home ainsi que l&amp;rsquo;activation de la compatibilité avec le DOH (DNS over HTTPS qui permet de chiffrer vos requetes DNS).&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;1) Installation de RaspAP&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pour débuter l&amp;rsquo;installation de RaspAP, effectuez la commande suivante sur votre Raspberry Pi&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;sudo apt update &amp;amp;&amp;amp; sudo apt upgrade -y &amp;amp;&amp;amp; wget -q https://git.io/voEUQ -O /tmp/raspap &amp;amp;&amp;amp; bash /tmp/raspap&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;L&amp;rsquo;installateur va s&amp;rsquo;ouvrir, il vous demande d&amp;rsquo;abord dans quel répertoire vous souhaitez installer RaspAP à moins que vous ne souhaitez le changer, laissez le répertoire de base, répondre oui à tout (y) sauf au moment où il vous sera proposé d&amp;rsquo;installer le bloqueur de publicités, nous n&amp;rsquo;utiliserons pas celui intégré à RaspAP car il est moins performant que AdGuard Home.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Première Image" src="https://i.postimg.cc/gkfgjY3z/raspap-02.png"&gt;&lt;/p&gt;
&lt;p&gt;À la dernière étape, l&amp;rsquo;installateur vous demandera si vous souhaitez redémarrer le Raspberry Pi, répondez oui.&lt;br&gt;
Une fois votre Raspberry Pi redémarré, vous pourrez vous rendre sur l&amp;rsquo;interface web de votre Raspberry Pi, à noter que les identifiants de connexi sont &amp;ldquo;admin&amp;rdquo;/&amp;rdquo;secret&amp;rdquo;. Pour y accéder, tapez juste l&amp;rsquo;adresse IP locale de votre Raspberry Pi dans votre navigateur, et depuis cette interface, vous pourrez change le SSID (nom du réseau), les informations de connexion, etc. Nous avons donc finit d&amp;rsquo;installer RaspAP, aucune configuration de ce dernier n&amp;rsquo;est nécessaire pour l&amp;rsquo;instant.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2) Installation de AdGuard Home&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pour commencer l&amp;rsquo;installation de AdGuard Home, entrez la commande suivante sur votre Raspberry Pi&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;wget &lt;a href="https://static.adguard.com/adguardhome/release/AdGuardHome_linux_arm.tar.gz"&gt;https://static.adguard.com/adguardhome/release/AdGuardHome_linux_arm.tar.gz&lt;/a&gt; &amp;amp;&amp;amp; tar -xf AdGuardHome_linux_arm.tar.gz &amp;amp;&amp;amp; cd AdGuardHome &amp;amp;&amp;amp; sudo ./AdGuardHome -s install&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;Rendez-vous ensuite sur l&amp;rsquo;interface d&amp;rsquo;installation qui se situe à l&amp;rsquo;adresse.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;http://IPLOCALEDEMONRASPBERRYPI:3000&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Après avoir cliqué sur &amp;ldquo;C&amp;rsquo;est parti&amp;rdquo;, dans la partie &amp;ldquo;Interface web administrateur&amp;rdquo;, laissez &amp;ldquo;Toutes les interfaces&amp;rdquo; et changez le port pour, disons par exemple, 1234. Dans la partie &amp;ldquo;Serveur DNS&amp;rdquo;, choisissez 127.0.0.1 à la place de &amp;ldquo;Toutes les interfaces&amp;rdquo; et mettez 5300 dans la case port.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Seconde Image" src="https://i.postimg.cc/cCDkJw06/ad-guard.png"&gt;&lt;/p&gt;
&lt;p&gt;Cliquez sur le bouton Suivant puis renseignez vos informations de connexion à l&amp;rsquo;interface d&amp;rsquo;administration&lt;/p&gt;
&lt;p&gt;&lt;img alt="Troisième Image" src="https://i.postimg.cc/bYDjGw4W/Screenshot-2020-05-09-Setup-Ad-Guard-Home.png"&gt;&lt;/p&gt;
&lt;p&gt;Une fois cela fait, cliquez sur Suivant puis &amp;ldquo;ouvrir le Tableau de bord&amp;rdquo;, entrez vos identifiants de connexions puis allez dans la section Filtres puis Listes de blocage DNS. Cochez toutes les cases et ajoutez la liste :&lt;/p&gt;
&lt;p&gt;&lt;code&gt;"https://raw.githubusercontent.com/hl2guide/Filterlist-for-AdGuard/master/filter_blocklist.txt"&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;en cliquant sur la bouton Ajouter liste de blocage.&lt;/p&gt;
&lt;p&gt;&lt;img alt="Quatrième Image" src="https://i.postimg.cc/fR6dNyns/Screenshot-2020-05-09-Ad-Guard-Home.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour finaliser l&amp;rsquo;installation, rendez-vous sur l&amp;rsquo;interface d&amp;rsquo;administration de RaspAP, les identifiants de connexion sont par défaut &amp;ldquo;admin&amp;rdquo;/&amp;rdquo;secret&amp;rdquo;. Puis dans la section DHCP server, cliquez sur Advanced, puis cochez la case &amp;rdquo; Only ever query DNS servers configured below&amp;rdquo;. Renseignez ensuite &amp;ldquo;127.0.0.1#5300&amp;rdquo; dans la case Add upstream DNS server, puis cliquez sur le bouton +&lt;/p&gt;
&lt;p&gt;&lt;img alt="Cinquième Image" src="https://i.postimg.cc/8Pdk5C6D/Screenshot-2020-05-09-Rasp-AP-Wi-Fi-Configuration-Portal.png"&gt;&lt;/p&gt;
&lt;p&gt;Pour finir, redémarrez le Point D&amp;rsquo;accès en cliquant sur le bouton Restart hotspot dans la section &amp;ldquo;Hotspot&amp;rdquo;. Et voilà ! L&amp;rsquo;installation de RaspAP et de AdGuard Home est terminée !&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;3) Bonus : Mise en place du DOH ainsi que d&amp;rsquo;un VPN&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Pour mettre en place le DOH, allez sur l&amp;rsquo;interface d&amp;rsquo;administration de AdGuard Home puis dans paramètres, paramètres DNS, renseignez le DOH de votre choix, dans mon cas, j&amp;rsquo;ai choisi&lt;/p&gt;
&lt;p&gt;&lt;code&gt;https://doh.powerdns.org/&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img alt="Sixième Image" src="https://i.postimg.cc/gJ5jvBzW/Screenshot-2020-05-09-Ad-Guard-Home-1.png"&gt;&lt;/p&gt;
&lt;p&gt;Vos requêtes DNS sont maintenant chiffrées !&lt;/p&gt;
&lt;h2 id="conclusion"&gt;Conclusion&lt;/h2&gt;
&lt;p&gt;Et voilà ! C&amp;rsquo;est terminé, vous pouvez maintenant naviguer sur internet sans publicités ni trackeurs ! Veillez à bien modifier le mot de passe ainsi que le SSID de votre réseau wifi ! Vous n&amp;rsquo;avez plus qu&amp;rsquo;à connecter tout les appareils de votre maison au nouveau réseau Wi-Fi et ils seront protégés à leur tour ? Si vous avez des questions, n&amp;rsquo;hésitez pas à me contacter sur twitter @eban_non ou par mail ebandev@protonmail.com.&lt;/p&gt;
&lt;p&gt;Merci à Azgar de m&amp;rsquo;avoir aidé pour la relecture&lt;/p&gt;</description><dc:creator xmlns:dc="http://purl.org/dc/elements/1.1/">Eban</dc:creator><pubDate>Mon, 15 Jun 2020 00:00:00 +0200</pubDate><guid isPermaLink="false">tag:ilearned.eu.org,2020-06-15:/adguard-home-la-securite-et-la-vie-privee-dans-votre-maison.html</guid><category>misc</category></item></channel></rss>