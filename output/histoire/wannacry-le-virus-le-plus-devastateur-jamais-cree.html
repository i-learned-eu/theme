<!DOCTYPE html>
<html lang="fr">
<head>
          <title>Blog - Eban - WannaCry, le virus le plus d√©vastateur jamais cr√©√© üëæ</title>
        <meta charset="utf-8" />
        <link rel="stylesheet" href="/static/css/style.css">
        <title>Eban's Blog</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
        <link rel="shortcut icon" href="https://res.eban.dev/img/icon.png">
        <meta name="keywords" content="eban, developpeur, developper, infosec, hacking, pentest, pentesting, blog, privacy, vie priv√©e, github">
        <meta property="og:type" content="website" />
        <meta property="og:title" content="Eban" />
        <meta property="og:description" content="Ce blog a pour but de regrouper mes Write Up de boxs HackTheBox et Vulnhub ainsi que des articles sur d'autres sujets li√©s √† l'informatique." />
        <meta name="description" content="Ce blog a pour but de regrouper mes Write Up de boxs HackTheBox et Vulnhub ainsi que des articles sur d'autres sujets li√©s √† l'informatique." />
        <meta property="og:url" content="https://eban.dev/blog" />
        <meta property="og:site_name" content="Eban's Blog" />
        <meta property="og:image" content="https://eban.dev/blog/header.gif" />
        <meta property="og:image:width" content="512" />
        <meta property="og:image:height" content="512" />
        <meta property="og:locale" content="fr_FR" />
        <meta name="twitter:site" content="@eban_non" />





</head>

<body id="index" class="home">
   <div class="header">
      <div class="nav"><a href="https://eban.dev/">~/</a><a href="https://blog.eban.dev">~/blog/</a><a href="https://git.eban.dev">~/git/</a></div>
      <h1>Eban's Blog</h1>
    </div>

<article id="post-list">
        <h2 class="entry-title"><a href="http://10.0.0.11:8000/histoire/wannacry-le-virus-le-plus-devastateur-jamais-cree.html" rel="bookmark" title="Permalink to WannaCry, le virus le plus d√©vastateur jamais cr√©√© üëæ">WannaCry, le virus le plus d√©vastateur jamais cr√©√© üëæ</a></h2>
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg><time class="published" datetime="2020-12-08T00:00:00+01:00"> mar. 08 d√©cembre 2020 </time>
            <address class="vcard author"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#fff" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
            <a class="url fn" href="http://10.0.0.11:8000/category/histoire.html">Histoire</a>
            </address>
            <section>
                <p> <p>En mai 2017, un virus informatique du nom de WannaCry fait son apparition, il a infect√© quelques 300 000 ordinateurs dans plus de 150 pays ! Trois ans plus tard, revenons ensemble sur le ransomware le plus d√©vastateur jamais cr√©√©.</p>
<h3>La gen√®se du projet</h3>
<p>Le 13 ao√ªt 2016, un groupe de hackers d√©nomm√© <strong>The Shadow Brokers</strong> met en libre t√©l√©chargement sur Tumblr, GitHub et Pastebin de nombreux programmes d'espionnage et de piratage informatique de la NSA dont la faille de s√©curit√© EternalBlue, cette derni√®re permettant une RCE (remote code execution) sur un machine distante √† partir d'un partage SMBv1 (plus d'infos <a href="https://docs.microsoft.com/fr-fr/security-updates/SecurityBulletins/2017/ms17-010">ici</a>).
Cette vuln√©rabilit√© a √©t√© utilis√©e par le malware WannaCry afin de se propager.</p>
<p>Ce virus aujourd'hui attribu√© a la Cor√©e du Nord et plus particuli√®rement au groupe Lazarus par de nombreux acteurs tel que le conseiller √† la s√©curit√© int√©rieure des USA <a href="https://www.washingtonpost.com/world/national-security/us-set-to-declare-north-korea-carried-out-massive-wannacry-cyber-attack/2017/12/18/509deb1c-e446-11e7-a65d-1ac0fd7f097e_story.html">Tom Bossert</a> ou le chercheur en cybers√©curit√© Matthieu Suiche interrog√© par <a href="https://yewtu.be/watch?v=Mp3TH5PI6rc">Envoy√© Sp√©cial</a> aurait donc √©t√© cr√©√© dans un but lucratif.</p>
<h3>Fonctionnement du Ransomware</h3>
<p>Comme vu plus haut, WannaCry se propage tout seul (c'est un virus auto-r√©pliquant ou vers) gr√¢ce √† la faille de s√©curit√© EternalBlue. Une fois execut√© sur la machine, le logiciel se met √† chiffrer tout les fichiers personnels de l'ordinateur avec la m√©thode de chiffrement AES-128 (Une paire de cl√©s RSA est g√©n√©r√©e au lancement du programme, la cl√© priv√©e √©tait utilis√©e pour chiffrer les fichiers).
Apr√®s l'infection, une somme √©quivalente √† 300‚Ç¨ (voir 600‚Ç¨ en fonction des cas) en Bitcoin est demand√©e pour d√©chiffrer les fichiers. Il n'existe aucune preuve du fait que les personnes derri√®re WannaCry sont en capacit√© de d√©chiffrer les fichiers.
En effet, il est impossible pour les pirates de relier une transaction √† un ordinateur sp√©cifique. Une fois lanc√©, le logiciel installe aussi Tor sur la machine et essaie de se connecter aux serveurs C2 (<a href="https://www.wikiwand.com/en/Command_and_control">Command and Control</a>) suivants:</p>
<ul>
<li>gx7ekbenv2riucmf.onion</li>
<li>57g7spgrzlojinas.onion</li>
<li>xxlvbrloxvriy2c5.onion</li>
<li>76jdd2ir2embyv47.onion</li>
<li>cwwnhwhlz52maqm7.onion</li>
</ul>
<h3>Un Antidote ?</h3>
<p>Un groupe de trois experts en s√©curit√© informatique fran√ßais ont cr√©√© logiciel nomm√© <a href="https://github.com/gentilkiwi/wanakiwi">Wanakiwi</a>.
Cet outil permet de d√©chiffrer les fichiers qui l'ont √©t√© par WannaCry.
WannaCry utilise <a href="https://fr.wikipedia.org/wiki/Cryptographic_Application_Programming_Interface"><strong>CryptoAPI</strong></a> (les fonctions cryptographiques de Windows) pour g√©n√©rer les cl√©s de chiffrement, cependant ces fonctions inscrivent dans la RAM de l'ordinateur la cl√© priv√©e en claire, WanaKiwi va donc aller chercher dans la RAM des traces de la cl√© priv√©e utilis√©e pour chiffrer les donn√©es.</p>
<h3>Comment se pr√©munir de ce type d'attaques dans le futur ?</h3>
<p>On ne le dira jamais assez, mais n'ouvrez jamais de pi√®ces jointes venant d'un destinataire inconnu.
Mettez √† jour r√©guli√®rement votre OS, Microsoft propose une fonction tr√®s int√©ressante dans leur suite de s√©curit√© Windows Defender nomm√©e <strong>Dispositif d'acc√®s contr√¥l√© aux dossiers</strong>.
Cet outil permet de contr√¥ler l'acc√®s aux fichiers syst√®mes de Windows et aux donn√©es personnelles des utilisateurs par des programmes, il fonctionne avec un syst√®me de withelist, chaque programme doit donc √™tre autoris√© manuellement pour pouvoir modifier ces fichiers (plus d'infos <a href="https://docs.microsoft.com/fr-fr/windows/security/threat-protection/microsoft-defender-atp/evaluate-controlled-folder-access">ici</a>).</p>
<p>Merci d'avoir lu cet article, j'esp√®re qu'il vous aura plu.
Je suis preneur de vos retours :)</p>
<h3>Remerciements</h3>
<p>Merci √† Shyla, xeway, 0xThxmxs, Shcanovishka, Sycorax, look, Ramle et Lancelot de m'avoir aid√© pour la relecture</p>
<p>Sources :</p>
<ul>
<li>https://fr.wikipedia.org/wiki/WannaCry</li>
<li>https://fr.wikipedia.org/wiki/The_Shadow_Brokers</li>
<li>https://docs.microsoft.com/fr-fr/security-updates/SecurityBulletins/2017/ms17-010</li>
<li>https://www.washingtonpost.com/world/national-security/us-set-to-declare-north-korea-carried-out-massive-wannacry-cyber-attack/2017/12/18/509deb1c-e446-11e7-a65d-1ac0fd7f097e_story.html</li>
<li>https://yewtu.be/watch?v=Mp3TH5PI6rc</li>
<li>https://www.secureworks.com/research/wcry-ransomware-analysis</li>
<li>https://fr.wikipedia.org/wiki/Cryptographic_Application_Programming_Interface</li>
<li>https://docs.microsoft.com/fr-fr/windows/security/threat-protection/microsoft-defender-atp/evaluate-controlled-folder-access</li>
</ul> </p>
            </section>
            <div class="reco">
              <h2>Articles Recommand√©s : </h2>
              <div class="container">
              </div>
            </div>
</article>
</body>
</html>